
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../index.html"><img alt="Logo" class="logo" src="../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>Forced Response Curves (FRC)</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-07" name="DC.date"/><meta content="ForcedResponseCurves.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>Forced Response Curves (FRC)</h1><!--introduction--><p>These curves are commonly studied to analyse the nonlinear oscillatory behaviour of mechanical systems subject to external excitation. The bending of these curves gives conclusive results about the system nonlinearities, their position reveals information about the spectrum and resonances inherent to the system. In experimental realisations they are used to analyse these very properties, for model identification and development it is thus desirable to have efficient routines which can extract them from computer based models.</p><p><img alt="" hspace="5" src="FRCs.png" style="width: 400px; height: auto;" vspace="5"/> </p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">A motivation for model reduction</a></li><li><a href="#2">Extraction of the FRC: Level-Set method</a></li><li><a href="#6">Extraction of the FRC: Continuation of equilibria</a></li><li><a href="#9">Extraction of the FRC: Continuation of periodic orbits</a></li></ul></div><h2 id="1">A motivation for model reduction</h2><p>In the context of Finite Element Models (FEMs) which are analysed for these FRCs, the resulting dynamical systems are commonly very high dimensional <span class="MathJax_Preview"><img alt="$\mathcal{O}(10^6)$" src="ForcedResponseCurves_eq00427931508251397599-Rescaled.png" style="width: 38.4px; height: auto;"/></span><script type="math/tex">\mathcal{O}(10^6)</script> and lightly damped. Thus direct simulation is beyond reach and generally unfeasible. Reduced order models are then employed to obtain properties such as the FRCs of such systems. They aim to represent the full system dynamics accurately enough, albeit can be analysed at low computational cost due to their low dimensionality.</p><p>Especially in FEMs most modes are not relevant for the actual macroscopic behaviour of an object. Microscopic modes are a result of the discretisation and operate at very high frequencies, low amplitudes and decay at exponentially faster rates than the macroscopic modes. In practice these microscopic modes are also not forced directly, as they correspond to very high forcing frequencies, when compared to the typical environmental behaviour.</p><p>The persistent forced response of interest of the full dynamical system is thus typically the one associated to the slowest, macroscopic modes. In special cases, transient response or faster-oscillatory modes are of interested due to special types of excitation. This can be taken into consideration by extending the ROM to the respective range of modes.</p><p>Common methods to obtain ROMs are based on projection. The full system is projected onto a low dimensional basis which is chosen according to the system properties of interest. These may be based on the linear eigenmodes of the slow modes (Proper Orthogonal Decompositions for instance), projections in frequency space (Harmonic Balance) or onto more sophisticated basis which are numerically computed (eg. Dynamic Mode Decomposition). All of these bases, however, generally lack the key feature of forming <a href="../Theory/3.%20Invariance%20-%20the%20key%20for%20model%20reduction.html"><b>invariant</b></a> subspaces and thus cannot guarantee to accurately reproduce the full system response.</p><p>In SSMTool, using the mathematically rigorous theory on <a href="../Theory/2.%20SSM-Theory.html">Spectral Submanifolds (SSM)</a>, we create <b>exact</b> ROMs on invariant manifolds for the computation of FRCs. They are exact in the sense, that, due to the invariance, the trajectories on the SSM correspond to trajectories of the full physical dynamical system. So any periodic orbit on the FRC, which is computed from the reduced dynamics, is mathematically guaranteed to exist in the full system. These models and manifolds can be computed automatically to arbitrary order of accuracy. Typically, however, the results already converge at low orders, making high order approximations unnecessary.</p><p>This procedure is furthermore efficient, it does not require modal transformations and computes the invariant manifolds directly from physical coordinates. Only the modes over which the SSM is constructed, along with some modes that are close in frequency space to check for the existence of the SSM need to be computed, which can also be done efficiently. Computing the ROM</p><p>In a forced response curve, the oscillation amplitudes of a system that is excited are reported as a function of the frequency of excitation. So if <span class="MathJax_Preview"><img alt="$\mathbf{x}(t)$" src="ForcedResponseCurves_eq05520437683141972634-Rescaled.png" style="width: 22.8px; height: auto;"/></span><script type="math/tex">\mathbf{x}(t)</script> is a periodic orbit with frequency <span class="MathJax_Preview"><img alt="$\Omega$" src="ForcedResponseCurves_eq09309921117587088540-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\Omega</script> in phase space, then for each orbit the point that fulfills</p><p><span class="MathJax_Preview"><img alt="$$\textrm{max}_{t \in [0, 2\pi/\Omega ]} |x_i( t)|$$" src="ForcedResponseCurves_eq12852071914076529622-Rescaled.png" style="width: 100.8px; height: auto;"/></span><script type="math/tex">\textrm{max}_{t \in [0, 2\pi/\Omega ]} |x_i( t)|</script></p><p>is displayed in the FRC. These curves give conclusive information about resonant and nonlinear behaviour of dynamical systems which is very valuable information in system analysis, design and control.</p><p>For large dynamical systems the computation of these periodic orbits, however is very costly and time consuming. Thus one commonly reverts to reduced order models to predict the forced response. The mathematically sound and rigorous way of doing so in the general case is via the use of invariant attracting manifolds. As these objects are invariant, any trajectory that starts in such a manifold, is restricted to it for its entirety. One can thus compute the trajectory using the local manifold coordinates only, and consequently map it back to the full space, without discarding any information of the initial full dynamical system. This guarantees that the trajectory which has been computed in the reduced space (on the manifold) is also a trajectory of the full dynamical system, including all qualitative and quantitative behaviour. SSMTool leverages on this fact and computes the periodic orbits on the invariant SSMs, which leads to a very fast and efficient routine. Consequently these orbits are mapped back to the full space via the SSM parametrisation to obtain the desired FRC.</p><p>To obtain a periodic orbit from the dynamics on the SSM the reduced dynamics</p><p><span class="MathJax_Preview"><img alt="$$\dot{\mathbf{ p} } = \mathbf{R} ( \mathbf{p})+ \epsilon \mathbf{S} (\mathbf{p},\mathbf{\Omega}
t) + O(\epsilon^2)$$" src="ForcedResponseCurves_eq17446404654969136743-Rescaled.png" style="width: 172.79999999999998px; height: auto;"/></span><script type="math/tex">\dot{\mathbf{ p} } = \mathbf{R} ( \mathbf{p})+ \epsilon \mathbf{S} (\mathbf{p},\mathbf{\Omega}
t) + O(\epsilon^2)</script></p><p>are analysed. They constitute an ODE in cartesian coordinates which can be analysed with the means of continuation and collocation. Examples of how this is implemented in SSMTool can be found in <a href="cont_po">SSMTool</a>. Alternatively they can be transformed to polar coordinates, which is of particular interest in the case of 2-D SSMs.</p><p>These points can be either found by <a href="6.%20Continuation%20of%20Reduced%20Dynamics.html">continuation of equilibria in COCO</a> or via a simple evaluation of the ODE over a grid of parametrisation coordinates. The zeros which result from this evaluation then constitute periodic orbits on the manifold, and therefore also for the full dynamical system ie. <span class="MathJax_Preview"><img alt="$\mathbf{z(t)} = \mathbf{W}_{\epsilon}(\mathbf{p}(t),\phi)$" src="ForcedResponseCurves_eq12831880502734731211-Rescaled.png" style="width: 108.0px; height: auto;"/></span><script type="math/tex">\mathbf{z(t)} = \mathbf{W}_{\epsilon}(\mathbf{p}(t),\phi)</script>. As this method merely requires the computation of level sets of zeros, the forced response can be computed independently for each forcing frequency <span class="MathJax_Preview"><img alt="$\{\Omega_1, ... \Omega_z \}$" src="ForcedResponseCurves_eq07057861578188890638-Rescaled.png" style="width: 58.8px; height: auto;"/></span><script type="math/tex">\{\Omega_1, ... \Omega_z \}</script> in the interval of interest. Another consequence is that isolated regions of forced response, so called <i>isolas</i>, can be computed at once. This is in stark contrast to continuation based methods, which will only find such branches of response when given appropriate initial conditions.</p><h2 id="2">Extraction of the FRC: Level-Set method</h2><p>This method can be used for directly computing the Forced Response for systems without internal resonance. As it allows for approximating the non-autonomous manifold and dynamics on it up to arbitrary orders these systems may include parametric excitation. We thus consider systems periodic external and parametric excitation and assume that the harmonic <span class="MathJax_Preview"><img alt="$\kappa_0$" src="ForcedResponseCurves_eq13770119240500526598-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\kappa_0</script> is in 1:1 resonance with the master mode, over which the SSM is constructed, i.e.</p><p><span class="MathJax_Preview"><img alt="$$\kappa_0 \Omega \approx \textrm{Im}(\lambda)$$" src="ForcedResponseCurves_eq13269876471267536028-Rescaled.png" style="width: 72.0px; height: auto;"/></span><script type="math/tex">\kappa_0 \Omega \approx \textrm{Im}(\lambda)</script></p><p>Furthermore assume that no internal resonances  are present in the spectrum of the dynamical system. The periodic forced response and its stability can then be determined from the ROM by simple evaluation of zero level sets. We write the coordinates in polar form as</p><p><span class="MathJax_Preview"><img alt="$$(p,\bar p )  = (\rho \textrm{e}^{i\theta}, \rho \textrm{e}^{-i\theta})$$" src="ForcedResponseCurves_eq12423466306180291259-Rescaled.png" style="width: 110.39999999999999px; height: auto;"/></span><script type="math/tex">(p,\bar p )  = (\rho \textrm{e}^{i\theta}, \rho \textrm{e}^{-i\theta})</script></p><p>In order to find the periodic orbits of this system, we reformulate the dynamical equations in the polar coordinates (cf. <a href="http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf">Jain &amp; Haller 2021</a>, <a href="https://arxiv.org/abs/2307.10240">Thurnher, Jain &amp; Haller, 2023</a>).</p><p>Periodic orbits of the normal form reduced dynamics in these coordinates correspond to the joint set of parameters where</p><p><span class="MathJax_Preview"><img alt="$$\dot{\rho} = 0$$" src="ForcedResponseCurves_eq00688128243486316384-Rescaled.png" style="width: 31.2px; height: auto;"/></span><script type="math/tex">\dot{\rho} = 0</script></p><p><span class="MathJax_Preview"><img alt="$$\dot{\psi} = 0$$" src="ForcedResponseCurves_eq13574515269109863929-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\dot{\psi} = 0</script></p><p>holds, with <span class="MathJax_Preview"><img alt="$\psi = \theta - \kappa_0\Omega t$" src="ForcedResponseCurves_eq10239825811621187731-Rescaled.png" style="width: 76.8px; height: auto;"/></span><script type="math/tex">\psi = \theta - \kappa_0\Omega t</script> which denotes the phaseshift between the periodic response of the system and the external excitation. An illustration of the two level sets, and their union is displayed in the following along with a depiction of how the forced response is obtained from a the flow in parametrisation space (cf. <a href="http://www.georgehaller.com/reprints/isolatedresponsesten.pdf">Ponsioen, Pedergnanga &amp; Haller 2019</a>)</p><p><img alt="" hspace="5" src="LevelSets_PonsPedHaller2019.png" style="width: 500px; height: auto;" vspace="5"/> </p><p><img alt="" hspace="5" src="FRC_Extraction_PonsJainHaller2020.png" style="width: 500px; height: auto;" vspace="5"/> </p><p>This procedure also allows to detect isolated regions of the forced response (cf. <a href="http://www.georgehaller.com/reprints/isolatedresponsesten.pdf">Ponsioen, Pedergnanga &amp; Haller 2019</a>). This procedure can be easily parallelised, as the level set of these two equations can be computed independently for each forcing frequency. The implementation of this routine thus works as depicted in the following scheme:</p><p><img alt="" hspace="5" src="FRC_levelset.png" style="width: 900px; height: auto;" vspace="5"/> </p><p>For each forcing frequency the reduced dynamics are evaluated over a grid of the coordinates <span class="MathJax_Preview"><img alt="$(\rho, \psi)$" src="ForcedResponseCurves_eq04288452586429203193-Rescaled.png" style="width: 30.0px; height: auto;"/></span><script type="math/tex">(\rho, \psi)</script>. The steady states are then directly extracted and mapped to the full physical space via the SSM parametrisation <span class="MathJax_Preview"><img alt="$\mathbf{W}_\epsilon$" src="ForcedResponseCurves_eq07602178423321565983-Rescaled.png" style="width: 19.2px; height: auto;"/></span><script type="math/tex">\mathbf{W}_\epsilon</script>. In our toolbox, an automatised implementation of this workflow is implemented. Assume we have constructed an &lt;SSM.html &gt; object for a dynamical system and wish to compute the FRC corresponding to the specified forcing. The computation is set up via a number of parameters, a few of which are presented here.</p><p>We can specify whether we want to compute a full or leading order approximation to the non-autonomous invariant manifold and reduced dynamics. If the former is chosen, then the non-autonomous manifold has to be computed for each sample forcing frequency. While this improves accuracy and is necessary for dynamical systems including parametric excitation and large amplitude excitation, a leading order approximation often is sufficient (cf. Haller &amp; Jain 2021).</p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'contribNonAuto'</span>,true)
        </pre><p>As we wish to use the <i>level set</i> method, we have to set the corresponding parameter in the <tt>FRCOptions</tt></p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">' level set'</span> )
        </pre><p>Finally, we specify the degrees of freedom, for which we would like the FRC to be plotted.</p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'outdof'</span>,outdof)
        </pre><p>We can then set a frequency range <tt>omegaRange</tt> over which the FRC is constructed and either a single or multiple orders of approximation to the SSM and reduced dynamics expansion.</p><pre class="codeinput">FRC = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>(<span class="string">'freq'</span>,omegaRange,order);
        </pre><h2 id="6">Extraction of the FRC: Continuation of equilibria</h2><p>This routine allows for the extraction of FRCs for leading-order non-autonomous approximations to SSMs, including systems with internal resonances <a href="http://www.georgehaller.com/reprints/nonlinear_analysis.pdf">Li, Jain &amp; Haller, 2022</a>. The reduced dynamics are written in polar coordinates, and equilibria of this polar representation are detected and continued. Consequently these are mapped back to physical coordinates at once, to produce the FRC for the full system. A schematic depiction of the procedure is shown in the following figure. The continuation algorithm operates locally. It looks for a nearby solution, after slightly changing the continuation parameter. An initial guess for this is obtained via the Jacobian of the ODE, both with respect to the continuation and system parameters. As it is local in nature, the detected response can only be followed along families of solutions - isolated regions of response cannot be detected.</p><p><img alt="" hspace="5" src="FRC_contep.png" style="width: 900px; height: auto;" vspace="5"/> </p><p>The method is used by setting the following parameters:</p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">'continuation ep'</span>) <span class="comment">% Choose routine</span>
        </pre><p>Continuation parameters which are important include the maximal and the initial step-size <tt>h_max</tt> and h0, the number of collocation intervalls <tt>nt</tt> , the number of continuation parameters <tt>nPar</tt> and the solver which is chosen for obtaining an initial solution.</p><pre class="codeinput">set(S.contOptions,<span class="string">'h_max'</span>,h_max,<span class="string">'h0'</span>,h0);
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'nt'</span>, nt, <span class="string">'nPar'</span>, nPar)
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>,<span class="string">'initialSolver'</span>,<span class="string">'fsolve'</span>);
        </pre><p>The FRC may then be obtained by calling:</p><pre class="codeinput">FRC = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>(<span class="string">'freq'</span>,omegaRange,order);
        </pre><h2 id="9">Extraction of the FRC: Continuation of periodic orbits</h2><p>Similarly to the routine for continuation of equilibria, the FRCs may aso be extracted via a continuation of periodic orbits of the reduced dynamics. This is done, using cartesian coordinates. The routine implemented here allows for the treatment of general dynamical systems including the case of purely parametric excitation, albeit only for 2D SSMs.</p><p>It is chosen by setting</p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">'continuation po'</span>) <span class="comment">% Choose routine</span>
        </pre><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% Forced Response Curves (FRC)
% 
% 
% These curves are commonly studied to analyse the nonlinear oscillatory behaviour 
% of mechanical systems subject to external excitation. The bending of these curves 
% gives conclusive results about the system nonlinearities, their position reveals 
% information about the spectrum and resonances inherent to the system. In experimental 
% realisations they are used to analyse these very properties, for model identification 
% and development it is thus desirable to have efficient routines which can extract 
% them from computer based models. 
% 
% <<FRCs.png>>
% 
%% A motivation for model reduction
% In the context of Finite Element Models (FEMs) which are analysed for these 
% FRCs, the resulting dynamical systems are commonly very high dimensional $\mathcal{O}(10^6)$ 
% and lightly damped. Thus direct simulation is beyond reach and generally unfeasible. 
% Reduced order models are then employed to obtain properties such as the FRCs 
% of such systems. They aim to represent the full system dynamics accurately enough, 
% albeit can be analysed at low computational cost due to their low dimensionality.
% 
% Especially in FEMs most modes are not relevant for the actual macroscopic 
% behaviour of an object. Microscopic modes are a result of the discretisation 
% and operate at very high frequencies, low amplitudes and decay at exponentially 
% faster rates than the macroscopic modes. In practice these microscopic modes 
% are also not forced directly, as they correspond to very high forcing frequencies, 
% when compared to the typical environmental behaviour. 
% 
% The persistent forced response of interest of the full dynamical system is 
% thus typically the one associated to the slowest, macroscopic modes. In special 
% cases, transient response or faster-oscillatory modes are of interested due 
% to special types of excitation. This can be taken into consideration by extending 
% the ROM to the respective range of modes.
% 
% Common methods to obtain ROMs are based on projection. The full system is 
% projected onto a low dimensional basis which is chosen according to the system 
% properties of interest. These may be based on the linear eigenmodes of the slow 
% modes (Proper Orthogonal Decompositions for instance), projections in frequency space (Harmonic Balance) or onto more sophisticated basis which are numerically 
% computed (eg. Dynamic Mode Decomposition). All of these bases, however, generally 
% lack the key feature of forming <../Theory/3.%20Invariance%20-%20the%20key%20for%20model%20reduction.html *invariant*> subspaces and thus cannot guarantee 
% to accurately reproduce the full system response.
% 
% In SSMTool, using the mathematically rigorous theory on <../Theory/2.%20SSM-Theory.html Spectral 
% Submanifolds (SSM)>, we create *exact* ROMs on invariant manifolds for the computation 
% of FRCs. They are exact in the sense, that, due to the invariance, the trajectories 
% on the SSM correspond to trajectories of the full physical dynamical system. 
% So any periodic orbit on the FRC, which is computed from the reduced dynamics, 
% is mathematically guaranteed to exist in the full system. These models and manifolds 
% can be computed automatically to arbitrary order of accuracy. Typically, however, 
% the results already converge at low orders, making high order approximations 
% unnecessary. 
% 
% This procedure is furthermore efficient, it does not require modal transformations 
% and computes the invariant manifolds directly from physical coordinates. Only 
% the modes over which the SSM is constructed, along with some modes that are 
% close in frequency space to check for the existence of the SSM need to 
% be computed, which can also be done efficiently.
% Computing the ROM
% 
% 
% In a forced response curve, the oscillation amplitudes of a system that is 
% excited are reported as a function of the frequency of excitation. So if $\mathbf{x}(t)$ 
% is a periodic orbit with frequency $\Omega$ in phase space, then for each orbit 
% the point that fulfills
% 
% $$\textrm{max}_{t \in [0, 2\pi/\Omega ]} |x_i( t)|$$
% 
% is displayed in the FRC. These curves give conclusive information about resonant 
% and nonlinear behaviour of dynamical systems which is very valuable information 
% in system analysis, design and control.
% 
% 
% 
% For large dynamical systems the computation of these periodic orbits, however 
% is very costly and time consuming. Thus one commonly reverts to reduced order 
% models to predict the forced response. The mathematically sound and rigorous 
% way of doing so in the general case is via the use of invariant attracting manifolds. 
% As these objects are invariant, any trajectory that starts in such a manifold, 
% is restricted to it for its entirety. One can thus compute the trajectory using 
% the local manifold coordinates only, and consequently map it back to the full 
% space, without discarding any information of the initial full dynamical system. 
% This guarantees that the trajectory which has been computed in the reduced space 
% (on the manifold) is also a trajectory of the full dynamical system, including 
% all qualitative and quantitative behaviour. SSMTool leverages on this fact and 
% computes the periodic orbits on the invariant SSMs, which leads to a very fast 
% and efficient routine. Consequently these orbits are mapped back to the full 
% space via the SSM parametrisation to obtain the desired FRC.
% 
% To obtain a periodic orbit from the dynamics on the SSM the reduced dynamics
% 
% $$\dot{\mathbf{ p} } = \mathbf{R} ( \mathbf{p})+ \epsilon \mathbf{S} (\mathbf{p},\mathbf{\Omega} 
% t) + O(\epsilon^2)$$
% 
% are analysed. They constitute an ODE in cartesian coordinates which can be 
% analysed with the means of continuation and collocation. Examples of how this 
% is implemented in SSMTool can be found in <cont_po SSMTool>. Alternatively they 
% can be transformed to polar coordinates, which is of particular interest in 
% the case of 2-D SSMs.
% 
% 
% 
% These points can be either found by <6.%20Continuation%20of%20Reduced%20Dynamics.html continuation of equilibria in COCO> or 
% via a simple evaluation of the ODE over a grid of parametrisation coordinates. 
% The zeros which result from this evaluation then constitute periodic orbits 
% on the manifold, and therefore also for the full dynamical system ie. $\mathbf{z(t)} 
% = \mathbf{W}_{\epsilon}(\mathbf{p}(t),\phi)$. As this method merely requires 
% the computation of level sets of zeros, the forced response can be computed 
% independently for each forcing frequency $\{\Omega_1, ... \Omega_z \}$ in the 
% interval of interest. Another consequence is that isolated regions of forced 
% response, so called _isolas_, can be computed at once. This is in stark contrast 
% to continuation based methods, which will only find such branches of response 
% when given appropriate initial conditions. 
% 
% 
%% Extraction of the FRC: Level-Set method
% This method can be used for directly computing the Forced Response for systems 
% without internal resonance. As it allows for approximating the non-autonomous 
% manifold and dynamics on it up to arbitrary orders these systems may include 
% parametric excitation. We thus consider systems periodic external and parametric 
% excitation and assume that the harmonic $\kappa_0$ is in 1:1 resonance with 
% the master mode, over which the SSM is constructed, i.e. 
% 
% $$\kappa_0 \Omega \approx \textrm{Im}(\lambda)$$
% 
% Furthermore assume that no internal resonances  are present in the spectrum 
% of the dynamical system. The periodic forced response and its stability can 
% then be determined from the ROM by simple evaluation of zero level sets. We 
% write the coordinates in polar form as
% 
% $$(p,\bar p )  = (\rho \textrm{e}^{i\theta}, \rho \textrm{e}^{-i\theta})$$
% 
% In order to find the periodic orbits of this system, we reformulate the dynamical 
% equations in the polar coordinates (cf. <http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf Jain & Haller 2021>,
% <https://arxiv.org/abs/2307.10240 Thurnher, Jain & 
% Haller, 2023>). 
% 
% 
% 
% Periodic orbits of the normal form reduced dynamics in these coordinates correspond 
% to the joint set of parameters where
% 
% $$\dot{\rho} = 0$$
% 
% $$\dot{\psi} = 0$$
% 
% holds, with $\psi = \theta - \kappa_0\Omega t$ which denotes the phaseshift 
% between the periodic response of the system and the external excitation. An 
% illustration of the two level sets, and their union is displayed in the following 
% along with a depiction of how the forced response is obtained from a the flow 
% in parametrisation space (cf. <http://www.georgehaller.com/reprints/isolatedresponsesten.pdf Ponsioen, Pedergnanga & Haller 2019>)
% 
% <<LevelSets_PonsPedHaller2019.png>> 
%
% <<FRC_Extraction_PonsJainHaller2020.png>>
% 
% This procedure also allows to detect isolated regions of the forced response 
% (cf. <http://www.georgehaller.com/reprints/isolatedresponsesten.pdf Ponsioen, Pedergnanga & Haller 2019>). This procedure can be easily parallelised, 
% as the level set of these two equations can be computed independently for each 
% forcing frequency. The implementation of this routine thus works as depicted 
% in the following scheme:
% 
% <<FRC_levelset.png>>
%  
% For each forcing frequency the reduced dynamics are evaluated over a grid 
% of the coordinates $(\rho, \psi)$. The steady states are then directly extracted 
% and mapped to the full physical space via the SSM parametrisation $\mathbf{W}_\epsilon$. 
% In our toolbox, an automatised implementation of this workflow is implemented. 
% Assume we have constructed an <SSM.html > object for a dynamical system and 
% wish to compute the FRC corresponding to the specified forcing. The computation 
% is set up via a number of parameters, a few of which are presented here.
% 
% We can specify whether we want to compute a full or leading order approximation 
% to the non-autonomous invariant manifold and reduced dynamics. If the former 
% is chosen, then the non-autonomous manifold has to be computed for each sample 
% forcing frequency. While this improves accuracy and is necessary for dynamical 
% systems including parametric excitation and large amplitude excitation, a leading 
% order approximation often is sufficient (cf. Haller & Jain 2021).

set(S.<a href="../Library/Features/Options/Options.html">Options</a>,'contribNonAuto',true)
%% 
% As we wish to use the _level set_ method, we have to set the corresponding 
% parameter in the |FRCOptions|

set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'method',' level set' )
%% 
% Finally, we specify the degrees of freedom, for which we would like the FRC 
% to be plotted.

set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'outdof',outdof)
%% 
% We can then set a frequency range |omegaRange| over which the FRC is constructed 
% and either a single or multiple orders of approximation to the SSM and reduced 
% dynamics expansion.

FRC = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>('freq',omegaRange,order);
%% Extraction of the FRC: Continuation of equilibria
% This routine allows for the extraction of FRCs for leading-order non-autonomous 
% approximations to SSMs, including systems with internal resonances <http://www.georgehaller.com/reprints/nonlinear_analysis.pdf Li, Jain & Haller, 2022>. The reduced dynamics are written in polar coordinates, and equilibria 
% of this polar representation are detected and continued. Consequently these 
% are mapped back to physical coordinates at once, to produce the FRC for the 
% full system. A schematic depiction of the procedure is shown in the following 
% figure. The continuation algorithm operates locally. It looks for a nearby solution, 
% after slightly changing the continuation parameter. An initial guess for this 
% is obtained via the Jacobian of the ODE, both with respect to the continuation 
% and system parameters. As it is local in nature, the detected response can only 
% be followed along families of solutions - isolated regions of response cannot 
% be detected.
% 
% <<FRC_contep.png>>
% 
% The method is used by setting the following parameters:

set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'method','continuation ep') % Choose routine
%% 
% Continuation parameters which are important include the maximal and the initial 
% step-size |h_max| and h0, the number of collocation intervalls |nt| , the number 
% of continuation parameters |nPar| and the solver which is chosen for obtaining 
% an initial solution.

set(S.contOptions,'h_max',h_max,'h0',h0);
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'nt', nt, 'nPar', nPar)
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>,'initialSolver','fsolve');
%% 
% The FRC may then be obtained by calling:

FRC = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>('freq',omegaRange,order);
%% Extraction of the FRC: Continuation of periodic orbits
% Similarly to the routine for continuation of equilibria, the FRCs may aso 
% be extracted via a continuation of periodic orbits of the reduced dynamics. 
% This is done, using cartesian coordinates. The routine implemented here allows 
% for the treatment of general dynamical systems including the case of purely 
% parametric excitation, albeit only for 2D SSMs.
% 
% It is chosen by setting 

set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'method','continuation po') % Choose routine
            ##### SOURCE END #####
        --></body></html></body></html>