
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../index.html"><img alt="Logo" class="logo" src="../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>Computing backbone curves</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-07" name="DC.date"/><meta content="Backbone_Curves.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>Computing backbone curves</h1><!--introduction--><p>Let us consider an autonomous dynamical mechanical system</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{M\ddot{x}+C\dot{x}+Kx +f(x,\dot{x}) = 0}$$" src="Backbone_Curves_eq02000805234509583584-Rescaled.png" style="width: 172.79999999999998px; height: auto;"/></span><script type="math/tex">\mathbf{M\ddot{x}+C\dot{x}+Kx +f(x,\dot{x}) = 0}</script></p><p>with nonlinear internal forces <span class="MathJax_Preview"><img alt="$\mathbf{f(x,\dot{x}})$" src="Backbone_Curves_eq13499885162702341580-Rescaled.png" style="width: 37.199999999999996px; height: auto;"/></span><script type="math/tex">\mathbf{f(x,\dot{x}})</script>.</p><p>The backbone curve of such a system is defined as the collection of points which sit at the locus, ie. the point of maximal amplitude, of the nonlinear forced oscillations of a system. In this tutorial will motivate how such a curve can be obtained directly from the ROM provided by the reduced dynamics on a 2-dimensional SSM. In the following figure an illustration of a backbone curve is given, along with the forced response with various forcing amplitudes. Depending on the magnitude and characteristics of the nonlinear internal forces, the curve will bend in different ways, thus giving conclusive results about they system's nonlinear properties.</p><p><img alt="" hspace="5" src="BackBoneIllustration.png" style="width:30%;" vspace="5"/> </p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">SSM Computation</a></li><li><a href="#2">Example</a></li><li><a href="#4">Linear Modal analysis and SSM setup</a></li><li><a href="#6">Setup SSM computation</a></li></ul></div><h2 id="1">SSM Computation</h2><p>Assume we are interested in the nonlinear behaviour of the <span class="MathJax_Preview"><img alt="$i$" src="Backbone_Curves_eq08984912804010224726-Rescaled.png" style="width: 4.8px; height: auto;"/></span><script type="math/tex">i</script>-th mode. Its linear response frequency is determined via the eigenvalue problem</p><p><span class="MathJax_Preview"><img alt="$$(\mathbf{M} \lambda_i^2+\mathbf{C} \lambda_i+\mathbf{K})\mathbf{v}_i= \mathbf{0}$$" src="Backbone_Curves_eq06716607839961756869-Rescaled.png" style="width: 140.4px; height: auto;"/></span><script type="math/tex">(\mathbf{M} \lambda_i^2+\mathbf{C} \lambda_i+\mathbf{K})\mathbf{v}_i= \mathbf{0}</script></p><p>where the resonance frequency is <span class="MathJax_Preview"><img alt="$\omega_i = \textrm{Im}(\lambda_i)$" src="Backbone_Curves_eq03821955069733391394-Rescaled.png" style="width: 66.0px; height: auto;"/></span><script type="math/tex">\omega_i = \textrm{Im}(\lambda_i)</script>.  Assume also that there are <a href="../Theory/2.%20SSM-Theory.html">no outer resonances</a> and procede with constructing a ROM on the autonomous SSM which is computed as a nonlinear continuation of <span class="MathJax_Preview"><img alt="$E_i = \textrm{span}(\mathbf{v}_i, \mathbf{\bar{v}}_i)$" src="Backbone_Curves_eq04062357686903648907-Rescaled.png" style="width: 97.2px; height: auto;"/></span><script type="math/tex">E_i = \textrm{span}(\mathbf{v}_i, \mathbf{\bar{v}}_i)</script> . The following figure (cf. Jain &amp; Haller, 2021) depicts how the manifold is embedded in the full space via the autonomous parametrisation <span class="MathJax_Preview"><img alt="$\mathbf{W(p)}$" src="Backbone_Curves_eq03001482981748780833-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\mathbf{W(p)}</script> of the invariant SSM.</p><p><img alt="" hspace="5" src="BackboneManifold.png" style="width:45%;" vspace="5"/> </p><p>The reduced dynamics for such a system are given as</p><p><span class="MathJax_Preview"><img alt="$\dot{\mathbf{p}} = \sum_{\mathbf{m}\in \mathbf{N}^2} \mathbf{R}_{\mathbf{m}} \mathbf{p}^{\mathbf m}$" src="Backbone_Curves_eq00160828078479761736-Rescaled.png" style="width: 109.2px; height: auto;"/></span><script type="math/tex">\dot{\mathbf{p}} = \sum_{\mathbf{m}\in \mathbf{N}^2} \mathbf{R}_{\mathbf{m}} \mathbf{p}^{\mathbf m}</script>.</p><p>To obtain an analytical expression for a backbone curve the parametrisation coordinates are transformed to polar notation. We set <span class="MathJax_Preview"><img alt="$$\mathbf{p} = [p, \bar{p}] = [\rho e^{i\theta}, \rho e^{-i\theta}]$" src="Backbone_Curves_eq06188098032939741758-Rescaled.png" style="width: 132.0px; height: auto;"/></span><script type="math/tex">$\mathbf{p} = [p, \bar{p}] = [\rho e^{i\theta}, \rho e^{-i\theta}]</script>$ . In the new coordinates the reduced dynamics read</p><p><span class="MathJax_Preview"><img alt="$$ \dot{\rho} = \textrm{Re} \bigg(  \sum_{\mathbf{m}} R^1_{\mathbf{m}} \rho^{|\mathbf{m}|}
\bigg)$$" src="Backbone_Curves_eq01244579203313523717-Rescaled.png" style="width: 121.19999999999999px; height: auto;"/></span><script type="math/tex"> \dot{\rho} = \textrm{Re} \bigg(  \sum_{\mathbf{m}} R^1_{\mathbf{m}} \rho^{|\mathbf{m}|}
\bigg)</script></p><p><span class="MathJax_Preview"><img alt="$$\omega(\rho) = \dot{\theta}  = \textrm{Im} \bigg(  \sum_{\mathbf{m}} R^1_{\mathbf{m}}
\rho^{|\mathbf{m}|-1} \bigg)$$" src="Backbone_Curves_eq08617974675774632345-Rescaled.png" style="width: 176.4px; height: auto;"/></span><script type="math/tex">\omega(\rho) = \dot{\theta}  = \textrm{Im} \bigg(  \sum_{\mathbf{m}} R^1_{\mathbf{m}}
\rho^{|\mathbf{m}|-1} \bigg)</script></p><p>For each polar amplitude a unique change in polar angle <span class="MathJax_Preview"><img alt="$\omega(\rho)$" src="Backbone_Curves_eq17245102621845043926-Rescaled.png" style="width: 25.2px; height: auto;"/></span><script type="math/tex">\omega(\rho)</script> thus results. This prompts us to define the backbone curve in this context as the collection of points which follow this analytical relation (cf. Szalai, Erhardt &amp; Haller 20017, Haller, Pedergnana &amp; Ponsioen 2018).</p><p>Now consider a particular amplitude <span class="MathJax_Preview"><img alt="$\rho_0$" src="Backbone_Curves_eq07254033305756636643-Rescaled.png" style="width: 10.799999999999999px; height: auto;"/></span><script type="math/tex">\rho_0</script> in the polar parametrisation space. The amplitude of a corresponding nonlinear periodic orbit of the full nonlinear physical system which oscillates with frequency <span class="MathJax_Preview"><img alt="$\omega(\rho_0)$" src="Backbone_Curves_eq10996811910299220392-Rescaled.png" style="width: 30.0px; height: auto;"/></span><script type="math/tex">\omega(\rho_0)</script> is then given by</p><p><span class="MathJax_Preview"><img alt="$\textrm{A}(\rho_0) = \frac{1}{2\pi} \int^{2\pi}_0 || \mathbf{W(p}(\rho_0,\theta))||_2 d\theta$" src="Backbone_Curves_eq12920000186583911343-Rescaled.png" style="width: 189.6px; height: auto;"/></span><script type="math/tex">\textrm{A}(\rho_0) = \frac{1}{2\pi} \int^{2\pi}_0 || \mathbf{W(p}(\rho_0,\theta))||_2 d\theta</script> .</p><p>Thus, in the full system, the backbone curve computed on the SSM is given by the set <span class="MathJax_Preview"><img alt="$\{ \omega(\rho) , \textrm{A}(\rho) \}$" src="Backbone_Curves_eq00618267643447527460-Rescaled.png" style="width: 70.8px; height: auto;"/></span><script type="math/tex">\{ \omega(\rho) , \textrm{A}(\rho) \}</script>. A depiction of this process is shown in the following figure (cf. Ponsioen, Pedergnana &amp; Haller 2018)</p><p><img alt="" hspace="5" src="BackboneFromManifold.png" style="width:45%;" vspace="5"/> </p><h2 id="2">Example</h2><p>As an example, we take the system of an &lt;oscillatory chain.html &gt; with cubic nonlinearities, as treated in our toolbox.</p><p><img alt="" hspace="5" src="OscillatorChain.png" style="width:35%;" vspace="5"/> </p><p>Setup</p><pre class="codeinput">clear <span class="string">DS</span> <span class="string">S</span>
n = 10;
m = 1;
k = 1;
c = 0.1;
kappa2 = 0;
kappa3 = 0.5;

[M,C,K,fnl,~] = build_model(n,m,c,k,kappa2,kappa3);
DS = <a href="../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,<span class="string">'M'</span>,M,<span class="string">'C'</span>,C,<span class="string">'K'</span>,K,<span class="string">'fnl'</span>,fnl);
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'Emax'</span>,5,<span class="string">'Nmax'</span>,10,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
        </pre><p>To analyse the nonlinear forced response of the assume periodic forcing of the form</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi}
+ \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$" src="Backbone_Curves_eq05163577920011297423-Rescaled.png" style="width: 201.6px; height: auto;"/></span><script type="math/tex">\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi}
+ \frac{\mathbf{f}_0}{2}e^{-i\phi}  </script></p><p>with amplitued <span class="MathJax_Preview"><img alt="$\epsilon$" src="Backbone_Curves_eq04319661244345371386-Rescaled.png" style="width: 4.8px; height: auto;"/></span><script type="math/tex">\epsilon</script>.</p><pre class="codeinput">epsilon = 5e-3;
f_0 = ones(n,1);
kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
        </pre><h2 id="4">Linear Modal analysis and SSM setup</h2><pre class="codeinput">[V,D,W] = DS.<a href="../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
        </pre><pre class="codeoutput">Due to high-dimensionality, we compute only the first 5 eigenvalues with the smallest magnitude. These would also be used to compute the spectral quotients
Assuming a proportional damping hypthesis with symmetric matrices
modal damping ratio for 1 mode is 1.423148e-02
modal damping ratio for 2 mode is 2.817326e-02
modal damping ratio for 3 mode is 4.154150e-02
modal damping ratio for 4 mode is 5.406408e-02
modal damping ratio for 5 mode is 6.548607e-02

 The first 10 nonzero eigenvalues are given as 
  -0.0041 + 0.2846i
  -0.0041 - 0.2846i
  -0.0159 + 0.5632i
  -0.0159 - 0.5632i
  -0.0345 + 0.8301i
  -0.0345 - 0.8301i
  -0.0585 + 1.0797i
  -0.0585 - 1.0797i
  -0.0858 + 1.3069i
  -0.0858 - 1.3069i

</pre><p><b>Choose Master subspace (perform resonance analysis)</b></p><pre class="codeinput">S = <a href="../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 0.1,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
masterModes = [1,2];
S.<a href="../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
        </pre><pre class="codeoutput">(near) outer resonance detected for the following combination of master eigenvalues
     2     0
     3     1
     4     2
     5     3
     6     4
     0     2
     1     3
     2     4
     3     5
     4     6
     4     1
     5     2
     6     3
     1     4
     2     5
     3     6

These are in resonance with the follwing eigenvalues of the slave subspace
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i

sigma_out = 21
(near) inner resonance detected for the following combination of master eigenvalues
     2     1
     3     2
     4     3
     1     2
     2     3
     3     4

These are in resonance with the follwing eigenvalues of the master subspace
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i

sigma_in = 21
</pre><h2 id="6">Setup SSM computation</h2><p>We choose to use a continuation based approach to obtain the FRC directly from the ROM on the SSM. The following parameters are chosen for continuation.</p><pre class="codeinput">order = 7; <span class="comment">% Approximation order</span>
outdof = floor(n/2);
set(S.<a href="../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 1,<span class="string">'IRtol'</span>,0.02,<span class="string">'notation'</span>, <span class="string">'multiindex'</span>)
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'nt'</span>, 2^7,  <span class="string">'nPar'</span>, 100, <span class="string">'outdof'</span>,outdof)
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">'continuation ep'</span>)
set(S.contOptions,<span class="string">'h0'</span>,0.01,<span class="string">'h_max'</span>,0.1)
        </pre><p>choose frequency range</p><pre class="codeinput">omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.8 1.2];
<span class="comment">% Extract Backbone Curve</span>

BB = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_backbone.html">extract_backbone</a>(masterModes,omegaRange, order);
        </pre><pre class="codeoutput">(near) outer resonance detected for the following combination of master eigenvalues
     2     0
     2     1
     3     1
     3     2
     4     2
     4     3
     5     3
     5     4
     6     4
     0     2
     1     2
     1     3
     2     3
     2     4
     3     4
     3     5
     4     5
     4     6
     2     0
     3     0
     3     1
     4     1
     4     2
     5     2
     5     3
     6     3
     6     4
     0     2
     0     3
     1     3
     1     4
     2     4
     2     5
     3     5
     3     6
     4     6
     3     0
     4     0
     4     1
     5     1
     5     2
     6     2
     6     3
     7     3
     0     3
     0     4
     1     4
     1     5
     2     5
     2     6
     3     6
     3     7
     4     0
     5     0
     5     1
     6     1
     6     2
     7     2
     7     3
     0     4
     0     5
     1     5
     1     6
     2     6
     2     7
     3     7

These are in resonance with the follwing eigenvalues of the slave subspace
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i

sigma_out = 21
(near) inner resonance detected for the following combination of master eigenvalues
     2     1
     3     2
     4     3
     5     4
     1     2
     2     3
     3     4
     4     5

These are in resonance with the follwing eigenvalues of the master subspace
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i

sigma_in = 21
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.70E-02 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 2.24E-02 MB
Manifold computation time at order 4 = 00:00:00
Estimated memory usage at order  4 = 3.25E-02 MB
Manifold computation time at order 5 = 00:00:00
Estimated memory usage at order  5 = 4.51E-02 MB
Manifold computation time at order 6 = 00:00:00
Estimated memory usage at order  6 = 6.22E-02 MB
Manifold computation time at order 7 = 00:00:00
Estimated memory usage at order  7 = 8.40E-02 MB
gamma = 
   0.0000 + 0.0024i
  -0.0000 - 0.0000i
  -0.0000 + 0.0000i

Total time spent on backbone curve computation = 00:00:01
</pre><img alt="" hspace="5" src="Backbone_Curves_01.png" vspace="5"/> <img alt="" hspace="5" src="Backbone_Curves_02.png" vspace="5"/> <p><b>Extract Forced Response Curve</b></p><pre class="codeinput">FRC = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>(<span class="string">'freq'</span>,omegaRange,order);
        </pre><pre class="codeoutput">*****************************************
Calculating FRC using SSM with master subspace: [1  2]
(near) outer resonance detected for the following combination of master eigenvalues
     2     0
     2     1
     3     1
     3     2
     4     2
     4     3
     5     3
     5     4
     6     4
     0     2
     1     2
     1     3
     2     3
     2     4
     3     4
     3     5
     4     5
     4     6
     2     0
     3     0
     3     1
     4     1
     4     2
     5     2
     5     3
     6     3
     6     4
     0     2
     0     3
     1     3
     1     4
     2     4
     2     5
     3     5
     3     6
     4     6
     3     0
     4     0
     4     1
     5     1
     5     2
     6     2
     6     3
     7     3
     0     3
     0     4
     1     4
     1     5
     2     5
     2     6
     3     6
     3     7
     4     0
     5     0
     5     1
     6     1
     6     2
     7     2
     7     3
     0     4
     0     5
     1     5
     1     6
     2     6
     2     7
     3     7

These are in resonance with the follwing eigenvalues of the slave subspace
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 + 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0159 - 0.5632i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 + 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0345 - 0.8301i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 + 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0585 - 1.0797i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 + 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i
  -0.0858 - 1.3069i

sigma_out = 21
(near) inner resonance detected for the following combination of master eigenvalues
     2     1
     3     2
     4     3
     5     4
     1     2
     2     3
     3     4
     4     5

These are in resonance with the follwing eigenvalues of the master subspace
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 + 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i
  -0.0041 - 0.2846i

sigma_in = 21
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.70E-02 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 2.24E-02 MB
Manifold computation time at order 4 = 00:00:00
Estimated memory usage at order  4 = 3.25E-02 MB
Manifold computation time at order 5 = 00:00:00
Estimated memory usage at order  5 = 4.51E-02 MB
Manifold computation time at order 6 = 00:00:00
Estimated memory usage at order  6 = 6.22E-02 MB
Manifold computation time at order 7 = 00:00:00
Estimated memory usage at order  7 = 8.40E-02 MB

 Run='freqSubint1.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          7.62e-06  8.44e+00    0.0    0.0    0.0
   1   1  1.00e+00  4.49e-05  4.53e-12  8.44e+00    0.0    0.0    0.0
   2   1  1.00e+00  3.49e-10  1.56e-16  8.44e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   8.4360e+00      1  EP      2.8461e-01   1.6869e+00   5.7146e+00   5.0000e-03
   10  00:00:00   8.5208e+00      2          2.7791e-01   1.2016e+00   5.8975e+00   5.0000e-03
   20  00:00:00   8.6918e+00      3          2.6101e-01   5.2987e-01   6.1176e+00   5.0000e-03
   25  00:00:00   8.7973e+00      4  EP      2.2768e-01   2.2778e-01   6.2123e+00   5.0000e-03

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   8.4360e+00      5  EP      2.8461e-01   1.6869e+00   5.7146e+00   5.0000e-03
   10  00:00:00   8.3414e+00      6          2.9084e-01   2.1513e+00   5.4842e+00   5.0000e-03
   20  00:00:01   8.0042e+00      7          2.9893e-01   2.6475e+00   4.9935e+00   5.0000e-03
   30  00:00:01   7.3774e+00      8          3.0167e-01   2.6662e+00   4.4736e+00   5.0000e-03
   31  00:00:01   7.3641e+00      9  SN      3.0167e-01   2.6626e+00   4.4648e+00   5.0000e-03
   31  00:00:01   7.3641e+00     10  FP      3.0167e-01   2.6626e+00   4.4648e+00   5.0000e-03
   40  00:00:01   6.4602e+00     11          2.9961e-01   2.2176e+00   3.9824e+00   5.0000e-03
   50  00:00:01   5.6676e+00     12          2.9747e-01   1.5851e+00   3.6687e+00   5.0000e-03
   52  00:00:01   5.5699e+00     13  SN      2.9742e-01   1.4924e+00   3.6327e+00   5.0000e-03
   52  00:00:01   5.5699e+00     14  FP      2.9742e-01   1.4924e+00   3.6327e+00   5.0000e-03
   60  00:00:01   5.0425e+00     15          3.0015e-01   9.1890e-01   3.4321e+00   5.0000e-03
   70  00:00:01   4.5896e+00     16          3.3742e-01   2.4657e-01   3.2183e+00   5.0000e-03
   71  00:00:01   4.5806e+00     17  EP      3.4152e-01   2.2876e-01   3.2128e+00   5.0000e-03
Total time spent on FRC computation upto O(7) = 00:00:03
</pre><img alt="" hspace="5" src="Backbone_Curves_03.png" vspace="5"/> <img alt="" hspace="5" src="Backbone_Curves_04.png" vspace="5"/> <p>Now we proceed to plot the backbone curve on top of the forced response, for visualising the relation between the two quantities.</p><pre class="codeinput">hold <span class="string">on</span>;
plot([BB.Omega],[BB.Aout], <span class="string">'Color'</span> , <span class="string">'black'</span>, <span class="string">'LineWidth'</span>,4)
legend(<span class="string">'$$\textrm{SSM - }\mathcal{O}(7)$$'</span>,<span class="string">''</span>,<span class="string">'Backbone Curve'</span>,<span class="string">'Interpreter'</span>,<span class="string">'latex'</span>)
        </pre><img alt="" hspace="5" src="Backbone_Curves_05.png" vspace="5"/> <p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% Computing backbone curves
% 
% 
% Let us consider an autonomous dynamical mechanical system 
% 
% $$\mathbf{M\ddot{x}+C\dot{x}+Kx +f(x,\dot{x}) = 0}$$
% 
% with nonlinear internal forces $\mathbf{f(x,\dot{x}})$. 
% 
% The backbone curve of such a system is defined as the collection of points 
% which sit at the locus, ie. the point of maximal amplitude, of the nonlinear 
% forced oscillations of a system. In this tutorial will motivate how such a curve 
% can be obtained directly from the ROM provided by the reduced dynamics on a 
% 2-dimensional SSM. In the following figure an illustration of a backbone curve 
% is given, along with the forced response with various forcing amplitudes. Depending 
% on the magnitude and characteristics of the nonlinear internal forces, the curve 
% will bend in different ways, thus giving conclusive results about they system's 
% nonlinear properties.
% 
% <<BackBoneIllustration.png>> 
%
%% SSM Computation
% Assume we are interested in the nonlinear behaviour of the $i$-th mode. Its 
% linear response frequency is determined via the eigenvalue problem
% 
% $$(\mathbf{M} \lambda_i^2+\mathbf{C} \lambda_i+\mathbf{K})\mathbf{v}_i= \mathbf{0}$$
% 
% where the resonance frequency is $\omega_i = \textrm{Im}(\lambda_i)$.  Assume 
% also that there are <../Theory/2.%20SSM-Theory.html no outer resonances> and procede 
% with constructing a ROM on the autonomous SSM which is computed as a nonlinear 
% continuation of $E_i = \textrm{span}(\mathbf{v}_i, \mathbf{\bar{v}}_i)$ . The 
% following figure (cf. Jain & Haller, 2021) depicts how the manifold is embedded 
% in the full space via the autonomous parametrisation $\mathbf{W(p)}$ of the 
% invariant SSM.
% 
% <<BackboneManifold.png>>
% 
% The reduced dynamics for such a system are given as
% 
% $\dot{\mathbf{p}} = \sum_{\mathbf{m}\in \mathbf{N}^2} \mathbf{R}_{\mathbf{m}} 
% \mathbf{p}^{\mathbf m}$.
% 
% To obtain an analytical expression for a backbone curve the parametrisation 
% coordinates are transformed to polar notation. We set $$\mathbf{p} = [p, \bar{p}] 
% = [\rho e^{i\theta}, \rho e^{-i\theta}]$$ . In the new coordinates the reduced 
% dynamics read
% 
% $$ \dot{\rho} = \textrm{Re} \bigg(  \sum_{\mathbf{m}} R^1_{\mathbf{m}} \rho^{|\mathbf{m}|} 
% \bigg)$$
% 
% $$\omega(\rho) = \dot{\theta}  = \textrm{Im} \bigg(  \sum_{\mathbf{m}} R^1_{\mathbf{m}} 
% \rho^{|\mathbf{m}|-1} \bigg)$$
% 
% For each polar amplitude a unique change in polar angle $\omega(\rho)$ thus 
% results. This prompts us to define the backbone curve in this context as the 
% collection of points which follow this analytical relation (cf. Szalai, Erhardt 
% & Haller 20017, Haller, Pedergnana & Ponsioen 2018).
% 
% Now consider a particular amplitude $\rho_0$ in the polar parametrisation 
% space. The amplitude of a corresponding nonlinear periodic orbit of the full 
% nonlinear physical system which oscillates with frequency $\omega(\rho_0)$ is 
% then given by
% 
% $\textrm{A}(\rho_0) = \frac{1}{2\pi} \int^{2\pi}_0 || \mathbf{W(p}(\rho_0,\theta))||_2 
% d\theta$ .
% 
% Thus, in the full system, the backbone curve computed on the SSM is given 
% by the set $\{ \omega(\rho) , \textrm{A}(\rho) \}$. A depiction of this process 
% is shown in the following figure (cf. Ponsioen, Pedergnana & Haller 2018)
% 
% <<BackboneFromManifold.png>>
% 
%% Example
% As an example, we take the system of an <oscillatory chain.html > with cubic 
% nonlinearities, as treated in our toolbox. 
% 
% <<OscillatorChain.png>>
%
% Setup
clear DS S
n = 10;
m = 1;
k = 1;
c = 0.1;
kappa2 = 0;
kappa3 = 0.5;

[M,C,K,fnl,~] = build_model(n,m,c,k,kappa2,kappa3);
DS = <a href="../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,'M',M,'C',C,'K',K,'fnl',fnl);
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','multiindex')
%% 
% To analyse the nonlinear forced response of the assume periodic forcing of 
% the form
% 
% $$\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi} 
% + \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$
% 
% with amplitued $\epsilon$.

epsilon = 5e-3;
f_0 = ones(n,1);
kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
%% Linear Modal analysis and SSM setup

[V,D,W] = DS.<a href="../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
%% 
% *Choose Master subspace (perform resonance analysis)*

S = <a href="../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.1,'notation','multiindex')
masterModes = [1,2]; 
S.<a href="../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
%% Setup SSM computation
% We choose to use a continuation based approach to obtain the FRC directly 
% from the ROM on the SSM. The following parameters are chosen for continuation.

order = 7; % Approximation order
outdof = floor(n/2);
set(S.<a href="../Library/Features/Options/Options.html">Options</a>, 'reltol', 1,'IRtol',0.02,'notation', 'multiindex')
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'nt', 2^7,  'nPar', 100, 'outdof',outdof)
set(S.<a href="../Library/Features/Options/Options.html">FRCOptions</a>, 'method','continuation ep')  
set(S.contOptions,'h0',0.01,'h_max',0.1)
%% 
% choose frequency range

omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.8 1.2];
% Extract Backbone Curve

BB = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_backbone.html">extract_backbone</a>(masterModes,omegaRange, order);
%% 
% *Extract Forced Response Curve*

FRC = S.<a href="../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>('freq',omegaRange,order);
%% 
% Now we proceed to plot the backbone curve on top of the forced response, for 
% visualising the relation between the two quantities.

hold on;
plot([BB.Omega],[BB.Aout], 'Color' , 'black', 'LineWidth',4)
legend('$$\textrm{SSM - }\mathcal{O}(7)$$','','Backbone Curve','Interpreter','latex')
            ##### SOURCE END #####
        --></body></html></body></html>