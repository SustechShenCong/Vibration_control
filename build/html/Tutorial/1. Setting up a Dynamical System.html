
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../index.html"><img alt="Logo" class="logo" src="../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>Setting up Dynamical Systems</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-07" name="DC.date"/><meta content="SetupDS_Explanation.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>Setting up Dynamical Systems</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Setting up a Second Order Dynamical System</a></li><li><a href="#13">Setting up a First Order Dynamical System</a></li><li><a href="#23">Specifications</a></li><li><a href="#24">Methods</a></li></ul></div><p>A dynamical system object is initialised using</p><pre class="codeinput">DS = <a href="../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();

<span class="comment">% In an initial step the order of the dynamical system has to be specified. This can be done via</span>
<span class="comment">%</span>

set(DS,<span class="string">'order'</span>,order)
        </pre><p>Depending on the dynamical system which is to be analysed, the following procedures have to be followed.</p><h2 id="3">Setting up a Second Order Dynamical System</h2><p>In this section we explain how DynamicalSystem constructs a dynamical system object in second order form which is given as:</p><p><span class="MathJax_Preview"><img alt="$\mathbf{M}\ddot{\mathbf{x}} + \mathbf{C} \dot{\mathbf x} + \mathbf{K} \mathbf{x} + \mathbf{f}_{\textrm{nl}}(\mathbf{x},\dot{\mathbf{x}}) = \epsilon \mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t)$" src="SetupDS_Explanation_eq04678586331555477451-Rescaled.png" style="width: 229.2px; height: auto;"/></span><script type="math/tex">\mathbf{M}\ddot{\mathbf{x}} + \mathbf{C} \dot{\mathbf x} + \mathbf{K} \mathbf{x} + \mathbf{f}_{\textrm{nl}}(\mathbf{x},\dot{\mathbf{x}}) = \epsilon \mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t)</script> - Second order</p><p>The linear system matrices can be set via the set method of the class as</p><pre class="codeinput">set(DS,<span class="string">'M'</span>,M,<span class="string">'C'</span>,C,<span class="string">'K'</span>,K);
        </pre><p><span class="MathJax_Preview"><img alt="$\mathbf{f}_{\textrm{nl}}\mathbf{(z)}$" src="SetupDS_Explanation_eq04687026135933231346-Rescaled.png" style="width: 32.4px; height: auto;"/></span><script type="math/tex">\mathbf{f}_{\textrm{nl}}\mathbf{(z)}</script> is a nonlinear polynomial function of degree two or higher an can also be set with the set method as.</p><pre class="codeinput">set(DS,<span class="string">'fnl'</span>,fnl);
        </pre><p>This nonlinear force may be prepared in one of the following ways:</p><p><b>Using tensor format:</b></p><p>In tensor notation the second order nonlinear internal forces are expanded as</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{f(z)} = \sum_{i&gt;2} \mathbf{f}_i \mathbf{z}^{\otimes i} $$" src="SetupDS_Explanation_eq00017585796174340003-Rescaled.png" style="width: 87.6px; height: auto;"/></span><script type="math/tex"> \mathbf{f(z)} = \sum_{i>2} \mathbf{f}_i \mathbf{z}^{\otimes i} </script></p><p>The order i nonlinearity is thus represented by a <span class="MathJax_Preview"><img alt="$1+i$" src="SetupDS_Explanation_eq11199736204054488588-Rescaled.png" style="width: 26.4px; height: auto;"/></span><script type="math/tex">1+i</script> dimensional tensor <span class="MathJax_Preview"><img alt="$\mathbf{f}_{i} \in \bf{C}^{N\times N^i}$" src="SetupDS_Explanation_eq02447067203671279760-Rescaled.png" style="width: 62.4px; height: auto;"/></span><script type="math/tex">\mathbf{f}_{i} \in \bf{C}^{N\times N^i}</script>. For implementation it is represented by a multidimensional array of dimension <span class="MathJax_Preview"><img alt="$1+i$" src="SetupDS_Explanation_eq11199736204054488588-Rescaled.png" style="width: 26.4px; height: auto;"/></span><script type="math/tex">1+i</script>. These arrays are stored in a cell array. So in this case one might obtain the order i nonlinearity as</p><pre class="codeinput">fi = f{i}
        </pre><p>Here <span class="MathJax_Preview"><img alt="$\mathbf{f}_{\textrm{nl}}(\mathbf{x})$" src="SetupDS_Explanation_eq18131492522389164224-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\mathbf{f}_{\textrm{nl}}(\mathbf{x})</script> is a polynomial function of degree two or higher, which is stored as a cell array such that <span class="MathJax_Preview"><img alt="$\texttt{fnl\{k\}}$" src="SetupDS_Explanation_eq04145900477902751146-Rescaled.png" style="width: 40.8px; height: auto;"/></span><script type="math/tex">\texttt{fnl\{k\}}</script> corresponds to polynomials of degree k+1. <span class="MathJax_Preview"><img alt="$\texttt{fnl\{k\}}$" src="SetupDS_Explanation_eq04145900477902751146-Rescaled.png" style="width: 40.8px; height: auto;"/></span><script type="math/tex">\texttt{fnl\{k\}}</script> is given by a tensor of order k+2, where the first mode corresponds to indices for the force vector.</p><p><b>Using multi-index format:</b> In multi-index notation the second order nonlinear internal forces are expanded as</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{f}_{\textrm{nl}}(\mathbf{z}) = \sum_{\mathbf{m} \in \bf{N}^N} \mathbf{f}_\mathbf{m} \mathbf{z}^{\mathbf{m}} $$" src="SetupDS_Explanation_eq12373953322256950519-Rescaled.png" style="width: 114.0px; height: auto;"/></span><script type="math/tex"> \mathbf{f}_{\textrm{nl}}(\mathbf{z}) = \sum_{\mathbf{m} \in \bf{N}^N} \mathbf{f}_\mathbf{m} \mathbf{z}^{\mathbf{m}} </script></p><p>The variate monomials in this expansion are written as <span class="MathJax_Preview"><img alt="$\mathbf{z^m} = {z_1}^{m_1}\cdot {z_2}^{m_2} \cdots {z_N}^{m_N}$" src="SetupDS_Explanation_eq11912931119713578197-Rescaled.png" style="width: 140.4px; height: auto;"/></span><script type="math/tex">\mathbf{z^m} = {z_1}^{m_1}\cdot {z_2}^{m_2} \cdots {z_N}^{m_N}</script>. The nonlinearity in this case is stored in a struct array with fields that characterise its coefficients and the corresponding multi-indices. Thus the relevant quantities are stored</p><pre class="codeinput">fm = f(m_abs).coeffs
fm  = f(m_abs).ind
        </pre><p>This extracts all coefficients of the Taylor expansion and the corresponding order <span class="MathJax_Preview"><img alt="$\texttt{m\_abs}$" src="SetupDS_Explanation_eq08135512898624689664-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\texttt{m\_abs}</script> multi-indices m. So <span class="MathJax_Preview"><img alt="$\texttt{Fm}$" src="SetupDS_Explanation_eq11575632709280276622-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">\texttt{Fm}</script> is a <span class="MathJax_Preview"><img alt="${n\times z_m}$" src="SetupDS_Explanation_eq01772266207372371750-Rescaled.png" style="width: 38.4px; height: auto;"/></span><script type="math/tex">{n\times z_m}</script> and <span class="MathJax_Preview"><img alt="$\texttt{m}$" src="SetupDS_Explanation_eq06526987937351057959-Rescaled.png" style="width: 7.199999999999999px; height: auto;"/></span><script type="math/tex">\texttt{m}</script> is a <span class="MathJax_Preview"><img alt="${n\times z_m}$" src="SetupDS_Explanation_eq01772266207372371750-Rescaled.png" style="width: 38.4px; height: auto;"/></span><script type="math/tex">{n\times z_m}</script> dimensional array, where <span class="MathJax_Preview"><img alt="$z_m$" src="SetupDS_Explanation_eq10289523351549176358-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">z_m</script> denotes the number of unique multi-indices at order <span class="MathJax_Preview"><img alt="$\texttt{m\_abs}$" src="SetupDS_Explanation_eq08135512898624689664-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\texttt{m\_abs}</script>.</p><p>In case of velocity-independent internal forces, the tensors and multi-indices are of lower dimensionality respectively, as they only require half the input variables to describe the action of the forces.</p><p><b>Second order external excitation</b></p><p>The external force is provided as a Fourier Expansion in terms of the relevant harmonics.</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t) = \sum_{i} \mathbf{f}_{\mathbf{\kappa}_i} \textrm{e}^{i \mathbf{\kappa}_i \cdot \mathbf{\Omega}t} $$" src="SetupDS_Explanation_eq10634450166393291275-Rescaled.png" style="width: 132.0px; height: auto;"/></span><script type="math/tex"> \mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t) = \sum_{i} \mathbf{f}_{\mathbf{\kappa}_i} \textrm{e}^{i \mathbf{\kappa}_i \cdot \mathbf{\Omega}t} </script></p><p>Furthermore the forcing frequency is given by a frequency vector. This force may be input to the dynamical system in various formats:</p><p><b>Format 1: As a struct array</b></p><pre class="codeinput">fext.epsilon = epsilon
fext.data    = data
        </pre><p>where <span class="MathJax_Preview"><img alt="$\texttt{data}$" src="SetupDS_Explanation_eq08003352684765911397-Rescaled.png" style="width: 28.799999999999997px; height: auto;"/></span><script type="math/tex">\texttt{data}</script> is a struct array with entries</p><pre class="codeinput">data(i).kappa = kappa_i
data(i).coeffs = f_kappa_i
        </pre><p>In this case it is passed to the DS object as</p><pre class="codeinput">DS.<a href="../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(fext)
        </pre><p><b>Format 2: With harmonics and coefficients</b></p><p>If only a single harmonic is used for a periodic excitation, the harmonics <span class="MathJax_Preview"><img alt="$\kappa_i$" src="SetupDS_Explanation_eq04175917924676243930-Rescaled.png" style="width: 10.799999999999999px; height: auto;"/></span><script type="math/tex">\kappa_i</script> and the coefficients <span class="MathJax_Preview"><img alt="$\mathbf{f}_{\kappa_i}$" src="SetupDS_Explanation_eq02660542571413082894-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\mathbf{f}_{\kappa_i}</script> can be input manually as</p><pre class="codeinput">coeffs = [f_kappa_1, f_kappa_2]
Kappas = [kappa_1, kappa_2]
        </pre><p>The second order form is converted into the first order form with</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],
\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} &amp; \mathbf{0}\\\mathbf{0} &amp; \mathbf{M}\end{array}\right],
\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} &amp; \mathbf{M}\\\mathbf{M} &amp; \mathbf{0}\end{array}\right],
\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}-\mathbf{f}_{\textrm{nl}}(\mathbf{x},\dot{\mathbf{x}})\\\mathbf{0}\end{array}\right],
\quad\mathbf{F}_\textrm{ext}(\mathbf{z},\mathbf{\Omega} t) =\left[\begin{array}{c}\mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t)\\ \mathbf{0}  \end{array}\right] $$" src="SetupDS_Explanation_eq14245467934836547411-Rescaled.png" style="width: 636.0px; height: auto;"/></span><script type="math/tex"> \mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],
\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} & \mathbf{0}\\\mathbf{0} & \mathbf{M}\end{array}\right],
\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} & \mathbf{M}\\\mathbf{M} & \mathbf{0}\end{array}\right],
\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}-\mathbf{f}_{\textrm{nl}}(\mathbf{x},\dot{\mathbf{x}})\\\mathbf{0}\end{array}\right],
\quad\mathbf{F}_\textrm{ext}(\mathbf{z},\mathbf{\Omega} t) =\left[\begin{array}{c}\mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t)\\ \mathbf{0}  \end{array}\right] </script></p><h2 id="13">Setting up a First Order Dynamical System</h2><p>In this section we explain how the <span class="MathJax_Preview"><img alt="$\texttt{DynamicalSystem}$" src="SetupDS_Explanation_eq00128815650107812712-Rescaled.png" style="width: 104.39999999999999px; height: auto;"/></span><script type="math/tex">\texttt{DynamicalSystem}</script> class constructs a dynamical system object in first order form which is given as:</p><p><span class="MathJax_Preview"><img alt="$\mathbf{B} \dot{\mathbf{z}} = \mathbf{A}(\mathbf{z}) + \mathbf{F}(\mathbf{z}) +  \epsilon \mathbf{F}_{\textrm{ext}}(\mathbf{\Omega} t)$" src="SetupDS_Explanation_eq00837331975761793279-Rescaled.png" style="width: 181.2px; height: auto;"/></span><script type="math/tex">\mathbf{B} \dot{\mathbf{z}} = \mathbf{A}(\mathbf{z}) + \mathbf{F}(\mathbf{z}) +  \epsilon \mathbf{F}_{\textrm{ext}}(\mathbf{\Omega} t)</script> The linear system matrices can be set via the set method of the class as</p><pre class="codeinput">set(DS,<span class="string">'A'</span>,A,<span class="string">'B'</span>,B);
        </pre><p><span class="MathJax_Preview"><img alt="$\mathbf{F(z)}$" src="SetupDS_Explanation_eq16523604610276859967-Rescaled.png" style="width: 26.4px; height: auto;"/></span><script type="math/tex">\mathbf{F(z)}</script> is a nonlinear polynomial function of degree two or higher an can also be set with the set method as.</p><pre class="codeinput">set(DS,<span class="string">'F'</span>,F);
        </pre><p>This nonlinear force may be prepared in one of the following ways:</p><p><b>Using tensor format:</b></p><p>In tensor notation the first order nonlinear internal forces are expanded as</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{F(z)} = \sum_{i&gt;2} \mathbf{F}_i \mathbf{z}^{\otimes i} $$" src="SetupDS_Explanation_eq05615838552188350542-Rescaled.png" style="width: 96.0px; height: auto;"/></span><script type="math/tex"> \mathbf{F(z)} = \sum_{i>2} \mathbf{F}_i \mathbf{z}^{\otimes i} </script></p><p>The order i nonlinearity is thus represented by a <span class="MathJax_Preview"><img alt="$1+i$" src="SetupDS_Explanation_eq11199736204054488588-Rescaled.png" style="width: 26.4px; height: auto;"/></span><script type="math/tex">1+i</script> dimensional tensor <span class="MathJax_Preview"><img alt="$\mathbf{F}_ \in \bf{C}^{N\times N^i}$" src="SetupDS_Explanation_eq03258482717958427029-Rescaled.png" style="width: 54.0px; height: auto;"/></span><script type="math/tex">\mathbf{F}_ \in \bf{C}^{N\times N^i}</script>. For implementation it is represented by a multidimensional array of dimension <span class="MathJax_Preview"><img alt="$1+i$" src="SetupDS_Explanation_eq11199736204054488588-Rescaled.png" style="width: 26.4px; height: auto;"/></span><script type="math/tex">1+i</script>. These arrays are stored in a cell array. So in this case one might obtain the order i nonlinearity as</p><pre class="codeinput">Fi = F{i}
        </pre><p><b>Using multi-index format:</b> In multi-index notation the first order nonlinear internal forces are expanded as</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{F(z)} = \sum_{\mathbf{m} \in \bf{N}^N} \mathbf{F}_\mathbf{m} \mathbf{z}^{\mathbf{m}} $$" src="SetupDS_Explanation_eq00708066846336567344-Rescaled.png" style="width: 111.6px; height: auto;"/></span><script type="math/tex"> \mathbf{F(z)} = \sum_{\mathbf{m} \in \bf{N}^N} \mathbf{F}_\mathbf{m} \mathbf{z}^{\mathbf{m}} </script></p><p>The variate monomials in this expansion are written as <span class="MathJax_Preview"><img alt="$\mathbf{z^m} = {z_1}^{m_1}\cdot {z_2}^{m_2} \cdots {z_N}^{m_N}$" src="SetupDS_Explanation_eq11912931119713578197-Rescaled.png" style="width: 140.4px; height: auto;"/></span><script type="math/tex">\mathbf{z^m} = {z_1}^{m_1}\cdot {z_2}^{m_2} \cdots {z_N}^{m_N}</script>. The nonlinearity in this case is stored in a struct array with fields that characterise its coefficients and the corresponding multi-indices. Thus the relevant quantities are stored</p><pre class="codeinput">Fm = F(m_abs).coeffs
m  = F(m_abs).ind
        </pre><p>This extracts all coefficients of the Taylor expansion and the corresponding order <span class="MathJax_Preview"><img alt="$\texttt{m\_abs}$" src="SetupDS_Explanation_eq08135512898624689664-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\texttt{m\_abs}</script> multi-indices m. So <span class="MathJax_Preview"><img alt="$\texttt{Fm}$" src="SetupDS_Explanation_eq11575632709280276622-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">\texttt{Fm}</script> is a <span class="MathJax_Preview"><img alt="${N\times n_m}$" src="SetupDS_Explanation_eq16809171553630169232-Rescaled.png" style="width: 44.4px; height: auto;"/></span><script type="math/tex">{N\times n_m}</script> and <span class="MathJax_Preview"><img alt="$\texttt{m}$" src="SetupDS_Explanation_eq06526987937351057959-Rescaled.png" style="width: 7.199999999999999px; height: auto;"/></span><script type="math/tex">\texttt{m}</script> is a <span class="MathJax_Preview"><img alt="${N\times n_m}$" src="SetupDS_Explanation_eq16809171553630169232-Rescaled.png" style="width: 44.4px; height: auto;"/></span><script type="math/tex">{N\times n_m}</script> dimensional array, where <span class="MathJax_Preview"><img alt="$n_m$" src="SetupDS_Explanation_eq01136303661338450254-Rescaled.png" style="width: 15.6px; height: auto;"/></span><script type="math/tex">n_m</script> denotes the number of unique multi-indices at order <span class="MathJax_Preview"><img alt="$\texttt{m\_abs}$" src="SetupDS_Explanation_eq08135512898624689664-Rescaled.png" style="width: 33.6px; height: auto;"/></span><script type="math/tex">\texttt{m\_abs}</script>.</p><p><b>First order external excitation</b></p><p>The external force is provided as a Fourier Expansion in terms of the relevant harmonics.</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{F}_{\textrm{ext}}(\mathbf{\Omega} t) = \sum_{i} \mathbf{F}_{\mathbf{\kappa}_i} \textrm{e}^{i \mathbf{\kappa}_i \cdot \mathbf{\Omega}t} $$" src="SetupDS_Explanation_eq04009029138195271630-Rescaled.png" style="width: 142.79999999999998px; height: auto;"/></span><script type="math/tex"> \mathbf{F}_{\textrm{ext}}(\mathbf{\Omega} t) = \sum_{i} \mathbf{F}_{\mathbf{\kappa}_i} \textrm{e}^{i \mathbf{\kappa}_i \cdot \mathbf{\Omega}t} </script></p><p>Furthermore the forcing frequency is given by a frequency vector. This force may be input to the dynamical system in various formats:</p><p><b>Format 1: As a struct array</b></p><pre class="codeinput">Fext.epsilon = epsilon
Fext.data    = data
        </pre><p>where <span class="MathJax_Preview"><img alt="$\texttt{data}$" src="SetupDS_Explanation_eq08003352684765911397-Rescaled.png" style="width: 28.799999999999997px; height: auto;"/></span><script type="math/tex">\texttt{data}</script> is a struct array with entries</p><pre class="codeinput">data(i).kappa = kappa_i
data(i).coeffs = F_kappa_i
        </pre><p>In this case it is passed to the DS object as</p><pre class="codeinput">DS.<a href="../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(Fext)
        </pre><p><b>Format 2: With harmonics and coefficients</b></p><p>If only a single harmonic is used for a periodic excitation, the harmonics <span class="MathJax_Preview"><img alt="$\kappa_i$" src="SetupDS_Explanation_eq04175917924676243930-Rescaled.png" style="width: 10.799999999999999px; height: auto;"/></span><script type="math/tex">\kappa_i</script> and the coefficients <span class="MathJax_Preview"><img alt="$\mathbf{F}_{\kappa_i}$" src="SetupDS_Explanation_eq05134220884157012679-Rescaled.png" style="width: 16.8px; height: auto;"/></span><script type="math/tex">\mathbf{F}_{\kappa_i}</script> can be input manually as</p><pre class="codeinput">coeffs = [F_kappa_1, F_kappa_2]
Kappas = [kappa_1, kappa_2]
        </pre><p>In general, the nonlinear and external forces are stored as follows:</p><p><img alt="" hspace="5" src="StoreForces.png" style="width: 500px; height: auto;" vspace="5"/> </p><h2 id="23">Specifications</h2><p>Several options can be passed to the dynamical system class, to further specify characteristics of the underlying system, as well as how it is supposed to be handled computationally. In the following they are presented with their default values. If a system with non default parameters is treated, these have to be adapted.</p><pre class="codeinput">set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'Nmax'</span>,6);               <span class="comment">% Maximal sytem size for which the full spectrum is computed</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'Emax'</span>,10);              <span class="comment">% Maximal number of Eigenvalues and -vectors that are computed if system size is larger than Nmax</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>);<span class="comment">% Notation in which nonlinear forces are to be handled, can be 'multiindex' or 'tensor'</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'RayleighDamping'</span>,true); <span class="comment">% Whether the underlying damping model is of Rayleigh Type</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'BaseExcitation'</span>,false); <span class="comment">% Whether the external force arises due to an excitation of the base which leads to a frequency dependent forcing amplitude.</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'DStype'</span>,<span class="string">'real'</span>);        <span class="comment">% To determine whether dynamical system possesses any complex valued quantities.</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'outDOF'</span>,[]);            <span class="comment">% For which DOF of the full system the relevant quantities should be explicitly displayed and stored.</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'HarmonicForce'</span>,true);   <span class="comment">% To determine whether time dependence of the external forcing is harmonic or not</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'lambdaThreshold'</span>,1e16); <span class="comment">% Threshold beyond which stiff eigenmodes will be removed</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'sigma'</span>,0);              <span class="comment">% value around which eigenvalues are computed. Is set to zero by default which corresponds to the 'smallestabs' setting in the built in eigs function.</span>
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'RemoveZeros'</span>,true);     <span class="comment">% Remove eigenvalues with zero real part from the spectrum. Relevant for the computation of center manifolds and in parameter dependent SSMs.</span>
        </pre><h2 id="24">Methods</h2><p>The first and crucial method which is provided for the DS class is the <span class="MathJax_Preview"><img alt="$\texttt{linear\_spectral\_analysis}$" src="SetupDS_Explanation_eq00753519996724805366-Rescaled.png" style="width: 162.0px; height: auto;"/></span><script type="math/tex">\texttt{linear\_spectral\_analysis}</script> method, which solves specified bits of the eigenvalue problem for the linear truncation of the dynamical system that is input. It is invoked via</p><pre class="codeinput">[V,D,W] = DS.<a href="../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
        </pre><p>When run, it outputs the three arguments the left and right eigenvectors and the eigenvalues of the eigenproblems</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{w}_i^* ( \lambda_i^2 \mathbf{M} + \lambda_i \mathbf{C} + \mathbf{K}) = \mathbf{0} $$" src="SetupDS_Explanation_eq14932873121275971779-Rescaled.png" style="width: 146.4px; height: auto;"/></span><script type="math/tex"> \mathbf{w}_i^* ( \lambda_i^2 \mathbf{M} + \lambda_i \mathbf{C} + \mathbf{K}) = \mathbf{0} </script></p><p><span class="MathJax_Preview"><img alt="$$ (\lambda_i^2\mathbf{M} + \lambda_i\mathbf{C} + \mathbf{K}) \mathbf{v}_i  = \mathbf{0} $$" src="SetupDS_Explanation_eq09560579515664014046-Rescaled.png" style="width: 140.4px; height: auto;"/></span><script type="math/tex"> (\lambda_i^2\mathbf{M} + \lambda_i\mathbf{C} + \mathbf{K}) \mathbf{v}_i  = \mathbf{0} </script></p><p>or</p><p><span class="MathJax_Preview"><img alt="$$ \mathbf{w}_i^* (\mathbf{A} - \lambda_i\mathbf{B}) = \mathbf{0} $$" src="SetupDS_Explanation_eq02347306921200208558-Rescaled.png" style="width: 102.0px; height: auto;"/></span><script type="math/tex"> \mathbf{w}_i^* (\mathbf{A} - \lambda_i\mathbf{B}) = \mathbf{0} </script></p><p><span class="MathJax_Preview"><img alt="$$ (\mathbf{A} - \lambda_i\mathbf{B}) \mathbf{v}_i  = \mathbf{0} $$" src="SetupDS_Explanation_eq04739084857932360356-Rescaled.png" style="width: 96.0px; height: auto;"/></span><script type="math/tex"> (\mathbf{A} - \lambda_i\mathbf{B}) \mathbf{v}_i  = \mathbf{0} </script></p><p>Furthermore it sets up an internal data structure with fields that contain the essential information about the truncated spectrum of the dynamical system which are used for invariant manifold computations.</p><p>For the evaluation of the nonlinear internal and the external forces the following functions are provided.</p><pre class="codeinput">fnl = DS.<a href="../Library/DynamicalSystem/compute_fnl.html">compute_fnl</a>(x,xd);
Fnl = DS.<a href="../Library/DynamicalSystem/evaluate_Fnl.html">evaluate_Fnl</a>(z);
fext = DS.<a href="../Library/DynamicalSystem/compute_fext.html">compute_fext</a>(t,x);
Fext = DS.<a href="../Library/DynamicalSystem/evaluate_Fext.html">evaluate_Fext</a>(t,z);
        </pre><p>These are also used for the construction of the governing ODE <span class="MathJax_Preview"><img alt="$\dot{z} = f(z,t)$" src="SetupDS_Explanation_eq07656679955587038723-Rescaled.png" style="width: 58.8px; height: auto;"/></span><script type="math/tex">\dot{z} = f(z,t)</script> which is evaluated via</p><pre class="codeinput">f = DS.<a href="../Library/DynamicalSystem/odefun.html">odefun</a>(t,z);
        </pre><p>Further functionalities which are provided for this class include the evaluation of the Jacobians of the nonlinear internal forces via</p><pre class="codeinput">dfnl = DS.<a href="../Library/DynamicalSystem/compute_dfnldx.html">compute_dfnldx</a>(x,xd);
dfnl = DS.<a href="../Library/DynamicalSystem/compute_dfnldxd.html">compute_dfnldxd</a>(x,xd);
        </pre><p>and the residual that may be used for the integration of ODEs,</p><pre class="codeinput">[ r, drdqdd,drdqd,drdq, c0] = DS.<a href="../Library/DynamicalSystem/residual.html">residual</a>(q, qd, qdd, t);
        </pre><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% Setting up Dynamical Systems 
%
%%
% A dynamical system object is initialised using
%

DS = <a href="../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();

% In an initial step the order of the dynamical system has to be specified. This can be done via
%

set(DS,'order',order)

%%
% Depending on the dynamical system which is to be analysed, the following
% procedures have to be followed.

%%% Setting up a Second Order Dynamical System
%
% In this section we explain how DynamicalSystem constructs a dynamical
% system object in second order form which is given as:
%
% $\mathbf{M}\ddot{\mathbf{x}} + \mathbf{C} \dot{\mathbf x} + \mathbf{K} \mathbf{x} + \mathbf{f}_{\textrm{nl}}(\mathbf{x},\dot{\mathbf{x}}) = \epsilon \mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t)$ - Second order
%
% The linear system matrices can be set via the set method of the class as

set(DS,'M',M,'C',C,'K',K);

%%
% $\mathbf{f}_{\textrm{nl}}\mathbf{(z)}$ is a nonlinear polynomial function of degree two or higher an can also be set with the set method as.
%

set(DS,'fnl',fnl);

%%
% This nonlinear force may be prepared in one of the following ways:
%
% *Using tensor format:*
%
% In tensor notation the second order nonlinear internal forces are expanded
% as 
%
% $$ \mathbf{f(z)} = \sum_{i>2} \mathbf{f}_i \mathbf{z}^{\otimes i} $$
%
% The order i nonlinearity is thus represented by a $1+i$ dimensional
% tensor $\mathbf{f}_{i} \in \bf{C}^{N\times N^i}$. For implementation it is represented by a multidimensional array
% of dimension $1+i$. These arrays are stored in a cell array. So in this case one might obtain the order i nonlinearity as
fi = f{i}
%%
% Here $\mathbf{f}_{\textrm{nl}}(\mathbf{x})$ is a polynomial function of degree two or higher, which
% is stored as a cell array such that $\texttt{fnl\{k\}}$ corresponds to polynomials
% of degree k+1. $\texttt{fnl\{k\}}$ is given by a tensor of order k+2, where the
% first mode corresponds to indices for the force vector.
%
% *Using multi-index format:*
% In multi-index notation the second order nonlinear internal forces are expanded
% as 
%
% $$ \mathbf{f}_{\textrm{nl}}(\mathbf{z}) = \sum_{\mathbf{m} \in \bf{N}^N} \mathbf{f}_\mathbf{m} \mathbf{z}^{\mathbf{m}} $$
% 
% The variate monomials in this expansion are written as $\mathbf{z^m} =
% {z_1}^{m_1}\cdot {z_2}^{m_2} \cdots {z_N}^{m_N}$. The nonlinearity in this case
% is stored in a struct array with fields that characterise its
% coefficients and the corresponding multi-indices. 
% Thus the relevant quantities are stored
%
fm = f(m_abs).coeffs
fm  = f(m_abs).ind
%%
% This extracts all coefficients of the Taylor expansion and the
% corresponding order $\texttt{m\_abs}$ multi-indices m. So $\texttt{Fm}$
% is a ${n\times z_m}$ and $\texttt{m}$ is a ${n\times z_m}$ dimensional
% array, where $z_m$ denotes the number of unique multi-indices at order
% $\texttt{m\_abs}$.
%
% In case of velocity-independent internal forces, the tensors and multi-indices are of lower dimensionality respectively, as they only 
% require half the input variables to describe the action of the forces.
%
%%
% *Second order external excitation*
%
% The external force is provided as a Fourier Expansion in terms of the relevant harmonics.
%
% $$ \mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t) = \sum_{i} \mathbf{f}_{\mathbf{\kappa}_i} \textrm{e}^{i \mathbf{\kappa}_i \cdot \mathbf{\Omega}t} $$
%
% Furthermore the forcing frequency is given by a frequency vector. This force may be input to the dynamical system in various formats:
%
% *Format 1: As a struct array*
%
fext.epsilon = epsilon
fext.data    = data
%%
% where $\texttt{data}$ is a struct array with entries
%
data(i).kappa = kappa_i
data(i).coeffs = f_kappa_i
%%
% In this case it is passed to the DS object as 
%
DS.<a href="../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(fext)
%%
% *Format 2: With harmonics and coefficients*
%
% If only a single harmonic is used for a periodic excitation, the harmonics $\kappa_i$ and the coefficients $\mathbf{f}_{\kappa_i}$
% can be input manually as
%
coeffs = [f_kappa_1, f_kappa_2]
Kappas = [kappa_1, kappa_2]



%%
% The second order form is converted into the first order form with
%
% $$ \mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],
% \quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} & \mathbf{0}\\\mathbf{0} & \mathbf{M}\end{array}\right],
% \mathbf{B}=\left[\begin{array}{cc}\mathbf{C} & \mathbf{M}\\\mathbf{M} & \mathbf{0}\end{array}\right],
% \quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}-\mathbf{f}_{\textrm{nl}}(\mathbf{x},\dot{\mathbf{x}})\\\mathbf{0}\end{array}\right],
% \quad\mathbf{F}_\textrm{ext}(\mathbf{z},\mathbf{\Omega} t) =\left[\begin{array}{c}\mathbf{f}_{\textrm{ext}}(\mathbf{\Omega} t)\\ \mathbf{0}  \end{array}\right] $$



%%% Setting up a First Order Dynamical System
%
% In this section we explain how the $\texttt{DynamicalSystem}$ class constructs a dynamical
% system object in first order form which is given as:
%
% $\mathbf{B} \dot{\mathbf{z}} = \mathbf{A}(\mathbf{z}) + \mathbf{F}(\mathbf{z}) +  \epsilon \mathbf{F}_{\textrm{ext}}(\mathbf{\Omega} t)$
% The linear system matrices can be set via the set method of the class as

set(DS,'A',A,'B',B);

%%
% $\mathbf{F(z)}$ is a nonlinear polynomial function of degree two or higher an can also be set with the set method as.
%

set(DS,'F',F);

%%
% This nonlinear force may be prepared in one of the following ways:
%
% *Using tensor format:*
%
% In tensor notation the first order nonlinear internal forces are expanded
% as 
%
% $$ \mathbf{F(z)} = \sum_{i>2} \mathbf{F}_i \mathbf{z}^{\otimes i} $$
%
% The order i nonlinearity is thus represented by a $1+i$ dimensional
% tensor $\mathbf{F}_ \in \bf{C}^{N\times N^i}$. For implementation it is represented by a multidimensional array
% of dimension $1+i$. These arrays are stored in a cell array. So in this case one might obtain the order i nonlinearity as
Fi = F{i}
%%
% *Using multi-index format:*
% In multi-index notation the first order nonlinear internal forces are expanded
% as 
%
% $$ \mathbf{F(z)} = \sum_{\mathbf{m} \in \bf{N}^N} \mathbf{F}_\mathbf{m} \mathbf{z}^{\mathbf{m}} $$
% 
% The variate monomials in this expansion are written as $\mathbf{z^m} =
% {z_1}^{m_1}\cdot {z_2}^{m_2} \cdots {z_N}^{m_N}$. The nonlinearity in this case
% is stored in a struct array with fields that characterise its
% coefficients and the corresponding multi-indices. 
% Thus the relevant quantities are stored
%
Fm = F(m_abs).coeffs
m  = F(m_abs).ind
%%
% This extracts all coefficients of the Taylor expansion and the
% corresponding order $\texttt{m\_abs}$ multi-indices m. So $\texttt{Fm}$
% is a ${N\times n_m}$ and $\texttt{m}$ is a ${N\times n_m}$ dimensional
% array, where $n_m$ denotes the number of unique multi-indices at order
% $\texttt{m\_abs}$.
%%
% *First order external excitation*
%
% The external force is provided as a Fourier Expansion in terms of the relevant harmonics.
%
% $$ \mathbf{F}_{\textrm{ext}}(\mathbf{\Omega} t) = \sum_{i} \mathbf{F}_{\mathbf{\kappa}_i} \textrm{e}^{i \mathbf{\kappa}_i \cdot \mathbf{\Omega}t} $$
%
% Furthermore the forcing frequency is given by a frequency vector. This force may be input to the dynamical system in various formats:
%
% *Format 1: As a struct array*
%
Fext.epsilon = epsilon
Fext.data    = data
%%
% where $\texttt{data}$ is a struct array with entries
%
data(i).kappa = kappa_i
data(i).coeffs = F_kappa_i
%%
% In this case it is passed to the DS object as 
%
DS.<a href="../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(Fext)
%%
% *Format 2: With harmonics and coefficients*
%
% If only a single harmonic is used for a periodic excitation, the harmonics $\kappa_i$ and the coefficients $\mathbf{F}_{\kappa_i}$
% can be input manually as
%
coeffs = [F_kappa_1, F_kappa_2]
Kappas = [kappa_1, kappa_2]
%%
% In general, the nonlinear and external forces are stored as follows:
%
% <<StoreForces.png>>
%

%%% Specifications
%
% Several options can be passed to the dynamical system class, to further specify characteristics of the underlying system, as well as how it is supposed to be handled 
% computationally. In the following they are presented with their default values. If a system with non default parameters is treated, these have to be adapted.
%

set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'Nmax',6);               % Maximal sytem size for which the full spectrum is computed
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'Emax',10);              % Maximal number of Eigenvalues and -vectors that are computed if system size is larger than Nmax
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'notation','multiindex');% Notation in which nonlinear forces are to be handled, can be 'multiindex' or 'tensor'
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'RayleighDamping',true); % Whether the underlying damping model is of Rayleigh Type
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'BaseExcitation',false); % Whether the external force arises due to an excitation of the base which leads to a frequency dependent forcing amplitude.
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'DStype','real');        % To determine whether dynamical system possesses any complex valued quantities.
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'outDOF',[]);            % For which DOF of the full system the relevant quantities should be explicitly displayed and stored.
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'HarmonicForce',true);   % To determine whether time dependence of the external forcing is harmonic or not
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'lambdaThreshold',1e16); % Threshold beyond which stiff eigenmodes will be removed
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'sigma',0);              % value around which eigenvalues are computed. Is set to zero by default which corresponds to the 'smallestabs' setting in the built in eigs function.
set(DS.<a href="../Library/Features/Options/Options.html">Options</a>,'RemoveZeros',true);     % Remove eigenvalues with zero real part from the spectrum. Relevant for the computation of center manifolds and in parameter dependent SSMs.


%%% Methods
%
% The first and crucial method which is provided for the DS class is the $\texttt{linear\_spectral\_analysis}$ method, which solves specified bits of the eigenvalue problem
% for the linear truncation of the dynamical system that is input. It is invoked via
%

[V,D,W] = DS.<a href="../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();

%%
% When run, it outputs the three arguments the left and right eigenvectors and the eigenvalues of the eigenproblems
%
% $$ \mathbf{w}_i^* ( \lambda_i^2 \mathbf{M} + \lambda_i \mathbf{C} + \mathbf{K}) = \mathbf{0} $$
%
% $$ (\lambda_i^2\mathbf{M} + \lambda_i\mathbf{C} + \mathbf{K}) \mathbf{v}_i  = \mathbf{0} $$
%
% or
%
% $$ \mathbf{w}_i^* (\mathbf{A} - \lambda_i\mathbf{B}) = \mathbf{0} $$
%
% $$ (\mathbf{A} - \lambda_i\mathbf{B}) \mathbf{v}_i  = \mathbf{0} $$
%
% Furthermore it sets up an internal data structure with fields that contain the essential information about the truncated spectrum
% of the dynamical system which are used for invariant manifold computations.

%%
% For the evaluation of the nonlinear internal and the external forces the following functions are provided.

fnl = DS.<a href="../Library/DynamicalSystem/compute_fnl.html">compute_fnl</a>(x,xd);
Fnl = DS.<a href="../Library/DynamicalSystem/evaluate_Fnl.html">evaluate_Fnl</a>(z);
fext = DS.<a href="../Library/DynamicalSystem/compute_fext.html">compute_fext</a>(t,x);
Fext = DS.<a href="../Library/DynamicalSystem/evaluate_Fext.html">evaluate_Fext</a>(t,z);

%%
% These are also used for the construction of the governing ODE $\dot{z} = f(z,t)$ which is evaluated via

f = DS.<a href="../Library/DynamicalSystem/odefun.html">odefun</a>(t,z);

%%
% Further functionalities which are provided for this class include the evaluation of the Jacobians of the nonlinear internal forces via

dfnl = DS.<a href="../Library/DynamicalSystem/compute_dfnldx.html">compute_dfnldx</a>(x,xd);
dfnl = DS.<a href="../Library/DynamicalSystem/compute_dfnldxd.html">compute_dfnldxd</a>(x,xd);

%%
% and the residual that may be used for the integration of ODEs,

[ r, drdqdd,drdqd,drdq, c0] = DS.<a href="../Library/DynamicalSystem/residual.html">residual</a>(q, qd, qdd, t);
            ##### SOURCE END #####
        --></body></html></body></html>