
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><html><body><div class="banner"><a href="../../../../index.html"><img alt="Logo" class="logo" src="../../../../logo.png" style="float:right" width="200"/></a></div></body></html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Stability and forced response of a nonlinear Mathieu equation</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-02" name="DC.date"/><meta content="Nonlinear_Mathieu_Equation.m" name="DC.source"/><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Stability and forced response of a nonlinear Mathieu equation</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Build Model</a></li><li><a href="#4">Dynamical system setup</a></li><li><a href="#5">Add forcing</a></li><li><a href="#6">Linear Modal Analysis</a></li><li><a href="#7">Forced response curves using SSMs</a></li><li><a href="#11">Get results from full system</a></li><li><a href="#12">Stability Diagram from Reduced Dynamics</a></li></ul></div><p>We consider the following mathieu equation with time varying stiffness coefficients.</p><p><img alt="$$m \ddot{x} + c \dot{x} + \omega_0^2 ( 1 + \cos(\Omega t)) x + \gamma  (
1 +  \lambda \cos(\Omega t)) x^3  = 0  $$" src="Nonlinear_Mathieu_Equation_eq03176630024017994158-Rescaled.png" style="width: 613.1999999999999px; height: auto;"/></p><pre class="codeinput">clear <span class="string">all</span>, clc
</pre><h2 id="2">Build Model</h2><p><b>Parameters</b></p><pre class="codeinput">c = 0.1;  <span class="comment">% Damping</span>
w0 = 1; <span class="comment">% Natural Frequency</span>
lam3 = -0.1;
gam3 = -0.1;
eps  = 0.2;
dampnl = 0;
[M,C,K,g,fnl] = build_model(w0^2,c,lam3,gam3, dampnl);
</pre><h2 id="4">Dynamical system setup</h2><p>We consider the parametrically excited system</p><p><img alt="$$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{g}(\mathbf{x},\dot{\mathbf{x}},\Omega
t),$$" src="Nonlinear_Mathieu_Equation_eq06713943434195845010-Rescaled.png" style="width: 466.79999999999995px; height: auto;"/></p><p>which can be written in the first-order form as</p><p><img alt="$$\mathbf{B}\dot{\mathbf{z}}=\mathbf{Az}+\mathbf{F}(\mathbf{z})+\epsilon\mathbf{G}(\mathbf{z},\phi)$$" src="Nonlinear_Mathieu_Equation_eq16155271348029362642-Rescaled.png" style="width: 318.0px; height: auto;"/></p><p><img alt="$$\dot{\mathbf{\phi}}=\mathbf{\Omega}$$" src="Nonlinear_Mathieu_Equation_eq16619053923308180078-Rescaled.png" style="width: 70.8px; height: auto;"/></p><p>where</p><p><img alt="$$\mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K}
&amp; \mathbf{0}\\\mathbf{0} &amp; \mathbf{M}\end{array}\right],\mathbf{B}=\left[\begin{array}{cc}\mathbf{C}
&amp; \mathbf{M}\\\mathbf{M} &amp; \mathbf{0}\end{array}\right],\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}\mathbf{-\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})}\\\mathbf{0}\end{array}\right],\quad\mathbf{G}(\mathbf{z},\mathbf{\phi})=\left[\begin{array}{c}\mathbf{g}(\mathbf{x,
\dot{x}},\phi)\\\mathbf{0}\end{array}\right]$$" src="Nonlinear_Mathieu_Equation_eq12577653640226493624-Rescaled.png" style="width: 1212.0px; height: auto;"/></p><pre class="codeinput">DS = <a href="../../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,<span class="string">'M'</span>,M,<span class="string">'C'</span>,C,<span class="string">'K'</span>,K,<span class="string">'fnl'</span>,fnl);
set(DS.<a href="../../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
</pre><h2 id="5">Add forcing</h2><pre class="codeinput">DS.<a href="../../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(g,0.3);
</pre><h2 id="6">Linear Modal Analysis</h2><pre class="codeinput"><span class="comment">% Analyse spectrum</span>
[V,D,W_evec] = DS.<a href="../../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();

<span class="comment">% Choose Master subspace (perform resonance analysis)</span>

<span class="comment">% Set up SSM object</span>
S = <a href="../../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 0.5,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)

<span class="comment">%Choose Master subspace</span>
resModes = [1,2];
S.<a href="../../../../Library/Manifold/choose_E.html">choose_E</a>(resModes);
</pre><pre class="codeoutput">
 The first 2 nonzero eigenvalues are given as 
  -0.0500 + 0.9987i
  -0.0500 - 0.9987i

sigma_out = 0
sigma_in = 1
</pre><h2 id="7">Forced response curves using SSMs</h2><p>Obtaining <b>forced response curve</b> in reduced-polar coordinate</p><pre class="codeinput">order = 5; <span class="comment">% Approximation order</span>
</pre><p>setup options</p><pre class="codeinput">outdof = 1;
set(S.<a href="../../../../Library/Features/Options/Options.html">Options</a>,    <span class="string">'reltol'</span>, 0.5,<span class="string">'IRtol'</span>,0.02,<span class="string">'notation'</span>, <span class="string">'multiindex'</span>,<span class="string">'contribNonAuto'</span>,true)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'nt'</span>, 2^7)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'outdof'</span>,outdof, <span class="string">'coordinates'</span>,<span class="string">'cartesian'</span>)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>, <span class="string">'branchSwitch'</span>,true,<span class="string">'periodsRatio'</span>,2) <span class="comment">%continue BPs of primary branch, 2T response</span>
set(S.contOptions,<span class="string">'PtMX'</span>,40,<span class="string">'h_min'</span>,1e-4,<span class="string">'bi_direct'</span>,false)
</pre><p>choose frequency range around the master mode frequency</p><pre class="codeinput">omega0 = imag(S.E.spectrum(1));
OmegaRange =[1.6,2.6]*omega0  <span class="comment">% Subharmonic resonance at Omega = 2 omega_0</span>

epSamp = [0.2,0.21,0.22];
</pre><pre class="codeoutput">
OmegaRange =

    1.5980    2.5967

</pre><p>Extract forced response curve</p><pre class="codeinput">startFRCSSM = tic;

Sweep = S.<a href="../../../../Library/SSM/SSM_poSweeps.html">SSM_poSweeps</a>(<span class="string">'SSMsweep'</span>,resModes,order,epSamp,OmegaRange);
timings.FRCSSM = toc(startFRCSSM);
figFRC = gcf;
</pre><h2>Excitation amplitude: epsilon = 0.2</h2><pre class="codeoutput">sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 7.00E-03 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 7.78E-03 MB
Manifold computation time at order 4 = 00:00:00
Estimated memory usage at order  4 = 9.00E-03 MB
Manifold computation time at order 5 = 00:00:00
Estimated memory usage at order  5 = 1.05E-02 MB

 Run='SSMsweep0.2.po': Continue primary family of periodic orbits.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  1.14e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   1.1350e+01      1  EP      1.5980e+00   7.8638e+00   0.0000e+00   0.0000e+00
   10  00:00:06   7.9847e+00      2          2.4780e+00   5.0713e+00   0.0000e+00   0.0000e+00
   11  00:00:06   7.7694e+00      3  EP      2.5967e+00   4.8393e+00   0.0000e+00   0.0000e+00

  </pre><h2>Excitation amplitude: epsilon = 0.21</h2><pre class="codeoutput">
sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 7.00E-03 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 7.78E-03 MB
Manifold computation time at order 4 = 00:00:00
Estimated memory usage at order  4 = 9.00E-03 MB
Manifold computation time at order 5 = 00:00:00
Estimated memory usage at order  5 = 1.05E-02 MB

 Run='SSMsweep0.21.po': Continue primary family of periodic orbits.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  1.14e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   1.1350e+01      1  EP      1.5980e+00   7.8638e+00   0.0000e+00   0.0000e+00
    6  00:00:07   9.4635e+00      2  SN      1.9651e+00   6.3949e+00   0.0000e+00   0.0000e+00
    6  00:00:07   9.4635e+00      3  BP      1.9651e+00   6.3949e+00   0.0000e+00   0.0000e+00
    7  00:00:12   9.2158e+00      4  SN      2.0299e+00   6.1905e+00   0.0000e+00   0.0000e+00
    7  00:00:12   9.2158e+00      5  BP      2.0299e+00   6.1905e+00   0.0000e+00   0.0000e+00
   10  00:00:13   7.9850e+00      6          2.4780e+00   5.0713e+00   0.0000e+00   0.0000e+00
   11  00:00:14   7.7696e+00      7  EP      2.5967e+00   4.8393e+00   0.0000e+00   0.0000e+00

 Run='SSMsweep0.21.po_BP_1': Continue secondary branch of periodic orbits in 'SSMsweep0.21.po' .

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   9.4635e+00      1  EP      1.9651e+00   6.3949e+00   0.0000e+00   0.0000e+00
    1  00:00:01   9.4635e+00      2  BP      1.9651e+00   6.3949e+00   1.8471e-08   1.7528e-08
    1  00:00:01   9.4636e+00      3  FP      1.9651e+00   6.3947e+00   1.6441e-02   1.5601e-02
   10  00:00:02   1.0512e+01      4          1.9167e+00   6.5563e+00   8.8365e-01   8.3387e-01
   20  00:00:04   1.2914e+01      5          1.7847e+00   7.0410e+00   1.6950e+00   1.5757e+00
   25  00:00:06   1.2969e+01      6  FP      1.7828e+00   7.0485e+00   1.7117e+00   1.5916e+00
   25  00:00:06   1.2969e+01      7  SN      1.7828e+00   7.0485e+00   1.7117e+00   1.5916e+00
   30  00:00:07   1.2973e+01      8          1.7844e+00   7.0425e+00   1.7149e+00   1.5950e+00
   40  00:00:09   1.2859e+01      9  EP      1.7959e+00   6.9973e+00   1.6872e+00   1.5723e+00

 Run='SSMsweep0.21.po_BP_2': Continue secondary branch of periodic orbits in 'SSMsweep0.21.po' .

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   9.2158e+00      1  EP      2.0299e+00   6.1905e+00   0.0000e+00   0.0000e+00
    1  00:00:01   9.2158e+00      2  BP      2.0299e+00   6.1905e+00   1.8173e-08   1.7549e-08
    1  00:00:01   9.2158e+00      3  FP      2.0299e+00   6.1905e+00   4.5028e-03   4.3480e-03
   10  00:00:02   1.0305e+01      4          1.9715e+00   6.3740e+00   8.7169e-01   8.3403e-01
   20  00:00:04   1.2869e+01      5          1.7950e+00   7.0008e+00   1.6899e+00   1.5745e+00
   30  00:00:06   1.2976e+01      6          1.7834e+00   7.0465e+00   1.7151e+00   1.5948e+00
   34  00:00:08   1.2969e+01      7  SN      1.7828e+00   7.0485e+00   1.7117e+00   1.5916e+00
   34  00:00:08   1.2969e+01      8  FP      1.7828e+00   7.0485e+00   1.7117e+00   1.5916e+00
   40  00:00:09   1.2900e+01      9  EP      1.7854e+00   7.0384e+00   1.6908e+00   1.5719e+00
  </pre><h2>Excitation amplitude: epsilon = 0.22</h2><pre class="codeoutput">
sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 7.00E-03 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 7.78E-03 MB
Manifold computation time at order 4 = 00:00:00
Estimated memory usage at order  4 = 9.00E-03 MB
Manifold computation time at order 5 = 00:00:00
Estimated memory usage at order  5 = 1.05E-02 MB

 Run='SSMsweep0.22.po': Continue primary family of periodic orbits.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  1.14e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   1.1351e+01      1  EP      1.5980e+00   7.8638e+00   0.0000e+00   0.0000e+00
    6  00:00:06   9.5188e+00      2  SN      1.9513e+00   6.4399e+00   0.0000e+00   0.0000e+00
    6  00:00:06   9.5188e+00      3  BP      1.9513e+00   6.4399e+00   0.0000e+00   0.0000e+00
    7  00:00:11   9.1663e+00      4  SN      2.0437e+00   6.1490e+00   0.0000e+00   0.0000e+00
    7  00:00:11   9.1663e+00      5  BP      2.0437e+00   6.1490e+00   0.0000e+00   0.0000e+00
   10  00:00:13   7.9853e+00      6          2.4780e+00   5.0713e+00   0.0000e+00   0.0000e+00
   11  00:00:13   7.7699e+00      7  EP      2.5967e+00   4.8393e+00   0.0000e+00   0.0000e+00

 Run='SSMsweep0.22.po_BP_1': Continue secondary branch of periodic orbits in 'SSMsweep0.22.po' .

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   9.5188e+00      1  EP      1.9513e+00   6.4399e+00   0.0000e+00   0.0000e+00
    1  00:00:00   9.5188e+00      2  BP      1.9513e+00   6.4399e+00   1.8564e-08   1.7525e-08
    1  00:00:00   9.5188e+00      3  FP      1.9513e+00   6.4398e+00   4.5560e-03   4.3011e-03
   10  00:00:02   1.0571e+01      4          1.9019e+00   6.6072e+00   8.8838e-01   8.3387e-01
   20  00:00:04   1.4005e+01      5          1.6915e+00   7.4293e+00   1.9679e+00   1.8037e+00
   24  00:00:05   1.5289e+01      6  EP      1.5980e+00   7.8638e+00   2.2825e+00   2.0720e+00

 Run='SSMsweep0.22.po_BP_2': Continue secondary branch of periodic orbits in 'SSMsweep0.22.po' .

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period         amp1        Znorm
    0  00:00:00   9.1663e+00      1  EP      2.0437e+00   6.1490e+00   0.0000e+00   0.0000e+00
    1  00:00:00   9.1663e+00      2  BP      2.0437e+00   6.1490e+00   1.8140e-08   1.7562e-08
    1  00:00:00   9.1663e+00      3  FP      2.0437e+00   6.1490e+00   4.4788e-03   4.3362e-03
   10  00:00:02   1.0253e+01      4          1.9862e+00   6.3268e+00   8.7005e-01   8.3476e-01
   20  00:00:04   1.3765e+01      5          1.7433e+00   7.2086e+00   1.9405e+00   1.7972e+00
   26  00:00:05   1.5464e+01      6  EP      1.5980e+00   7.8638e+00   2.3386e+00   2.1261e+00
</pre><img alt="" src="Nonlinear_Mathieu_Equation_01.png" style="width:35%;"/> <img alt="" src="Nonlinear_Mathieu_Equation_02.png" style="width:35%;"/> <h2 id="11">Get results from full system</h2><pre class="codeinput">nCycles = 10;

coco = <a href="../../../../Library/Features/Wrappers/cocoWrapper/cocoWrapper.html">cocoWrapper</a>(DS, nCycles, outdof);
set(coco,<span class="string">'initialGuess'</span>,<span class="string">'forward'</span>)
set(coco,<span class="string">'branchSwitch'</span>,<span class="string">'true'</span>,<span class="string">'periodsRatio'</span>,2) <span class="comment">% include new branches, 2T periodic response</span>
set(coco.<a href="../../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'NAdapt'</span>, 1);
set(coco.<a href="../../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'ItMX'</span>,15,<span class="string">'NTST'</span>, 30,<span class="string">'PtMX'</span>,60,<span class="string">'bi_direct'</span>,false); <span class="comment">%for convergence, smaller stepsize</span>

figure(figFRC)
hold <span class="string">on</span>
startcoco = tic;
Sweep_coco = coco.<a href="../../../../Library/Features/Wrappers/cocoWrapper/coco_poSweeps.html">coco_poSweeps</a>(epSamp,OmegaRange);
timings.cocoFRC = toc(startcoco);
</pre><h2>Excitation amplitude: epsilon = 0.22</h2><pre class="codeoutput">
 Run='FRC0.2': Continue primary family of periodic orbits.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  1.14e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   1.1350e+01      1  EP      1.5980e+00   7.8638e+00   2.0000e-01   0.0000e+00
   10  00:00:01   7.9847e+00      2          2.4780e+00   5.0713e+00   2.0000e-01   0.0000e+00
   11  00:00:02   7.7694e+00      3  EP      2.5967e+00   4.8393e+00   2.0000e-01   0.0000e+00
  </pre><h2>Excitation amplitude: epsilon = 0.21</h2><pre class="codeoutput">
 Run='FRC0.21': Continue primary family of periodic orbits.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  1.14e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   1.1350e+01      1  EP      1.5980e+00   7.8638e+00   2.1000e-01   0.0000e+00
    6  00:00:01   9.4673e+00      2  SN      1.9641e+00   6.3980e+00   2.1000e-01   0.0000e+00
    6  00:00:01   9.4673e+00      3  BP      1.9641e+00   6.3980e+00   2.1000e-01   0.0000e+00
    7  00:00:02   9.2222e+00      4  SN      2.0282e+00   6.1959e+00   2.1000e-01   0.0000e+00
    7  00:00:02   9.2222e+00      5  BP      2.0282e+00   6.1959e+00   2.1000e-01   0.0000e+00
   10  00:00:03   7.9850e+00      6          2.4780e+00   5.0713e+00   2.1000e-01   0.0000e+00
   11  00:00:03   7.7696e+00      7  EP      2.5967e+00   4.8393e+00   2.1000e-01   0.0000e+00

 Run='FRC0.21.1': Continue equilibria along secondary branch.

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   9.4673e+00      1  EP      1.9641e+00   6.3980e+00   2.1000e-01   0.0000e+00
    1  00:00:00   9.4673e+00      2  BP      1.9641e+00   6.3980e+00   2.1000e-01   7.1349e-09
    1  00:00:00   9.4676e+00      3  FP      1.9641e+00   6.3980e+00   2.1000e-01   6.3523e-03
   10  00:00:01   1.0252e+01      4          1.9546e+00   6.4292e+00   2.1000e-01   3.7686e-01
   20  00:00:02   1.2891e+01      5          1.9080e+00   6.5862e+00   2.1000e-01   9.0953e-01
   30  00:00:03   1.6747e+01      6          1.8183e+00   6.9112e+00   2.1000e-01   1.4593e+00
   38  00:00:04   1.7480e+01      7  SN      1.8013e+00   6.9761e+00   2.1000e-01   1.5612e+00
   38  00:00:04   1.7480e+01      8  FP      1.8013e+00   6.9761e+00   2.1000e-01   1.5612e+00
   40  00:00:04   1.7504e+01      9          1.8017e+00   6.9745e+00   2.1000e-01   1.5645e+00
   50  00:00:05   1.7415e+01     10          1.8089e+00   6.9468e+00   2.1000e-01   1.5532e+00
   60  00:00:06   1.6534e+01     11  EP      1.8463e+00   6.8062e+00   2.1000e-01   1.4363e+00

 Run='FRC0.21.2': Continue equilibria along secondary branch.

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   9.2222e+00      1  EP      2.0282e+00   6.1959e+00   2.1000e-01   0.0000e+00
    1  00:00:00   9.2222e+00      2  BP      2.0282e+00   6.1959e+00   2.1000e-01   4.3747e-09
    1  00:00:00   9.2222e+00      3  FP      2.0282e+00   6.1959e+00   2.1000e-01   1.8811e-03
   10  00:00:01   1.0030e+01      4          2.0166e+00   6.2313e+00   2.1000e-01   3.7389e-01
   20  00:00:02   1.2742e+01      5          1.9593e+00   6.4136e+00   2.1000e-01   9.0438e-01
   30  00:00:03   1.6705e+01      6          1.8399e+00   6.8299e+00   2.1000e-01   1.4579e+00
   40  00:00:04   1.8447e+01      7          1.8038e+00   6.9667e+00   2.1000e-01   1.5639e+00
   48  00:00:05   1.8429e+01      8  FP      1.8013e+00   6.9761e+00   2.1000e-01   1.5612e+00
   48  00:00:05   1.8429e+01      9  SN      1.8013e+00   6.9761e+00   2.1000e-01   1.5612e+00
   50  00:00:05   1.8387e+01     10          1.8016e+00   6.9750e+00   2.1000e-01   1.5558e+00
   60  00:00:06   1.7484e+01     11  EP      1.8214e+00   6.8993e+00   2.1000e-01   1.4437e+00
  </pre><h2>Excitation amplitude: epsilon = 0.22</h2><pre class="codeoutput">
 Run='FRC0.22': Continue primary family of periodic orbits.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  1.14e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   1.1351e+01      1  EP      1.5980e+00   7.8638e+00   2.2000e-01   0.0000e+00
    6  00:00:01   9.5235e+00      2  SN      1.9502e+00   6.4437e+00   2.2000e-01   0.0000e+00
    6  00:00:01   9.5235e+00      3  BP      1.9502e+00   6.4437e+00   2.2000e-01   0.0000e+00
    7  00:00:02   9.1729e+00      4  SN      2.0418e+00   6.1545e+00   2.2000e-01   0.0000e+00
    7  00:00:02   9.1729e+00      5  BP      2.0418e+00   6.1545e+00   2.2000e-01   0.0000e+00
   10  00:00:03   7.9853e+00      6          2.4780e+00   5.0713e+00   2.2000e-01   0.0000e+00
   11  00:00:03   7.7699e+00      7  EP      2.5967e+00   4.8393e+00   2.2000e-01   0.0000e+00

 Run='FRC0.22.1': Continue equilibria along secondary branch.

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   9.5235e+00      1  EP      1.9502e+00   6.4437e+00   2.2000e-01   0.0000e+00
    1  00:00:00   9.5235e+00      2  BP      1.9502e+00   6.4437e+00   2.2000e-01   7.1466e-09
    1  00:00:00   9.5235e+00      3  FP      1.9502e+00   6.4437e+00   2.2000e-01   1.7707e-03
   10  00:00:01   1.0305e+01      4          1.9405e+00   6.4759e+00   2.2000e-01   3.7741e-01
   20  00:00:02   1.2942e+01      5          1.8928e+00   6.6391e+00   2.2000e-01   9.1063e-01
   30  00:00:03   1.6866e+01      6          1.7958e+00   6.9976e+00   2.2000e-01   1.4714e+00
   40  00:00:04   2.3489e+01      7          1.6553e+00   7.5918e+00   2.2000e-01   1.9909e+00
   50  00:00:05   2.4527e+01      8  SN      1.6200e+00   7.7572e+00   2.2000e-01   2.1110e+00
   50  00:00:05   2.4527e+01      9  FP      1.6200e+00   7.7572e+00   2.2000e-01   2.1110e+00
   50  00:00:05   2.4538e+01     10          1.6201e+00   7.7565e+00   2.2000e-01   2.1124e+00
   60  00:00:06   2.4205e+01     11  EP      1.6426e+00   7.6503e+00   2.2000e-01   2.0761e+00

 Run='FRC0.22.2': Continue equilibria along secondary branch.

 STEP      TIME        ||U||  LABEL  TYPE         omega    po.period          eps         amp1
    0  00:00:00   9.1729e+00      1  EP      2.0418e+00   6.1545e+00   2.2000e-01   0.0000e+00
    1  00:00:00   9.1729e+00      2  BP      2.0418e+00   6.1545e+00   2.2000e-01   7.0645e-09
    1  00:00:00   9.1729e+00      3  FP      2.0418e+00   6.1545e+00   2.2000e-01   1.8192e-03
   10  00:00:01   9.9824e+00      4          2.0305e+00   6.1889e+00   2.2000e-01   3.7314e-01
   20  00:00:02   1.2691e+01      5          1.9745e+00   6.3642e+00   2.2000e-01   9.0120e-01
   30  00:00:03   1.6697e+01      6          1.8594e+00   6.7585e+00   2.2000e-01   1.4594e+00
   40  00:00:04   2.3010e+01      7          1.6832e+00   7.4659e+00   2.2000e-01   1.9863e+00
   50  00:00:05   2.4133e+01      8          1.6232e+00   7.7415e+00   2.2000e-01   2.1105e+00
   55  00:00:06   2.4142e+01      9  SN      1.6200e+00   7.7572e+00   2.2000e-01   2.1100e+00
   55  00:00:06   2.4142e+01     10  FP      1.6200e+00   7.7572e+00   2.2000e-01   2.1100e+00
   60  00:00:06   2.3902e+01     11  EP      1.6267e+00   7.7251e+00   2.2000e-01   2.0827e+00
</pre><img alt="" src="Nonlinear_Mathieu_Equation_03.png" style="width:35%;"/> <h2 id="12">Stability Diagram from Reduced Dynamics</h2><pre class="codeinput">set(S.contOptions,<span class="string">'PtMX'</span>,50,<span class="string">'bi_direct'</span>,true)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>,<span class="string">'branchSwitch'</span>,true)
PlotSD = true;

p0 = [2*omega0,0]; <span class="comment">% Initial condition</span>
epRange = [0,1];
figure();
startSDSSM = tic;
SD = S.<a href="../../../../Library/Features/Wrappers/cocoWrapper/extract_Stability_Diagram.html">extract_Stability_Diagram</a>(resModes, order, OmegaRange,epRange,<span class="string">'amp'</span>, p0,<span class="string">'PD'</span>,PlotSD);
timings.SDSSM = toc(startSDSSM);
figSD = gcf;
</pre><pre class="codeoutput">sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 7.00E-03 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 7.78E-03 MB
Manifold computation time at order 4 = 00:00:00
Estimated memory usage at order  4 = 9.00E-03 MB
Manifold computation time at order 5 = 00:00:00
Estimated memory usage at order  5 = 1.05E-02 MB

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          0.00e+00  4.88e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE           eps    po.period
    0  00:00:00   4.8763e+00      1  EP      0.0000e+00   3.1455e+00
    2  00:00:00   4.8845e+00      2  PD      1.9975e-01   3.1455e+00
    5  00:00:00   5.0773e+00      3  EP      1.0000e+00   3.1455e+00

 Run='ROM_family_bif1': Continue bifurcations from point 2 in run 'ROM_detect_bif'.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          3.74e-08  8.82e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period          eps
    0  00:00:00   8.8232e+00      1  EP      1.9975e+00   3.1455e+00   1.9975e-01
   10  00:00:03   8.9967e+00      2          1.8132e+00   3.4652e+00   4.1878e-01
   19  00:00:05   9.3477e+00      3  EP      1.5980e+00   3.9319e+00   8.2262e-01

 STEP      TIME        ||U||  LABEL  TYPE            om    po.period          eps
    0  00:00:06   8.8232e+00      4  EP      1.9975e+00   3.1455e+00   1.9975e-01
   10  00:00:08   8.7426e+00      5          2.1892e+00   2.8700e+00   4.3195e-01
   20  00:00:11   8.7852e+00      6          2.4939e+00   2.5194e+00   1.0115e+00
   24  00:00:12   8.7868e+00      7  MX      2.4975e+00   2.5158e+00   1.0185e+00
Total time spent on Stability Diagram computation = 00:00:14
</pre><img alt="" src="Nonlinear_Mathieu_Equation_04.png" style="width:35%;"/> <pre class="codeinput">plotSDinSweep(figFRC,SD)
</pre><img alt="" src="Nonlinear_Mathieu_Equation_05.png" style="width:35%;"/> <p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB® R2023a</a><br/></p></div><!--
##### SOURCE BEGIN #####
%% Stability and forced response of a nonlinear Mathieu equation
%
%%
% We consider the following mathieu equation with time varying stiffness coefficients.
% 
% $$m \ddot{x} + c \dot{x} + \omega_0^2 ( 1 + \cos(\Omega t)) x + \gamma  ( 
% 1 +  \lambda \cos(\Omega t)) x^3  = 0  $$
% 
% 

clear all, clc
%% Build Model

%% 
% *Parameters*
c = 0.1;  % Damping
w0 = 1; % Natural Frequency
lam3 = -0.1;
gam3 = -0.1;
eps  = 0.2;
dampnl = 0;
[M,C,K,g,fnl] = build_model(w0^2,c,lam3,gam3, dampnl);
%% Dynamical system setup
% We consider the parametrically excited system
% 
% $$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{g}(\mathbf{x},\dot{\mathbf{x}},\Omega 
% t),$$
% 
% which can be written in the first-order form as 
% 
% $$\mathbf{B}\dot{\mathbf{z}}=\mathbf{Az}+\mathbf{F}(\mathbf{z})+\epsilon\mathbf{G}(\mathbf{z},\phi)$$
% 
% $$\dot{\mathbf{\phi}}=\mathbf{\Omega}$$
% 
% where
% 
% $$\mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} 
% & \mathbf{0}\\\mathbf{0} & \mathbf{M}\end{array}\right],\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} 
% & \mathbf{M}\\\mathbf{M} & \mathbf{0}\end{array}\right],\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}\mathbf{-\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})}\\\mathbf{0}\end{array}\right],\quad\mathbf{G}(\mathbf{z},\mathbf{\phi})=\left[\begin{array}{c}\mathbf{g}(\mathbf{x, 
% \dot{x}},\phi)\\\mathbf{0}\end{array}\right]$$

DS = <a href="../../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,'M',M,'C',C,'K',K,'fnl',fnl);
set(DS.<a href="../../../../Library/Features/Options/Options.html">Options</a>,'notation','multiindex')
%% Add forcing

DS.<a href="../../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(g,0.3);
%% Linear Modal Analysis 

% Analyse spectrum
[V,D,W_evec] = DS.<a href="../../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();

% Choose Master subspace (perform resonance analysis)

% Set up SSM object
S = <a href="../../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.5,'notation','multiindex')

%Choose Master subspace
resModes = [1,2];
S.<a href="../../../../Library/Manifold/choose_E.html">choose_E</a>(resModes);
%% Forced response curves using SSMs
% Obtaining *forced response curve* in reduced-polar coordinate

order = 5; % Approximation order
%% 
% setup options

outdof = 1;
set(S.<a href="../../../../Library/Features/Options/Options.html">Options</a>,    'reltol', 0.5,'IRtol',0.02,'notation', 'multiindex','contribNonAuto',true)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>, 'nt', 2^7)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>, 'outdof',outdof, 'coordinates','cartesian')
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>, 'branchSwitch',true,'periodsRatio',2) %continue BPs of primary branch, 2T response
set(S.contOptions,'PtMX',40,'h_min',1e-4,'bi_direct',false)
%% 
% choose frequency range around the master mode frequency

omega0 = imag(S.E.spectrum(1));
OmegaRange =[1.6,2.6]*omega0  % Subharmonic resonance at Omega = 2 omega_0

epSamp = [0.2,0.21,0.22];

%% 
% Extract forced response curve

startFRCSSM = tic;

Sweep = S.<a href="../../../../Library/SSM/SSM_poSweeps.html">SSM_poSweeps</a>('SSMsweep',resModes,order,epSamp,OmegaRange);
timings.FRCSSM = toc(startFRCSSM);
figFRC = gcf;
%% Get results from full system

nCycles = 10;

coco = <a href="../../../../Library/Features/Wrappers/cocoWrapper/cocoWrapper.html">cocoWrapper</a>(DS, nCycles, outdof);
set(coco,'initialGuess','forward')
set(coco,'branchSwitch','true','periodsRatio',2) % include new branches, 2T periodic response
set(coco.<a href="../../../../Library/Features/Options/Options.html">Options</a>, 'NAdapt', 1);
set(coco.<a href="../../../../Library/Features/Options/Options.html">Options</a>,'ItMX',15,'NTST', 30,'PtMX',60,'bi_direct',false); %for convergence, smaller stepsize

figure(figFRC)
hold on
startcoco = tic;
Sweep_coco = coco.<a href="../../../../Library/Features/Wrappers/cocoWrapper/coco_poSweeps.html">coco_poSweeps</a>(epSamp,OmegaRange);
timings.cocoFRC = toc(startcoco);
%% Stability Diagram from Reduced Dynamics

set(S.contOptions,'PtMX',50,'bi_direct',true)
set(S.<a href="../../../../Library/Features/Options/Options.html">FRCOptions</a>,'branchSwitch',true)
PlotSD = true;

p0 = [2*omega0,0]; % Initial condition
epRange = [0,1];
figure();
startSDSSM = tic;
SD = S.<a href="../../../../Library/Features/Wrappers/cocoWrapper/extract_Stability_Diagram.html">extract_Stability_Diagram</a>(resModes, order, OmegaRange,epRange,'amp', p0,'PD',PlotSD);
timings.SDSSM = toc(startSDSSM);
figSD = gcf;

%%
plotSDinSweep(figFRC,SD)
##### SOURCE END #####
--></body></html>