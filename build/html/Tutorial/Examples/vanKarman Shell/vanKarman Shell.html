
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><html><body><div class="banner"><a href="../../../index.html"><img alt="Logo" class="logo" src="../../../logo.png" style="float:right" width="200"/></a></div><html><head><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Shallow-curved shell structure with geometric nonlinearities</title><meta content="MATLAB 9.10" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-07-11" name="DC.date"/><meta content="vonKarmanShellWorkbookDoc.m" name="DC.source"/><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Shallow-curved shell structure with geometric nonlinearities</h1><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Generate model</a></li><li><a href="#3">Dynamical system setup</a></li><li><a href="#5">Linear Modal analysis and SSM setup</a></li><li><a href="#7">Forced response curves using SSMs</a></li></ul></div><!--introduction--><h2>References</h2><p>Finite element model used in the following reference:</p><p>Jain, S., &amp; Tiso, P. (2018). Simulation-free hyper-reduction for geometrically nonlinear structural dynamics: a quadratic manifold lifting approach. <i>Journal of Computational and Nonlinear Dynamics</i>, <i>13</i>(7), 071003. <a href="https://doi.org/10.1115/1.4040021">https://doi.org/10.1115/1.4040021</a></p><p>Finite element code taken from the following package:</p><p>Jain, S., Marconi, J., Tiso P. (2020). YetAnotherFEcode (Version v1.1). Zenodo. <a href="http://doi.org/10.5281/zenodo.4011282">http://doi.org/10.5281/zenodo.4011282</a></p>
<img alt="" hspace="5" src="Model.png" style="width:35%" vspace="5"/>
<p><b>System parameters</b></p><pre class="codeinput">clear <span class="string">all</span>
nDiscretization = 10; <span class="comment">% Discretization parameter (#DOFs is proportional to the square of this number)</span>
epsilon = 0.1;
</pre><h2 id="2">generate model</h2><pre class="codeinput">[M,C,K,fnl,f_0,outdof] = build_model(nDiscretization);
n = length(M); <span class="comment">% number of degrees of freedom</span>
disp([<span class="string">'Number of degrees of freedom = '</span> num2str(n)])
disp([<span class="string">'Phase space dimensionality = '</span> num2str(2*n)])
</pre><pre class="codeoutput">Building FE model
Assembling M,C,K matrices
Applying boundary conditions
Solving undamped eigenvalue problem
Using Rayleigh damping
Assembling external force vector
Getting nonlinearity coefficients
Loaded tensors from storage
Total time spent on model assembly = 00:00:33
Number of degrees of freedom = 1320
Phase space dimensionality = 2640
</pre><img alt="" hspace="5" src="vonKarmanShellWorkbookDoc_01.png" style="width:45%" vspace="5"/> <img alt="" hspace="5" src="vonKarmanShellWorkbookDoc_02.png" style="width:45%" vspace="5"/> <h2 id="3">Dynamical system setup</h2><p>We consider the forced system</p><p><img alt="$$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{f}^{ext}(\mathbf{\Omega}t),$$" src="vonKarmanShellWorkbookDoc_eq16916562558011888297-Rescaled.png" style="width: 219.6px; height: auto;"/></p><p>which can be written in the first-order form as</p><p><img alt="$$\mathbf{B}\dot{\mathbf{z}}=\mathbf{Az}+\mathbf{F}(\mathbf{z})+\epsilon\mathbf{F}^{ext}(\mathbf{\phi t}),$$" src="vonKarmanShellWorkbookDoc_eq07596800650352557980-Rescaled.png" style="width: 168.0px; height: auto;"/></p><p><img alt="$$\dot{\mathbf{\phi}}=\mathbf{\Omega}$$" src="vonKarmanShellWorkbookDoc_eq10101966846358240785-Rescaled.png" style="width: 36.0px; height: auto;"/></p><p>where</p><p><img alt="$\mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} &amp; \mathbf{0}\\\mathbf{0} &amp; \mathbf{M}\end{array}\right],\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} &amp; \mathbf{M}\\\mathbf{M} &amp; \mathbf{0}\end{array}\right],\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}\mathbf{-\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})}\\\mathbf{0}\end{array}\right],\quad\mathbf{F}^{ext}(\mathbf{z},\mathbf{\phi})=\left[\begin{array}{c}\mathbf{f}^{ext}(\mathbf{\phi})\\\mathbf{0}\end{array}\right]$" src="vonKarmanShellWorkbookDoc_eq06277547758420750616-Rescaled.png" style="width: 602.4px; height: auto;"/>.</p><pre class="codeinput">DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,<span class="string">'M'</span>,M,<span class="string">'C'</span>,C,<span class="string">'K'</span>,K,<span class="string">'fnl'</span>,fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'Emax'</span>,5,<span class="string">'Nmax'</span>,10,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
</pre><p>We assume periodic forcing of the form</p><p><img alt="$$\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi}
+ \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$" src="vonKarmanShellWorkbookDoc_eq02167982012999347989-Rescaled.png" style="width: 201.6px; height: auto;"/></p><p>Fourier coefficients of Forcing</p><pre class="codeinput">kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
</pre><h2 id="5">Linear Modal analysis and SSM setup</h2><pre class="codeinput">[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
</pre><pre class="codeoutput">Due to high-dimensionality, we compute only the first 5 eigenvalues with the smallest magnitude. These would also be used to compute the spectral quotients
Assuming a proportional damping hypthesis with symmetric matrices
modal damping ratio for 1 mode is 2.000000e-03
modal damping ratio for 2 mode is 2.000000e-03
modal damping ratio for 3 mode is 2.269789e-03
modal damping ratio for 4 mode is 2.721500e-03
modal damping ratio for 5 mode is 2.909530e-03
the left eigenvectors may be incorrect in case of asymmetry of matrices

 The first 10 nonzero eigenvalues are given as 
   1.0e+02 *

  -0.0029 + 1.4745i
  -0.0029 - 1.4745i
  -0.0063 + 3.1598i
  -0.0063 - 3.1598i
  -0.0094 + 4.1319i
  -0.0094 - 4.1319i
  -0.0148 + 5.4515i
  -0.0148 - 5.4515i
  -0.0173 + 5.9601i
  -0.0173 - 5.9601i

</pre><p><b>Choose Master subspace (perform resonance analysis)</b></p><pre class="codeinput">S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 0.1,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
masterModes = [1,2];
S.<a href="../../../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
</pre><pre class="codeoutput">The master subspace contains the following eigenvalues
 
lambda1 == - 0.2949104 + 147.4549i
 
lambda2 == (-0.2949104) - 147.4549i
 
(near) outer resonance detected for the following combinations of master eigenvalues
 They are in resonance with the following eigenvalues of the slave subspace 
 
4*lambda1 + 0*lambda2 == - 1.734131 + 596.0149i
 
0*lambda1 + 4*lambda2 == (-1.734131) - 596.0149i
 
sigma_out = 5
(near) inner resonance detected for the following combination of master eigenvalues:
 
2*lambda1 + 1*lambda2 == lambda1
 
3*lambda1 + 2*lambda2 == lambda1
 
1*lambda1 + 2*lambda2 == lambda2
 
2*lambda1 + 3*lambda2 == lambda2
 
sigma_in = 5
</pre><h2 id="7">Forced response curves using SSMs</h2><p>Obtaining <b>forced response curve</b> in reduced-polar coordinate</p><pre class="codeinput">order = [3, 5, 7]; <span class="comment">% Approximation order</span>
</pre><p>setup options</p><pre class="codeinput">set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 1,<span class="string">'IRtol'</span>,0.02,<span class="string">'notation'</span>, <span class="string">'multiindex'</span>,<span class="string">'contribNonAuto'</span>,true)
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'nt'</span>, 2^7, <span class="string">'nRho'</span>, 200, <span class="string">'nPar'</span>, 200, <span class="string">'nPsi'</span>, 100, <span class="string">'rhoScale'</span>, 2 )
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">'continuation ep'</span>, <span class="string">'z0'</span>, 1e-4*[1; 1]) <span class="comment">% 'level set'</span>
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'outdof'</span>,outdof)
</pre><p>choose frequency range around the first natural frequency</p><pre class="codeinput">omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.95 1.05];
</pre><p>extract forced response curve</p><pre class="codeinput">FRC = S.<a href="../../../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>(<span class="string">'freq'</span>,omegaRange,order);
figFRC = gcf;
</pre> <h2> Compute FRC at order 3 </h2> <pre><pre class="codeoutput">  
*****************************************
Calculating FRC using SSM with master subspace: [1  2]
The master subspace contains the following eigenvalues
 
lambda1 == - 0.2949104 + 147.4549i
 
lambda2 == (-0.2949104) - 147.4549i
 
(near) outer resonance detected for the following combinations of master eigenvalues
 They are in resonance with the following eigenvalues of the slave subspace 
 
2*lambda1 + 0*lambda2 == - 0.631963 + 315.9809i
 
3*lambda1 + 0*lambda2 == - 0.631963 + 315.9809i
 
3*lambda1 + 1*lambda2 == - 0.631963 + 315.9809i

..

0*lambda1 + 5*lambda2 == (-1.734131) - 596.0149i
 
sigma_out = 5
(near) inner resonance detected for the following combination of master eigenvalues:
 
2*lambda1 + 1*lambda2 == lambda1
 
3*lambda1 + 2*lambda2 == lambda1
 
1*lambda1 + 2*lambda2 == lambda2
 
2*lambda1 + 3*lambda2 == lambda2
 
sigma_in = 5
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.18E+01 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 1.29E+01 MB

 Run='freqSubint1.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          7.69e-02  2.09e+02    0.0    0.0    0.0
   1   1  1.00e+00  1.39e-02  3.04e-04  2.09e+02    0.0    0.0    0.0
   2   1  1.00e+00  4.76e-04  1.09e-08  2.09e+02    0.0    0.0    0.0
   3   1  1.00e+00  4.10e-08  1.11e-16  2.09e+02    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   2.0860e+02      1  EP      1.4745e+02   3.9361e-02   3.7302e+00   1.0000e-01
   10  00:00:01   2.0679e+02      2          1.4615e+02   6.6414e-02   4.7211e+00   1.0000e-01
   14  00:00:01   2.0677e+02      3  SN      1.4612e+02   6.5759e-02   4.8660e+00   1.0000e-01
   14  00:00:01   2.0677e+02      4  FP      1.4612e+02   6.5759e-02   4.8660e+00   1.0000e-01
   20  00:00:01   2.0690e+02      5          1.4621e+02   6.0735e-02   5.1637e+00   1.0000e-01
   29  00:00:02   2.0742e+02      6  SN      1.4655e+02   3.4927e-02   5.7724e+00   1.0000e-01
   29  00:00:02   2.0742e+02      7  FP      1.4655e+02   3.4927e-02   5.7724e+00   1.0000e-01
   30  00:00:02   2.0742e+02      8          1.4655e+02   3.3503e-02   5.7964e+00   1.0000e-01
   40  00:00:02   2.0731e+02      9          1.4647e+02   2.5740e-02   5.9197e+00   1.0000e-01
   50  00:00:02   2.0582e+02     10          1.4541e+02   1.0672e-02   6.1372e+00   1.0000e-01
   60  00:00:03   2.0084e+02     11          1.4188e+02   3.8870e-03   6.2303e+00   1.0000e-01
   66  00:00:03   1.9830e+02     12  EP      1.4008e+02   2.9419e-03   6.2432e+00   1.0000e-01

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:03   2.0860e+02     13  EP      1.4745e+02   3.9361e-02   3.7302e+00   1.0000e-01
   10  00:00:03   2.1262e+02     14          1.5031e+02   7.5215e-03   3.2441e+00   1.0000e-01
   20  00:00:03   2.1761e+02     15          1.5384e+02   3.3914e-03   3.1877e+00   1.0000e-01
   23  00:00:04   2.1901e+02     16  EP      1.5483e+02   2.9398e-03   3.1816e+00   1.0000e-01
 </pre> <h2> Computation of FRC at order 5 </h2> <pre class="codeoutput">
*****************************************
Calculating FRC using SSM with master subspace: [1  2]
The master subspace contains the following eigenvalues
 
lambda1 == - 0.2949104 + 147.4549i
 
lambda2 == (-0.2949104) - 147.4549i
 
sigma_in = 5
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.18E+01 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 1.29E+01 MB
Manifold computation time at order 4 = 00:00:01
Estimated memory usage at order  4 = 1.39E+01 MB
Manifold computation time at order 5 = 00:00:02
Estimated memory usage at order  5 = 1.58E+01 MB

 Run='freqSubint1.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          5.75e-04  2.09e+02    0.0    0.0    0.0
   1   1  1.00e+00  2.78e-05  1.01e-08  2.09e+02    0.0    0.0    0.0
   2   1  1.00e+00  2.36e-08  5.55e-17  2.09e+02    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   2.0860e+02      1  EP      1.4745e+02   3.9597e-02   3.7348e+00   1.0000e-01
   10  00:00:00   2.0690e+02      2          1.4623e+02   6.6258e-02   4.7307e+00   1.0000e-01
   14  00:00:00   2.0688e+02      3  FP      1.4620e+02   6.5402e-02   4.8896e+00   1.0000e-01
   14  00:00:00   2.0688e+02      4  SN      1.4620e+02   6.5402e-02   4.8896e+00   1.0000e-01
   20  00:00:00   2.0704e+02      5          1.4631e+02   5.8201e-02   5.2520e+00   1.0000e-01
   27  00:00:01   2.0742e+02      6  FP      1.4656e+02   3.5386e-02   5.7645e+00   1.0000e-01
   27  00:00:01   2.0742e+02      7  SN      1.4656e+02   3.5386e-02   5.7645e+00   1.0000e-01
   30  00:00:01   2.0742e+02      8          1.4655e+02   3.2528e-02   5.8124e+00   1.0000e-01
   40  00:00:01   2.0727e+02      9          1.4644e+02   2.4331e-02   5.9411e+00   1.0000e-01
   50  00:00:02   2.0501e+02     10          1.4483e+02   8.2847e-03   6.1702e+00   1.0000e-01
   60  00:00:02   2.0002e+02     11          1.4130e+02   3.5221e-03   6.2353e+00   1.0000e-01
   64  00:00:02   1.9830e+02     12  EP      1.4008e+02   2.9419e-03   6.2432e+00   1.0000e-01

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:02   2.0860e+02     13  EP      1.4745e+02   3.9597e-02   3.7348e+00   1.0000e-01
   10  00:00:02   2.1260e+02     14          1.5030e+02   7.5493e-03   3.2445e+00   1.0000e-01
   20  00:00:03   2.1760e+02     15          1.5383e+02   3.3972e-03   3.1878e+00   1.0000e-01
   23  00:00:03   2.1901e+02     16  EP      1.5483e+02   2.9398e-03   3.1816e+00   1.0000e-01
  </pre> <h2> Computation of FRC at order 7</h2> <pre class="codeoutput">
*****************************************
Calculating FRC using SSM with master subspace: [1  2]
The master subspace contains the following eigenvalues
 
lambda1 == - 0.2949104 + 147.4549i
 
lambda2 == (-0.2949104) - 147.4549i
 
sigma_in = 5
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.18E+01 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 1.29E+01 MB
Manifold computation time at order 4 = 00:00:01
Estimated memory usage at order  4 = 1.39E+01 MB
Manifold computation time at order 5 = 00:00:02
Estimated memory usage at order  5 = 1.58E+01 MB
Manifold computation time at order 6 = 00:00:07
Estimated memory usage at order  6 = 1.78E+01 MB
Manifold computation time at order 7 = 00:00:11
Estimated memory usage at order  7 = 2.10E+01 MB

 Run='freqSubint1.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          4.00e-05  2.09e+02    0.0    0.0    0.0
   1   1  1.00e+00  5.23e-06  6.10e-11  2.09e+02    0.0    0.0    0.0
   2   1  1.00e+00  1.21e-10  1.11e-16  2.09e+02    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   2.0860e+02      1  EP      1.4745e+02   3.9582e-02   3.7344e+00   1.0000e-01
   10  00:00:00   2.0688e+02      2          1.4621e+02   6.6380e-02   4.7322e+00   1.0000e-01
   14  00:00:00   2.0685e+02      3  FP      1.4619e+02   6.5602e-02   4.8807e+00   1.0000e-01
   14  00:00:00   2.0685e+02      4  SN      1.4619e+02   6.5602e-02   4.8807e+00   1.0000e-01
   20  00:00:01   2.0701e+02      5          1.4629e+02   5.8890e-02   5.2305e+00   1.0000e-01
   27  00:00:01   2.0742e+02      6  FP      1.4656e+02   3.5347e-02   5.7652e+00   1.0000e-01
   27  00:00:01   2.0742e+02      7  SN      1.4656e+02   3.5347e-02   5.7652e+00   1.0000e-01
   30  00:00:01   2.0742e+02      8          1.4655e+02   3.2416e-02   5.8143e+00   1.0000e-01
   40  00:00:01   2.0727e+02      9          1.4644e+02   2.4221e-02   5.9427e+00   1.0000e-01
   50  00:00:02   2.0497e+02     10          1.4480e+02   8.1970e-03   6.1714e+00   1.0000e-01
   60  00:00:02   1.9998e+02     11          1.4127e+02   3.5063e-03   6.2355e+00   1.0000e-01
   64  00:00:02   1.9830e+02     12  EP      1.4008e+02   2.9419e-03   6.2432e+00   1.0000e-01

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:02   2.0860e+02     13  EP      1.4745e+02   3.9582e-02   3.7344e+00   1.0000e-01
   10  00:00:03   2.1260e+02     14          1.5030e+02   7.5474e-03   3.2445e+00   1.0000e-01
   20  00:00:03   2.1760e+02     15          1.5383e+02   3.3968e-03   3.1878e+00   1.0000e-01
   23  00:00:03   2.1901e+02     16  EP      1.5483e+02   2.9398e-03   3.1816e+00   1.0000e-01
Total time spent on FRC computation upto O(3) = 00:00:31
Total time spent on FRC computation upto O(5) = 00:00:34
Total time spent on FRC computation upto O(7) = 00:00:52
</pre><img alt="" hspace="5" src="vonKarmanShellWorkbookDoc_03.png" vspace="5"/> <img alt="" hspace="5" src="vonKarmanShellWorkbookDoc_04.png" vspace="5"/> <p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2021a</a><br/></p></pre></div><!--
##### SOURCE BEGIN #####
%% Shallow-curved shell structure with geometric nonlinearities
% Finite element model used in the following reference:
% 
% Jain, S., & Tiso, P. (2018). Simulation-free hyper-reduction for geometrically 
% nonlinear structural dynamics: a quadratic manifold lifting approach. _Journal 
% of Computational and Nonlinear Dynamics_, _13_(7), 071003. <https://doi.org/10.1115/1.4040021 
% https://doi.org/10.1115/1.4040021>
% 
% Finite element code taken from the following package:
% 
% Jain, S., Marconi, J., Tiso P. (2020). YetAnotherFEcode (Version v1.1). Zenodo. 
% <http://doi.org/10.5281/zenodo.4011282 http://doi.org/10.5281/zenodo.4011282>
% 
% 
%% 
% *system parameters*

clear all
nDiscretization = 10; % Discretization parameter (#DOFs is proportional to the square of this number)
epsilon = 0.1;
%% generate model

[M,C,K,fnl,f_0,outdof] = build_model(nDiscretization);
n = length(M); % number of degrees of freedom
disp(['Number of degrees of freedom = ' num2str(n)])
disp(['Phase space dimensionality = ' num2str(2*n)])
%% Dynamical system setup 
% We consider the forced system
% 
% $$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{f}^{ext}(\mathbf{\Omega}t),$$
% 
% which can be written in the first-order form as 
% 
% $$\mathbf{B}\dot{\mathbf{z}}=\mathbf{Az}+\mathbf{F}(\mathbf{z})+\epsilon\mathbf{F}^{ext}(\mathbf{\phi t}),$$
%
% $$\dot{\mathbf{\phi}}=\mathbf{\Omega}$$
% 
%
% where
% 
% $\mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} 
% & \mathbf{0}\\\mathbf{0} & \mathbf{M}\end{array}\right],\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} 
% & \mathbf{M}\\\mathbf{M} & \mathbf{0}\end{array}\right],\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}\mathbf{-\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})}\\\mathbf{0}\end{array}\right],\quad\mathbf{F}^{ext}(\mathbf{z},\mathbf{\phi})=\left[\begin{array}{c}\mathbf{f}^{ext}(\mathbf{\phi})\\\mathbf{0}\end{array}\right]$.
%

DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,'M',M,'C',C,'K',K,'fnl',fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','multiindex')

%% 
% We assume periodic forcing of the form
% 
% $$\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi} 
% + \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$
% 
% Fourier coefficients of Forcing

kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
%% Linear Modal analysis and SSM setup

[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
%% 
% *Choose Master subspace (perform resonance analysis)*

S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.1,'notation','multiindex')
masterModes = [1,2]; 
S.<a href="../../../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
%% Forced response curves using SSMs
% Obtaining *forced response curve* in reduced-polar coordinate

order = [3, 5, 7]; % Approximation order
%% 
% setup options

set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 1,'IRtol',0.02,'notation', 'multiindex','contribNonAuto',true)
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'nt', 2^7, 'nRho', 200, 'nPar', 200, 'nPsi', 100, 'rhoScale', 2 )
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'method','continuation ep', 'z0', 1e-4*[1; 1]) % 'level set' 
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'outdof',outdof)
%% 
% choose frequency range around the first natural frequency

omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.95 1.05];
%% 
% extract forced response curve

FRC = S.<a href="../../../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>('freq',omegaRange,order);
figFRC = gcf;
##### SOURCE END #####
--></body></head></html></body></html></html>