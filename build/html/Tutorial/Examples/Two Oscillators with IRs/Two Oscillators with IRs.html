
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><html><body><div class="banner"><a href="../../../index.html"><img alt="Logo" class="logo" src="../../../logo.png" style="float:right" width="200"/></a></div><html><head><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>demoDoc</title><meta content="MATLAB 9.10" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-07-10" name="DC.date"/><meta content="demoDoc.m" name="DC.source"/><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Oscillatory system with 2:1 internal resonance</h1>
<!--introduction--><p>Consider the following system with 2 dofs</p>
<p><img alt="$$\ddot{x}_1+c_1\dot{x}_1+x_1+b_1x_1x_2=\epsilon f_1\cos\Omega t$$" src="demoDoc_eq16743174576649462211-Rescaled.png" style="width: 250px; height: auto;"/></p>
<p><img alt="$$\ddot{x}_2+c_2\dot{x}_2+4x_2+b_2x_1^2=\epsilon f_2\cos\Omega t$$" src="demoDoc_eq16743174576649462212-Rescaled.png" style="width: 250px; height: auto;"/></p>
<p>It follows that the system has 1:2 internal resonance. Given damping coefficients <img alt="$c_{1,2}$" src="demoDoc_eq00376161850217810741-Rescaled.png" style="width: 16.8px; height: auto;"/>, nonlinear spring coefficients <img alt="$b_{1,2}$" src="demoDoc_eq12576404497655555594-Rescaled.png" style="width: 16.8px; height: auto;"/> and forcing coefficients <img alt="$f_{1,2}$" src="demoDoc_eq02992613037391994784-Rescaled.png" style="width: 18.0px; height: auto;"/>, the solution manifold of such system is of two dimension and can be parameterized by <img alt="$(\epsilon,\Omega)$" src="demoDoc_eq06828572922038251711-Rescaled.png" style="width: 28.799999999999997px; height: auto;"/> in general. We use this example to demonstrate</p>
<!--/introduction--><h2>Contents</h2>
<div><ul>
<li><b>SSM_isol2ep</b>: continuation of equilibrium points in slow-phase normal-form dynamics (corresponding to periodic orbits in the original system) in either forcing frequency <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/> or forcing amplitude <img alt="$\epsilon$" src="demoDoc_eq04202927574850129020-Rescaled.png" style="width: 4.8px; height: auto;"/>. The continuation here starts from an initial solution (isol);</li>
<li><b>SSM_ep2ep</b>: continuation of equilibrium points in slow-phase reduced dynamics (corresponding to periodic orbits in the original system) in either forcing frequency <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/> or forcing amplitude <img alt="$\epsilon$" src="demoDoc_eq04202927574850129020-Rescaled.png" style="width: 4.8px; height: auto;"/>. The continuation here starts from a saved solution to equilibrium points (ep);</li>
<li><b>SSM_ep2SN</b>: continuation of saddle-node (SN) bifurcation equilibrium points in slow-phase normal-form dynamics (corresponding to SN bifurcation periodic orbits in the original system) in <img alt="$(\Omega,\epsilon)$" src="demoDoc_eq03148028528688191358-Rescaled.png" style="width: 28.799999999999997px; height: auto;"/>. The continuation here starts from a saved ep solution, which is also a SN equilibrium point;</li>
<li><b>SSM_ep2HB</b>: continuation of Hopf bifurcation (HB) equilibrium points in slow-phase  normal-form dynamics (corresponding to Neimark-Sacker or torus (TR) bifurcation periodic orbits in the original system) in <img alt="$(\Omega,\epsilon)$" src="demoDoc_eq03148028528688191358-Rescaled.png" style="width: 28.799999999999997px; height: auto;"/>. The continuation here starts from a saved ep solution, which is also a HB equilibrium point;</li>
<li><b>SSM_BP2ep</b>: continuation of equilibrium points in slow-phase  normal-form dynamics. The continuation here starts from a saved branch point (BP) solution, which is also an ep equilibrium point;</li>
</ul></div><pre class="codeinput">clear <span class="string">all</span>
</pre><h2 id="2">Setup model</h2><pre class="codeinput">m = 1;
c1 = 5e-3;
c2 = 1e-2;
b1 = 1;
b2 = 1;
f1 = 1;
f2 = 0;
[mass,damp,stiff,fnl,fext] = build_model(c1,c2,b1,b2,f1,f2);


DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,<span class="string">'M'</span>,mass,<span class="string">'C'</span>,damp,<span class="string">'K'</span>,stiff,<span class="string">'fnl'</span>,fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'Emax'</span>,5,<span class="string">'Nmax'</span>,10,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
</pre><p> Set up the forcing</p>
<pre class="codeinput">
epsilon = 1e-2;
kappas  = [-1; 1];
coeffs  = [fext fext]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas, epsilon);
</pre><p> Perform Linear Modal Analysis</p>
<pre class="codeinput">
[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
</pre><pre class="codeoutput">
 The first 4 nonzero eigenvalues are given as 
  -0.0025 + 1.0000i
  -0.0025 - 1.0000i
  -0.0050 + 2.0000i
  -0.0050 - 2.0000i

</pre><h2 id="3">SSM computation</h2><pre class="codeinput">S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 1,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>);
resonant_modes = [1 2 3 4]; <span class="comment">% choose master spectral subspace</span>
mFreq  = [1 2];              <span class="comment">% internal resonance relation vector</span>
order  = 3;                  <span class="comment">% SSM expansion order</span>
outdof = [1 2 3];           <span class="comment">% outdof for output</span>
</pre>
<h2 id="3">SSM_epSweeps:</h2>
<p> continuation of FRC w.r.t <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/> at sampled <img alt="$\{\epsilon_i\}$" src="demoDoc_eq09303165061505845224-Rescaled.png" style="width: 21.599999999999998px; height: auto;"/> Before diving into the list of functions mentioned above, we demonstrate SSM_epSweeps, a function built based on the SSM_isol2ep and SSM_ep2ep. It</p><div><ol><li>continues in <img alt="$\epsilon$" src="demoDoc_eq04202927574850129020-Rescaled.png" style="width: 4.8px; height: auto;"/> (with fixed <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/>) and labels the solutions that satisfies <img alt="$\epsilon=\epsilon_i$" src="demoDoc_eq16241823092519115030-Rescaled.png" style="width: 31.2px; height: auto;"/> with UZ,</li><li>continues in <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/> (with <img alt="$\epsilon\equiv\epsilon_i$" src="demoDoc_eq07186898291440626457-Rescaled.png" style="width: 31.2px; height: auto;"/>) for each <img alt="$\epsilon_i$" src="demoDoc_eq06580280593587360540-Rescaled.png" style="width: 8.4px; height: auto;"/>,</li><li>plots FRCs</li></ol></div><pre class="codeinput">set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>,<span class="string">'sampStyle'</span>, <span class="string">'cocoBD'</span>);                         <span class="comment">% sampling style</span>
set(S.contOptions, <span class="string">'PtMX'</span>, 200, <span class="string">'ItMX'</span>, 15, <span class="string">'h_max'</span>, 0.1,<span class="string">'h_min'</span>,0.01);    <span class="comment">% continuation setting</span>
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'nCycle'</span>,5000, <span class="string">'initialSolver'</span>, <span class="string">'fsolve'</span>);     <span class="comment">% initial solution scheme</span>
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'coordinates'</span>, <span class="string">'polar'</span>);                       <span class="comment">% two coordinate representations</span>

epsSamp = [0.001 0.003 0.005 0.007 0.01]
freqRange = [0.7 1.1]*imag(D(1));
S.<a href="../../../Library/SSM/SSM_epSweeps.html">SSM_epSweeps</a>(<span class="string">'sweeps'</span>,resonant_modes,order,mFreq,epsSamp,freqRange,outdof);
</pre><pre class="codeoutput">
epsSamp =

    0.0010    0.0030    0.0050    0.0070    0.0100

The master subspace contains the following eigenvalues
 
lambda1 == - 0.0025 + 1i
 
lambda2 == (-0.0025) - 1i
 
lambda3 == - 0.005 + 2i
 
lambda4 == (-0.005) - 2i
 
sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:04
Estimated memory usage at order  2 = 1.25E-02 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 2.04E-02 MB

Equation solved.

fsolve completed because the vector of function values is near zero
as measured by the value of the function tolerance, and
the problem appears regular as measured by the gradient.


 Run='sweepseps.ep': Continue equilibria with varied epsilon.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.81e-10  9.93e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE           eps         rho1         rho2          th1          th2           om
    0  00:00:00   9.9315e+00      1  EP      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    1  00:00:00   9.9315e+00      2  UZ      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    1  00:00:00   9.9332e+00      3  UZ      7.0000e-03   5.7140e-02   2.1921e-01   3.9138e+00   5.7849e+00   1.0000e+00
    2  00:00:01   9.9351e+00      4  UZ      5.0000e-03   5.0820e-02   1.7340e-01   3.9144e+00   5.7878e+00   1.0000e+00
    3  00:00:01   9.9384e+00      5  UZ      3.0000e-03   4.2426e-02   1.2085e-01   3.9152e+00   5.7914e+00   1.0000e+00
    4  00:00:01   9.9456e+00      6  UZ      1.0000e-03   2.8284e-02   5.3709e-02   3.9170e+00   5.7975e+00   1.0000e+00
    4  00:00:01   9.9464e+00      7  EP      9.0000e-04   2.7155e-02   4.9507e-02   3.9172e+00   5.7981e+00   1.0000e+00

 STEP      TIME        ||U||  LABEL  TYPE           eps         rho1         rho2          th1          th2           om
    0  00:00:01   9.9315e+00      8  EP      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    1  00:00:01   9.9311e+00      9  EP      1.1000e-02   6.6778e-02   2.9940e-01   3.9128e+00   5.7801e+00   1.0000e+00

 Run='sweepseps1.ep': Continue equilibria with varied omega at eps equal to 1.000000e-03.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          2.36e-14  1.00e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   9.9958e+00      1  EP      1.0000e+00   2.8284e-02   5.3709e-02   3.9170e+00   5.7975e+00   1.0000e-03
    6  00:00:00   9.5734e+00      2  HB      9.9801e-01   3.1756e-02   5.3118e-02   3.5279e+00   5.6902e+00   1.0000e-03
   10  00:00:00   9.5115e+00      3          9.9692e-01   3.5391e-02   5.3158e-02   3.4247e+00   5.7015e+00   1.0000e-03
   20  00:00:00   9.5462e+00      4          9.9576e-01   3.9678e-02   5.3817e-02   3.3781e+00   5.7583e+00   1.0000e-03
   30  00:00:01   9.9391e+00      5          9.9263e-01   5.1821e-02   5.8028e-02   3.4238e+00   6.0563e+00   1.0000e-03
   40  00:00:01   1.0922e+01      6          9.8861e-01   6.7265e-02   6.5321e-02   3.6946e+00   6.7089e+00   1.0000e-03
   50  00:00:01   1.1913e+01      7          9.8656e-01   7.3726e-02   6.6904e-02   3.9978e+00   7.3477e+00   1.0000e-03
   60  00:00:02   1.2832e+01      8  FP      9.8600e-01   7.2692e-02   6.2507e-02   4.2879e+00   7.9351e+00   1.0000e-03
   60  00:00:02   1.2832e+01      9  SN      9.8600e-01   7.2692e-02   6.2507e-02   4.2879e+00   7.9351e+00   1.0000e-03
   60  00:00:02   1.2905e+01     10          9.8600e-01   7.2338e-02   6.1913e-02   4.3112e+00   7.9815e+00   1.0000e-03
   70  00:00:02   1.3899e+01     11          9.8657e-01   6.3922e-02   5.0324e-02   4.6303e+00   8.6124e+00   1.0000e-03
   80  00:00:02   1.4894e+01     12          9.8757e-01   4.9605e-02   3.2625e-02   4.9520e+00   9.2416e+00   1.0000e-03
   84  00:00:03   1.5231e+01     13  SN      9.8772e-01   4.3504e-02   2.5373e-02   5.0603e+00   9.4559e+00   1.0000e-03
   84  00:00:03   1.5231e+01     14  FP      9.8772e-01   4.3504e-02   2.5372e-02   5.0603e+00   9.4559e+00   1.0000e-03
   90  00:00:03   1.5887e+01     15          9.8624e-01   2.9260e-02   1.0282e-02   5.2603e+00   9.8771e+00   1.0000e-03
  100  00:00:03   1.6691e+01     16          9.3233e-01   5.2227e-03   6.7614e-05   5.4608e+00   1.0421e+01   1.0000e-03
  110  00:00:04   1.6778e+01     17          8.2837e-01   2.0598e-03   4.1489e-06   5.4832e+00   1.0488e+01   1.0000e-03
  115  00:00:04   1.6794e+01     18  EP      7.0000e-01   1.1785e-03   7.7699e-07   5.4895e+00   1.0507e+01   1.0000e-03

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:04   9.9958e+00     19  EP      1.0000e+00   2.8284e-02   5.3709e-02   3.9170e+00   5.7975e+00   1.0000e-03
    6  00:00:05   1.0394e+01     20  HB      1.0018e+00   3.1304e-02   5.3569e-02   4.2741e+00   5.8943e+00   1.0000e-03
   10  00:00:05   1.0474e+01     21          1.0029e+00   3.5081e-02   5.3809e-02   4.3885e+00   5.8809e+00   1.0000e-03
   20  00:00:05   1.0445e+01     22          1.0040e+00   3.9174e-02   5.4625e-02   4.4335e+00   5.8206e+00   1.0000e-03
   30  00:00:06   1.0033e+01     23          1.0070e+00   5.1191e-02   5.9292e-02   4.3766e+00   5.4918e+00   1.0000e-03
   40  00:00:06   9.0879e+00     24          1.0103e+00   6.4607e-02   6.5923e-02   4.1038e+00   4.8399e+00   1.0000e-03
   50  00:00:06   8.1398e+00     25          1.0120e+00   6.9854e-02   6.6607e-02   3.8008e+00   4.2010e+00   1.0000e-03
   60  00:00:06   7.2004e+00     26          1.0126e+00   6.8090e-02   6.0651e-02   3.4880e+00   3.5669e+00   1.0000e-03
   61  00:00:07   7.1277e+00     27  SN      1.0126e+00   6.7677e-02   5.9907e-02   3.4634e+00   3.5176e+00   1.0000e-03
   61  00:00:07   7.1277e+00     28  FP      1.0126e+00   6.7677e-02   5.9907e-02   3.4634e+00   3.5176e+00   1.0000e-03
   70  00:00:07   6.2764e+00     29          1.0123e+00   5.9969e-02   4.8123e-02   3.1700e+00   2.9355e+00   1.0000e-03
   80  00:00:07   5.3790e+00     30          1.0118e+00   4.6123e-02   2.9560e-02   2.8509e+00   2.3049e+00   1.0000e-03
   81  00:00:07   5.3602e+00     31  SN      1.0118e+00   4.5763e-02   2.9102e-02   2.8441e+00   2.2914e+00   1.0000e-03
   81  00:00:07   5.3602e+00     32  FP      1.0118e+00   4.5762e-02   2.9101e-02   2.8441e+00   2.2914e+00   1.0000e-03
   90  00:00:08   4.5423e+00     33          1.0149e+00   2.5311e-02   7.1105e-03   2.5521e+00   1.6650e+00   1.0000e-03
  100  00:00:08   4.0771e+00     34          1.0788e+00   4.4858e-03   4.2850e-05   2.3879e+00   1.2023e+00   1.0000e-03
  103  00:00:08   4.0688e+00     35  EP      1.1000e+00   3.5345e-03   2.0962e-05   2.3812e+00   1.1821e+00   1.0000e-03

 Run='sweepseps2.ep': Continue equilibria with varied omega at eps equal to 3.000000e-03.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.99e-18  9.99e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   9.9885e+00      1  EP      1.0000e+00   4.2426e-02   1.2085e-01   3.9152e+00   5.7914e+00   3.0000e-03
..
  131  00:00:04   1.6794e+01     20  EP      7.0000e-01   3.5355e-03   6.9931e-06   5.4895e+00   1.0507e+01   3.0000e-03

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:04   9.9885e+00     21  EP      1.0000e+00   4.2426e-02   1.2085e-01   3.9152e+00   5.7914e+00   3.0000e-03
..
  118  00:00:09   4.0688e+00     38  EP      1.1000e+00   1.0605e-02   1.8872e-04   2.3812e+00   1.1822e+00   3.0000e-03

 Run='sweepseps3.ep': Continue equilibria with varied omega at eps equal to 5.000000e-03.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          7.27e-18  9.99e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   9.9853e+00      1  EP      1.0000e+00   5.0820e-02   1.7340e-01   3.9144e+00   5.7878e+00   5.0000e-03
..
  137  00:00:04   1.6794e+01     20  EP      7.0000e-01   5.8926e-03   1.9426e-05   5.4895e+00   1.0507e+01   5.0000e-03

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:04   9.9853e+00     21  EP      1.0000e+00   5.0820e-02   1.7340e-01   3.9144e+00   5.7878e+00   5.0000e-03
..
  123  00:00:08   4.0689e+00     39  EP      1.1000e+00   1.7681e-02   5.2455e-04   2.3812e+00   1.1822e+00   5.0000e-03

 Run='sweepseps4.ep': Continue equilibria with varied omega at eps equal to 7.000000e-03.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          5.83e-15  9.98e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   9.9834e+00      1  EP      1.0000e+00   5.7140e-02   2.1921e-01   3.9138e+00   5.7849e+00   7.0000e-03
..
  142  00:00:04   1.6794e+01     21  EP      7.0000e-01   8.2498e-03   3.8077e-05   5.4895e+00   1.0507e+01   7.0000e-03

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:04   9.9834e+00     22  EP      1.0000e+00   5.7140e-02   2.1921e-01   3.9138e+00   5.7849e+00   7.0000e-03
..
  129  00:00:10   4.0691e+00     40  EP      1.1000e+00   2.4766e-02   1.0291e-03   2.3813e+00   1.1823e+00   7.0000e-03

 Run='sweepseps5.ep': Continue equilibria with varied omega at eps equal to 1.000000e-02.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.81e-10  9.98e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   9.9817e+00      1  EP      1.0000e+00   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e-02
..
  149  00:00:06   1.6794e+01     21  EP      7.0000e-01   1.1786e-02   7.7718e-05   5.4895e+00   1.0507e+01   1.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:06   9.9817e+00     22  EP      1.0000e+00   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e-02
..
  133  00:00:10   4.0695e+00     41  EP      1.1000e+00   3.5416e-02   2.1045e-03   2.3813e+00   1.1824e+00   1.0000e-02

Calculate FRC in physical domain at epsilon 1.000000e-03
Calculate FRC in physical domain at epsilon 3.000000e-03
Calculate FRC in physical domain at epsilon 5.000000e-03
Calculate FRC in physical domain at epsilon 7.000000e-03
Calculate FRC in physical domain at epsilon 1.000000e-02
</pre>
<h2>FRCs on parametrisation space:</h2>
<img alt="" hspace="5" src="demoDoc_01.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_02.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_03.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_04.png" style="width:45%" vspace="5"/>
<h2>FRCs on physical DOF 1:</h2>
<img alt="" hspace="5" src="demoDoc_05.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_06.png" style="width:45%" vspace="5"/>
<h2>FRCs on physical DOF 2:</h2>
<img alt="" hspace="5" src="demoDoc_07.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_08.png" style="width:45%" vspace="5"/>
<h2>FRCs on physical DOF 3:</h2>
<img alt="" hspace="5" src="demoDoc_09.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_10.png" style="width:45%" vspace="5"/>
<h2 id="6">SSM_isol2ep:</h2><p>continuation of equilibrium points from an initial solution*</p><pre class="codeinput">set(S.contOptions, <span class="string">'PtMX'</span>, 200, <span class="string">'ItMX'</span>, 15, <span class="string">'h_max'</span>, 0.5);    <span class="comment">% continuation setting</span>
FRC1 = S.<a href="../../../Library/SSM/SSM_isol2ep.html">SSM_isol2ep</a>(<span class="string">'isol_freq'</span>,resonant_modes,order,mFreq,<span class="string">'freq'</span>,freqRange,outdof);
</pre><pre class="codeoutput">The master subspace contains the following eigenvalues
 
lambda1 == - 0.0025 + 1i
 
lambda2 == (-0.0025) - 1i
 
lambda3 == - 0.005 + 2i
 
lambda4 == (-0.005) - 2i
 
sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.25E-02 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 2.04E-02 MB

Equation solved.

fsolve completed because the vector of function values is near zero
as measured by the value of the function tolerance, and
the problem appears regular as measured by the gradient.


 Run='isol_freq.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.81e-10  9.98e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:00   9.9817e+00      1  EP      1.0000e+00   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e-02
    8  00:00:00   7.8756e+00      2  HB      9.8785e-01   1.2167e-01   2.0189e-01   2.7123e+00   4.7565e+00   1.0000e-02
   10  00:00:00   7.8607e+00      3          9.8581e-01   1.3071e-01   2.0058e-01   2.6964e+00   4.7535e+00   1.0000e-02
   20  00:00:01   7.9165e+00      4          9.7414e-01   1.8020e-01   2.1142e-01   2.6838e+00   4.8069e+00   1.0000e-02
   30  00:00:01   1.0622e+01      5          7.8212e-01   8.5499e-01   5.7517e-01   3.4976e+00   6.5200e+00   1.0000e-02
   33  00:00:01   1.2015e+01      6  SN      7.4027e-01   9.6886e-01   6.2061e-01   3.9382e+00   7.4030e+00   1.0000e-02
   33  00:00:01   1.2016e+01      7  FP      7.4027e-01   9.6885e-01   6.2061e-01   3.9382e+00   7.4031e+00   1.0000e-02
   40  00:00:01   1.5088e+01      8          8.9664e-01   4.5826e-01   3.4531e-01   4.9416e+00   9.3952e+00   1.0000e-02
   43  00:00:02   1.6420e+01      9  FP      9.5793e-01   1.2662e-01   6.3998e-02   5.3826e+00   1.0242e+01   1.0000e-02
   43  00:00:02   1.6423e+01     10  SN      9.5793e-01   1.2584e-01   6.3212e-02   5.3836e+00   1.0244e+01   1.0000e-02
   50  00:00:02   1.6722e+01     11          9.1392e-01   4.1481e-02   3.3542e-03   5.4682e+00   1.0444e+01   1.0000e-02
   60  00:00:02   1.6788e+01     12          7.8029e-01   1.6096e-02   1.9792e-04   5.4864e+00   1.0498e+01   1.0000e-02
   63  00:00:02   1.6794e+01     13  EP      7.0000e-01   1.1786e-02   7.7718e-05   5.4895e+00   1.0507e+01   1.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1         rho2          th1          th2          eps
    0  00:00:02   9.9817e+00     14  EP      1.0000e+00   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e-02
    9  00:00:03   1.2066e+01     15  HB      1.0096e+00   1.1508e-01   2.2170e-01   5.0685e+00   6.7837e+00   1.0000e-02
   10  00:00:03   1.2086e+01     16          1.0108e+00   1.2130e-01   2.2108e-01   5.0845e+00   6.7893e+00   1.0000e-02
   20  00:00:03   1.2065e+01     17          1.0182e+00   1.6033e-01   2.3278e-01   5.1099e+00   6.7498e+00   1.0000e-02
   30  00:00:04   1.0124e+01     18          1.0640e+00   4.6440e-01   5.5392e-01   4.4942e+00   5.4213e+00   1.0000e-02
   35  00:00:04   8.1347e+00     19  SN      1.0741e+00   5.4396e-01   6.5319e-01   3.8231e+00   4.0736e+00   1.0000e-02
   35  00:00:04   8.1346e+00     20  FP      1.0741e+00   5.4396e-01   6.5319e-01   3.8230e+00   4.0735e+00   1.0000e-02
   40  00:00:04   5.5219e+00     21          1.0564e+00   3.5217e-01   3.6393e-01   2.9304e+00   2.2991e+00   1.0000e-02
   43  00:00:05   4.3623e+00     22  FP      1.0379e+00   1.4332e-01   9.0076e-02   2.5024e+00   1.4652e+00   1.0000e-02
   43  00:00:05   4.3493e+00     23  SN      1.0380e+00   1.4009e-01   8.6228e-02   2.4974e+00   1.4549e+00   1.0000e-02
   50  00:00:05   4.0732e+00     24          1.0885e+00   4.0081e-02   3.0453e-03   2.3847e+00   1.1924e+00   1.0000e-02
   52  00:00:05   4.0695e+00     25  EP      1.1000e+00   3.5416e-02   2.1045e-03   2.3813e+00   1.1824e+00   1.0000e-02
</pre>
<h2>Response on parametrisation space:</h2>
<img alt="" hspace="5" src="demoDoc_11.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_12.png" style="width:45%" vspace="5"/>
<h2>FRCs on physical space:</h2>
<img alt="" hspace="5" src="demoDoc_13.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_14.png" style="width:45%" vspace="5"/>
<p>The above continuation is performed with varied <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/>, as indicated by the keyword 'freq'. On the other hand, we may <b>vary the forcing amplitude</b> <img alt="$\epsilon$" src="demoDoc_eq04202927574850129020-Rescaled.png" style="width: 4.8px; height: auto;"/> instead of <img alt="$\Omega$" src="demoDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/></p><pre class="codeinput">
epsRange = [0.01 5]*epsilon;
FRC2     = S.<a href="../../../Library/SSM/SSM_isol2ep.html">SSM_isol2ep</a>(<span class="string">'isol_amp'</span>,resonant_modes,order,mFreq,<span class="string">'amp'</span>,epsRange,outdof);
</pre><pre class="codeoutput">The master subspace contains the following eigenvalues
 
lambda1 == - 0.0025 + 1i
 
lambda2 == (-0.0025) - 1i
 
lambda3 == - 0.005 + 2i
 
lambda4 == (-0.005) - 2i
 
sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.25E-02 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 2.04E-02 MB

Equation solved.

fsolve completed because the vector of function values is near zero
as measured by the value of the function tolerance, and
the problem appears regular as measured by the gradient.


 Run='isol_amp.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.81e-10  9.93e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE           eps         rho1         rho2          th1          th2           om
    0  00:00:00   9.9315e+00      1  EP      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    4  00:00:00   9.9483e+00      2  HB      6.9311e-04   2.4500e-02   4.0295e-02   3.9177e+00   5.7995e+00   1.0000e+00
    8  00:00:00   9.9667e+00      3  EP      9.9158e-05   9.5999e-03   6.1868e-03   3.9232e+00   5.8117e+00   1.0000e+00

 STEP      TIME        ||U||  LABEL  TYPE           eps         rho1         rho2          th1          th2           om
    0  00:00:00   9.9315e+00      4  EP      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    4  00:00:00   9.9538e+00      5  EP      5.0000e-02   1.1169e-01   8.3723e-01   3.9075e+00   5.7494e+00   1.0000e+00
</pre>
<h2>Continuation in Epsilon:</h2>
<img alt="" hspace="5" src="demoDoc_15.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_16.png" style="width:45%" vspace="5"/>
<h2>Result in physical coordinates:</h2>
<img alt="" hspace="5" src="demoDoc_17.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_18.png" style="width:45%" vspace="5"/>
<h2 id="8">SSM_ep2ep:</h2><p> We can also directly perform continuation of equilibrium points from saved solutions to obtain these results. </p><pre class="codeinput">FRC3 = S.<a href="../../../Library/SSM/SSM_ep2ep.html">SSM_ep2ep</a>(<span class="string">'ep'</span>,<span class="string">'isol_freq'</span>,1,<span class="string">'amp'</span>,epsRange,outdof);
</pre><pre class="codeoutput">
 Run='ep.ep': Continue equilibria from label 1 of run isol_freq.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.81e-10  9.93e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE           eps         rho1         rho2          th1          th2           om
    0  00:00:00   9.9315e+00      1  EP      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    4  00:00:00   9.9483e+00      2  HB      6.9311e-04   2.4500e-02   4.0295e-02   3.9177e+00   5.7995e+00   1.0000e+00
    8  00:00:00   9.9667e+00      3  EP      9.9158e-05   9.5999e-03   6.1868e-03   3.9232e+00   5.8117e+00   1.0000e+00

 STEP      TIME        ||U||  LABEL  TYPE           eps         rho1         rho2          th1          th2           om
    0  00:00:00   9.9315e+00      4  EP      1.0000e-02   6.4627e-02   2.8042e-01   3.9131e+00   5.7812e+00   1.0000e+00
    4  00:00:00   9.9538e+00      5  EP      5.0000e-02   1.1169e-01   8.3723e-01   3.9075e+00   5.7494e+00   1.0000e+00
</pre>
<h2>Continuation in Epsilon:</h2>
<img alt="" hspace="5" src="demoDoc_19.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_20.png" style="width:45%" vspace="5"/>
<h2>Result in physical coordinates:</h2>
<img alt="" hspace="5" src="demoDoc_21.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_22.png" style="width:45%" vspace="5"/>
<h2 id="9">SSM_ep2SN:</h2><p> This allows for the continuation of Saddle-Node bifurcation equilibrium points. We wish to investigate how the critical response amplitude for which the saddle node bifurcation occurs changes, if the forcing parameters are changed. </p><pre class="codeinput">SNlab = 6; <span class="comment">% or you use bd=coco_bd_read('isol.ep'); SNlabs=coco_bd_labs(bd, 'SN') to find it</span>
FRC4  = S.<a href="../../../Library/SSM/SSM_ep2SN.html">SSM_ep2SN</a>(<span class="string">'SN'</span>,<span class="string">'isol_freq'</span>,SNlab,{freqRange,epsRange},outdof);
</pre><pre class="codeoutput">
 Run='SN.ep': Continue saddle-node equilibria from label 6 of run isol_freq.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          6.53e-08  1.21e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om          eps         rho1         rho2          th1          th2
    0  00:00:00   1.2057e+01      1  EP      7.4027e-01   1.0000e-02   9.6886e-01   6.2061e-01   3.9382e+00   7.4030e+00
    2  00:00:00   1.2070e+01      2  EP      7.0000e-01   1.0844e-02   1.0741e+00   6.6133e-01   3.9363e+00   7.4005e+00

 STEP      TIME        ||U||  LABEL  TYPE            om          eps         rho1         rho2          th1          th2
    0  00:00:00   1.2057e+01      3  EP      7.4027e-01   1.0000e-02   9.6886e-01   6.2061e-01   3.9382e+00   7.4030e+00
   10  00:00:00   1.2262e+01      4          9.6408e-01   2.4302e-03   1.8548e-01   1.6133e-01   4.0509e+00   7.5683e+00
   20  00:00:01   1.3141e+01      5          9.8844e-01   8.1460e-04   5.8432e-02   4.8542e-02   4.3882e+00   8.0995e+00
   23  00:00:01   1.4071e+01      6  FP      9.9089e-01   6.1250e-04   3.9680e-02   2.8009e-02   4.7065e+00   8.6811e+00
   30  00:00:01   1.6298e+01      7          9.6875e-01   5.6798e-03   9.6261e-02   4.9710e-02   5.3419e+00   1.0140e+01
   40  00:00:02   1.6594e+01      8          9.3843e-01   2.0528e-02   1.7646e-01   8.5083e-02   5.4212e+00   1.0338e+01
   46  00:00:02   1.6708e+01      9  EP      9.0055e-01   5.0000e-02   2.6602e-01   1.1994e-01   5.4516e+00   1.0414e+01
</pre>
<h2>Bifurcations occur for the following forcing parameters:</h2>
<img alt="" hspace="5" src="demoDoc_23.png" style="width:45%" vspace="5"/>
<h2>Bifurcations in parametrisation space:</h2>
<img alt="" hspace="5" src="demoDoc_24.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_25.png" style="width:45%" vspace="5"/>
<h2>Bifurcations in physical space:</h2>
<img alt="" hspace="5" src="demoDoc_26.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_27.png" style="width:45%" vspace="5"/>
<h2 id="11">SSM_ep2HB: </h2>
<p>This routine can be used for the continuation of Hopf bifurcation equilibrium points. We wish to investigate how the critical response amplitude for which the hopf bifurcation occurs changes, if the forcing parameters are changed. </p><pre class="codeinput">HBlab = 2; <span class="comment">% or you use HBlabs = coco_bd_labs(bd, 'HB') to find it</span>
FRC5  = S.<a href="../../../Library/SSM/SSM_ep2HB.html">SSM_ep2HB</a>(<span class="string">'HB'</span>,<span class="string">'isol_freq'</span>,HBlab,{freqRange,epsRange},outdof);
</pre><pre class="codeoutput">
 Run='HB.ep': Continue Hopf equilibria from label 2 of run isol_freq.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          1.00e-08  7.94e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om          eps         rho1         rho2          th1          th2
    0  00:00:00   7.9388e+00      1  EP      9.8785e-01   1.0000e-02   1.2167e-01   2.0189e-01   2.7123e+00   4.7565e+00
    9  00:00:00   7.4546e+00      2  EP      9.6773e-01   5.0000e-02   2.8553e-01   4.2955e-01   2.4981e+00   4.4542e+00

 STEP      TIME        ||U||  LABEL  TYPE            om          eps         rho1         rho2          th1          th2
    0  00:00:00   7.9388e+00      3  EP      9.8785e-01   1.0000e-02   1.2167e-01   2.0189e-01   2.7123e+00   4.7565e+00
   10  00:00:01   9.9192e+00      4          9.9922e-01   7.3688e-04   2.5660e-02   4.2247e-02   3.7632e+00   5.7907e+00
   20  00:00:01   1.0529e+01      5          1.0021e+00   1.1010e-03   3.3329e-02   5.7490e-02   4.3285e+00   5.9319e+00
   30  00:00:02   1.2441e+01      6          1.0143e+00   2.3854e-02   1.7741e-01   3.5793e-01   5.2038e+00   6.9725e+00
   35  00:00:02   1.2643e+01      7  EP      1.0194e+00   5.0000e-02   2.5347e-01   5.3965e-01   5.2805e+00   7.0810e+00
</pre>
<h2>Bifurcations occur for the following forcing parameters:</h2>
<img alt="" hspace="5" src="demoDoc_28.png" style="width:45%" vspace="5"/>
<h2>Bifurcations in parametrisation space:</h2>
<img alt="" hspace="5" src="demoDoc_29.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_30.png" style="width:45%" vspace="5"/>
<h2>Bifurcations in physical space:</h2>
<img alt="" hspace="5" src="demoDoc_31.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_32.png" style="width:45%" vspace="5"/>
<h2 id="12">SSM_BP2ep:</h2>
<p>We now consider the primary resonance of the second mode and demonstrate how to use SSM_BP2ep to switch to the secondary branch. We use Cartesian coordinates.</p><pre class="codeinput">
fext   = [0;1];
coeffs = [fext fext]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas, epsilon);
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>,<span class="string">'coordinates'</span>,<span class="string">'cartesian'</span>)

mFreq     = [1/2 1];
freqRange = [0.9 1.1]*imag(D(3));
set(S.contOptions, <span class="string">'PtMX'</span>, 150);    <span class="comment">% continuation setting</span>

FRC6 = S.<a href="../../../Library/SSM/SSM_isol2ep.html">SSM_isol2ep</a>(<span class="string">'isol_2ndfreq'</span>,resonant_modes,order,mFreq,<span class="keyword">...</span>
    <span class="string">'freq'</span>,freqRange,outdof);
</pre><pre class="codeoutput">The master subspace contains the following eigenvalues
 
lambda1 == - 0.0025 + 1i
 
lambda2 == (-0.0025) - 1i
 
lambda3 == - 0.005 + 2i
 
lambda4 == (-0.005) - 2i
 
sigma_out = 0
sigma_in = 1
Manifold computation time at order 2 = 00:00:00
Estimated memory usage at order  2 = 1.25E-02 MB
Manifold computation time at order 3 = 00:00:00
Estimated memory usage at order  3 = 2.04E-02 MB

Equation solved.

fsolve completed because the vector of function values is near zero
as measured by the value of the function tolerance, and
the problem appears regular as measured by the gradient.


 Run='isol_2ndfreq.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          1.51e-10  2.98e+00    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         Rez1         Rez2         Imz1         Imz2          eps
    0  00:00:00   2.9835e+00      1  EP      2.0000e+00   8.6965e-10   6.0050e-01  -8.6965e-10  -3.0025e-01   1.0000e-02
   10  00:00:00   2.9470e+00      2          1.9974e+00  4.8808e-114   5.9398e-01 -1.6988e-113   1.2378e-02   1.0000e-02
   20  00:00:00   2.8815e+00      3          1.9938e+00  4.8722e-286   3.8160e-01 -1.5394e-286   1.7556e-01   1.0000e-02
   30  00:00:01   2.8138e+00      4          1.9817e+00  1.9763e-323   1.1842e-01 -3.4585e-323   1.3205e-01   1.0000e-02
   34  00:00:01   2.7821e+00      5  SN      1.9649e+00  1.9763e-323   5.3903e-02 -3.4585e-323   7.7911e-02   1.0000e-02
   34  00:00:01   2.7821e+00      6  BP      1.9649e+00  1.9763e-323   5.3903e-02 -3.4585e-323   7.7911e-02   1.0000e-02
   40  00:00:02   2.7342e+00      7          1.9327e+00  1.9763e-323   2.5502e-02 -3.4585e-323   4.2750e-02   1.0000e-02
   49  00:00:02   2.5457e+00      8  EP      1.8000e+00 -4.9407e-324   7.8768e-03 -4.9407e-324   1.4816e-02   1.0000e-02

 STEP      TIME        ||U||  LABEL  TYPE            om         Rez1         Rez2         Imz1         Imz2          eps
    0  00:00:02   2.9835e+00      9  EP      2.0000e+00   8.6965e-10   6.0050e-01  -8.6965e-10  -3.0025e-01   1.0000e-02
   10  00:00:03   2.9542e+00     10          2.0026e+00  2.5221e-113   3.4648e-01 -1.6786e-114  -4.8262e-01   1.0000e-02
   20  00:00:03   2.8988e+00     11          2.0062e+00  2.5663e-286   8.8507e-02 -6.3550e-286  -4.1061e-01   1.0000e-02
   30  00:00:03   2.8653e+00     12          2.0182e+00  4.9407e-324  -3.4593e-02  2.4703e-323  -1.7397e-01   1.0000e-02
   34  00:00:04   2.8810e+00     13  SN      2.0349e+00  4.9407e-324  -3.0063e-02  2.4703e-323  -9.0281e-02   1.0000e-02
   34  00:00:04   2.8810e+00     14  BP      2.0349e+00  4.9407e-324  -3.0063e-02  2.4703e-323  -9.0281e-02   1.0000e-02
   40  00:00:04   2.9244e+00     15          2.0672e+00  4.9407e-324  -1.8900e-02  2.4703e-323  -4.6051e-02   1.0000e-02
   49  00:00:05   3.1114e+00     16  EP      2.2000e+00  4.9407e-324  -7.1266e-03 -4.9407e-324  -1.5191e-02   1.0000e-02
</pre>
<h2>FRCs on parametrisation space:</h2>
<img alt="" hspace="5" src="demoDoc_33.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_34.png" style="width:45%" vspace="5"/>
<h2>FRCs on physical space:</h2>
<img alt="" hspace="5" src="demoDoc_35.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_36.png" style="width:45%" vspace="5"/>
<p>Continuation along the secondary branch: </p><pre class="codeinput">BPlab = 6;
set(S.contOptions,<span class="string">'bi_direct'</span>,false)
FRC6_BP = S.<a href="../../../Library/SSM/SSM_BP2ep.html">SSM_BP2ep</a>(<span class="string">'BPep'</span>,<span class="string">'isol_2ndfreq'</span>,BPlab,<span class="string">'freq'</span>,freqRange,outdof);
</pre><pre class="codeoutput">
 Run='BPep.ep': Continue equilibria along secondary branch from label 6 of run isol_2ndfreq.

 STEP      TIME        ||U||  LABEL  TYPE            om         Rez1         Rez2         Imz1         Imz2          eps
    0  00:00:00   2.7821e+00      1  EP      1.9649e+00  1.9763e-323   5.3903e-02 -3.4585e-323   7.7911e-02   1.0000e-02
    1  00:00:00   2.7821e+00      2  BP      1.9649e+00  -1.7779e-09   5.3903e-02  -1.0581e-09   7.7911e-02   1.0000e-02
    1  00:00:00   2.7821e+00      3  SN      1.9649e+00  -2.1056e-08   5.3903e-02  -1.5793e-08   7.7911e-02   1.0000e-02
    1  00:00:00   2.7822e+00      4  FP      1.9650e+00  -1.3633e-03   5.3634e-02  -9.4722e-04   7.7819e-02   1.0000e-02
   35  00:00:01   2.7004e+00      8  FP      1.8551e+00  -3.4978e-01   2.6141e-01   1.5599e-03  -1.1855e-01   1.0000e-02
   35  00:00:01   2.7004e+00      9  SN      1.8551e+00  -3.4978e-01   2.6141e-01   1.5603e-03  -1.1855e-01   1.0000e-02
  113  00:00:03   3.0667e+00     18  FP      2.1048e+00   3.1129e-03   3.3672e-01   3.4955e-01  -1.9106e-01   1.0000e-02
  113  00:00:03   3.0667e+00     19  SN      2.1048e+00   3.1133e-03   3.3672e-01   3.4955e-01  -1.9106e-01   1.0000e-02
  148  00:00:04   2.8810e+00     23  BP      2.0349e+00  -3.0517e-09  -3.0063e-02  -3.5567e-09  -9.0282e-02   1.0000e-02
  148  00:00:04   2.8810e+00     24  FP      2.0349e+00  -8.8576e-07  -3.0063e-02  -1.1805e-06  -9.0282e-02   1.0000e-02
  150  00:00:04   2.8817e+00     25  EP      2.0353e+00  -9.8826e-03  -2.9951e-02  -1.3230e-02  -9.1735e-02   1.0000e-02
</pre>
<h2>FRCs on parametrisation space:</h2>
<img alt="" hspace="5" src="demoDoc_37.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_38.png" style="width:45%" vspace="5"/>
<h2>FRCs on physical space:</h2>
<img alt="" hspace="5" src="demoDoc_39.png" style="width:45%" vspace="5"/>
<img alt="" hspace="5" src="demoDoc_40.png" style="width:45%" vspace="5"/>
<p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB® R2021a</a><br/></p></div><!--
##### SOURCE BEGIN #####
%% 
% Consider the following system with 2 dofs
% 
% $$\ddot{x}_1+c_1\dot{x}_1+x_1+b_1x_1x_2=\epsilon f_1\cos\Omega t\\\ddot{x}_2+c_2\dot{x}_2+4x_2+b_2x_1^2=\epsilon 
% f_2\cos\Omega t$$
% 
% It follows that the system has 1:2 internal resonance. Given damping coefficients 
% $c_{1,2}$, nonlinear spring coefficients $b_{1,2}$ and forcing coefficients 
% $f_{1,2}$, the solution manifold of such system is of two dimension and can 
% be parameterized by $(\epsilon,\Omega)$ in general. We use this example to demonstrate
%% 
% * *SSM_isol2ep*: continuation of equilibrium points in slow-phase normal-form 
% dynamics (corresponding to periodic orbits in the original system) in either 
% forcing frequency $\Omega$ or forcing amplitude $\epsilon$. The continuation 
% here starts from an initial solution (isol);
% * *SSM_ep2ep*: continuation of equilibrium points in slow-phase reduced dynamics 
% (corresponding to periodic orbits in the original system) in either forcing 
% frequency $\Omega$ or forcing amplitude $\epsilon$. The continuation here starts 
% from a saved solution to equilibrium points (ep);
% * *SSM_ep2SN*: continuation of saddle-node (SN) bifurcation equilibrium points 
% in slow-phase normal-form dynamics (corresponding to SN bifurcation periodic 
% orbits in the original system) in $(\Omega,\epsilon)$. The continuation here 
% starts from a saved ep solution, which is also a SN equilibrium point;
% * *SSM_ep2HB*: continuation of Hopf bifurcation (HB) equilibrium points in 
% slow-phase  normal-form dynamics (corresponding to Neimark-Sacker or torus (TR) 
% bifurcation periodic orbits in the original system) in $(\Omega,\epsilon)$. 
% The continuation here starts from a saved ep solution, which is also a HB equilibrium 
% point;

clear all
%% Setup model

m = 1;
c1 = 5e-3;
c2 = 1e-2;
b1 = 1;
b2 = 1;
f1 = 1;
f2 = 0;
[mass,damp,stiff,fnl,fext] = build_model(c1,c2,b1,b2,f1,f2);


DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,'M',mass,'C',damp,'K',stiff,'fnl',fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','multiindex')
% Forcing
epsilon = 1e-2;
kappas = [-1; 1];
coeffs = [fext fext]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas, epsilon);
% Linear Modal analysis

[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
%% SSM computation

S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 1,'notation','multiindex');
resonant_modes = [1 2 3 4]; % choose master spectral subspace
mFreq = [1 2];              % internal resonance relation vector
order = 3;                  % SSM expansion order
outdof = [1 2 3];           % outdof for output

%%
% SSM_epSweeps: continuation of FRC w.r.t $\Omega$ at sampled $\{\epsilon_i\}$
% Before diving into the list of functions mentioned above, we demonstrate SSM_epSweeps, 
% a function built based on the SSM_isol2ep and SSM_ep2ep. It
%% 
% # continues in $\epsilon$ (with fixed $\Omega$) and labels the solutions that 
% satisfies $\epsilon=\epsilon_i$ with UZ,
% # continues in $\Omega$ (with $\epsilon\equiv\epsilon_i$) for each $\epsilon_i$,
% # plots FRCs

set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>,'sampStyle', 'cocoBD');                         % sampling style
set(S.contOptions, 'PtMX', 200, 'ItMX', 15, 'h_max', 0.1,'h_min',0.01);    % continuation setting
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'nCycle',5000, 'initialSolver', 'fsolve');     % initial solution scheme
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'coordinates', 'polar');                       % two coordinate representations

epsSamp = [0.001 0.003 0.005 0.007 0.01]
freqRange = [0.7 1.1]*imag(D(1));
S.<a href="../../../Library/SSM/SSM_epSweeps.html">SSM_epSweeps</a>('sweeps',resonant_modes,order,mFreq,epsSamp,freqRange,outdof);

%% *SSM_isol2ep: 
% continuation of equilibrium points from an initial solution*
%

set(S.contOptions, 'PtMX', 200, 'ItMX', 15, 'h_max', 0.5);    % continuation setting
FRC1 = S.<a href="../../../Library/SSM/SSM_isol2ep.html">SSM_isol2ep</a>('isol_freq',resonant_modes,order,mFreq,'freq',freqRange,outdof);
%% 
% The above continuation is performed with varied $\Omega$, as indicated by 
% the keyword 'freq'. On the other hand, we may release forcing amplitude $\epsilon$ 
% instead of $\Omega$

epsRange = [0.01 5]*epsilon;
FRC2 = S.<a href="../../../Library/SSM/SSM_isol2ep.html">SSM_isol2ep</a>('isol_amp',resonant_modes,order,mFreq,'amp',epsRange,outdof);

%% SSM_ep2ep:
% continuation of equilibrium points from saved solution
%

FRC3 = S.<a href="../../../Library/SSM/SSM_ep2ep.html">SSM_ep2ep</a>('ep','isol_freq',1,'amp',epsRange,outdof);
%% SSM_ep2SN: 
% continuaiton of Saddle-Node bifurcation equilibrium points
% 

SNlab = 6; % or you use bd=coco_bd_read('isol.ep'); SNlabs=coco_bd_labs(bd, 'SN') to find it
FRC4 = S.<a href="../../../Library/SSM/SSM_ep2SN.html">SSM_ep2SN</a>('SN','isol_freq',SNlab,{freqRange,epsRange},outdof);
%% 
% Backbone curve? (view([0,0]) Cusp point
% SSM_ep2HB: continuation of Hopf bifurcation equilibrium points

HBlab = 2; % or you use HBlabs = coco_bd_labs(bd, 'HB') to find it
FRC5 = S.<a href="../../../Library/SSM/SSM_ep2HB.html">SSM_ep2HB</a>('HB','isol_freq',HBlab,{freqRange,epsRange},outdof);

%%
% We consider primary resonnace of the second mode and demonstrate how to use SSM_BP2ep to switch to the secondary branch.
% We use Cartesian coordinates.

fext = [0;1];
coeffs = [fext fext]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas, epsilon);
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>,'coordinates','cartesian')
mFreq = [1/2 1];
freqRange = [0.9 1.1]*imag(D(3));
set(S.contOptions, 'PtMX', 150);    % continuation setting
FRC6 = S.<a href="../../../Library/SSM/SSM_isol2ep.html">SSM_isol2ep</a>('isol_2ndfreq',resonant_modes,order,mFreq,...
    'freq',freqRange,outdof);

%% SSM_BP2ep: 
% continuation along the secondary branch
%

BPlab = 6;
set(S.contOptions,'bi_direct',false)
FRC6_BP = S.<a href="../../../Library/SSM/SSM_BP2ep.html">SSM_BP2ep</a>('BPep','isol_2ndfreq',BPlab,'freq',freqRange,outdof);
##### SOURCE END #####
--></body></head></html></body></html></html>