
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><html><body><div class="banner"><a href="../../../index.html"><img alt="Logo" class="logo" src="../../../logo.png" style="float:right" width="200"/></a></div><html><head><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--
    
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Euler Bernoulli beam with cubic spring and damper</title><meta content="MATLAB 9.10" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-07-05" name="DC.date"/><meta content="BernoulliBeamBaseDoc.m" name="DC.source"/><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Euler Bernoulli beam with cubic spring and damper</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Generate model</a></li><li><a href="#2">Dynamical system setup</a></li><li><a href="#5">Linear Modal analysis and SSM setup</a></li><li><a href="#7">Forced response curves using SSMs</a></li></ul></div><p>In this notebook, we consider the forced response curve of a Euler Bernoulli beam with cubic spring and damper at the free end, subject to a harmonic base excitation. In the frame attached to the oscillating base, the beam is subject to harmonic excitation in the form <span class="MathJax_Preview"><img alt="$m\Omega^2\cos\Omega t$" src="BernoulliBeamBaseDoc_eq07061455713171635040-Rescaled.png" style="width: 62.4px; height: auto;"/></span><script type="math/tex">m\Omega^2\cos\Omega t</script>, where <span class="MathJax_Preview"><img alt="$\Omega$" src="BernoulliBeamBaseDoc_eq01003107565813904020-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\Omega</script> is the excitation frequency.</p><img alt="" hspace="3" src="model.png" style="width:35%;" vspace="3"/><h2 id="1">Generate model</h2><pre class="codeinput">clear <span class="string">all</span>
nElements = 5; <span class="comment">% number of beam elements</span>
kappa = 4; <span class="comment">% cubic spring coefficient</span>
gamma = 0; <span class="comment">% cubic damping coefficient</span>
[M,C,K,fnl,~] = build_model(kappa, gamma, nElements);
n = length(M);
</pre><h2 id="2">Dynamical system setup</h2><p>We consider the forced system</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{M}\cdot\mathbf{1}(\Omega^2\cos{\Omega}t),$$" src="BernoulliBeamBaseDoc_eq08153807618546882016-Rescaled.png" style="width: 267.59999999999997px; height: auto;"/></span><script type="math/tex">\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{M}\cdot\mathbf{1}(\Omega^2\cos{\Omega}t),</script></p><p>In our code, the dynamical system is represented by the system matrices and an implementation of the nonlinear internal forces.</p><pre class="codeinput">DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,<span class="string">'M'</span>,M,<span class="string">'C'</span>,C,<span class="string">'K'</span>,K,<span class="string">'fnl'</span>,fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'Emax'</span>,5,<span class="string">'Nmax'</span>,10,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'BaseExcitation'</span>,true); <span class="comment">% Frequency dependent forcing amplitude</span>
</pre><p>We assume periodic forcing of the form</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{f}^{ext}(\phi) = \mathbf{M}\cdot\mathbf{1}(\Omega^2\cos{\Omega}t)=\frac{\mathbf{f}_0}{2}e^{i\phi}
+ \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$" src="BernoulliBeamBaseDoc_eq02884143179458791108-Rescaled.png" style="width: 246.0px; height: auto;"/></span><script type="math/tex">\mathbf{f}^{ext}(\phi) = \mathbf{M}\cdot\mathbf{1}(\Omega^2\cos{\Omega}t)=\frac{\mathbf{f}_0}{2}e^{i\phi}
+ \frac{\mathbf{f}_0}{2}e^{-i\phi}  </script></p><p>where <span class="MathJax_Preview"><img alt="$\mathbf{f}_0 =  \mathbf{M}\cdot\mathbf{1}$" src="BernoulliBeamBaseDoc_eq05980893518705669313-Rescaled.png" style="width: 58.8px; height: auto;"/></span><script type="math/tex">\mathbf{f}_0 =  \mathbf{M}\cdot\mathbf{1}</script>.</p><pre class="codeinput">epsilon = 5e-5;
f_0 = M*ones(n,1);
</pre><p>The Fourier coefficients of the forcing and the forcing amplitude need to be passed to the dynamical system.</p><pre class="codeinput">kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
</pre><h2 id="5">Linear Modal analysis and SSM setup</h2><p>Now the reduced spectral content linear part of the dynamicals system is analysed. For this a set number (see DSOptions) of modes is computed.</p><pre class="codeinput">[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
</pre>
<pre class="codeoutput">Due to high-dimensionality, we compute only the first 5 eigenvalues with the smallest magnitude. These would also be used to compute the spectral quotients
  Assuming a proportional damping hypthesis with symmetric matrices
  modal damping ratio for 1 mode is 8.840017e-04
  modal damping ratio for 2 mode is 5.488086e-03
  modal damping ratio for 3 mode is 1.541080e-02
  modal damping ratio for 4 mode is 3.044305e-02
  modal damping ratio for 5 mode is 5.052761e-02
  
   The first 10 nonzero eigenvalues are given as 
     1.0e+02 *
  
    -0.0001 + 0.0700i
    -0.0001 - 0.0700i
    -0.0024 + 0.4389i
    -0.0024 - 0.4389i
    -0.0190 + 1.2327i
    -0.0190 - 1.2327i
    -0.0741 + 2.4343i
    -0.0741 - 2.4343i
    -0.2042 + 4.0370i
    -0.2042 - 4.0370i
  
  </pre>
<p><b>Choose Master subspace (perform resonance analysis)</b></p><p>Next the spectral subspace over which the invariant SSM is to be constructed is chosen. The notation in which the SSM is to be computed is set to the multi-index notation. Relative tolerances are triggered at a relative modal distance of 0.1 (see DSOptions), which allows us to get an overview of how separated the modes are prior to computing the SSM. The spectral subspace consisting of the primary mode-pair is chosen as a base for the invariant manifold.</p><pre class="codeinput">S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 0.1,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
masterModes = [1,2];
S.<a href="../../../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
</pre>
<pre class="codeoutput">The master subspace contains the following eigenvalues
 
  lambda1 == - 0.0061885 + 7.0006i
   
  lambda2 == (-0.0061885) - 7.0006i
   
  No (near) outer resonances detected in the (truncated) spectrum
  sigma_out = 3300
  (near) inner resonance detected for the following combination of master eigenvalues:
   
  2*lambda1 + 1*lambda2 == lambda1
   
  3*lambda1 + 2*lambda2 == lambda1
   
  4*lambda1 + 3*lambda2 == lambda1
   
  5*lambda1 + 4*lambda2 == lambda1
   
  1*lambda1 + 2*lambda2 == lambda2
   
  2*lambda1 + 3*lambda2 == lambda2
   
  3*lambda1 + 4*lambda2 == lambda2
   
  4*lambda1 + 5*lambda2 == lambda2
   
  sigma_in = 3300
  </pre>
<h2 id="7">Forced response curves using SSMs</h2><p>Obtaining <b>forced response curve</b> in reduced-polar coordinate</p><p>Now we setup the SSM computation, to compute the forced response of the beam, if driven in resonance with the first mode.</p><p>The SSM is to be computed up to order 3 and 5, to monitor the convergence of the parametrisation and reduced dynamics expansions. We wish to display the resulting FRCs along the output DOFs at the tip of the beam and set the corresponding parameters accordingly.</p><pre class="codeinput">order = [3,5];      <span class="comment">% SSM approximation order</span>
outdof = [n-2 n-1]; <span class="comment">% degree of freedom at which output is displayed</span>
</pre><p>Now we setup the options for the computation of the SSM. For the computation of the FRC we choose the level set method. The steady states are therefore computed directly from the polar ODE of the reduced dynamics (see <a href="FRC">computation</a>).</p><pre class="codeinput">set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">'level set'</span>)
</pre><p>We set the relative tolerance for internal resonances and choose to include nonautonomous contributions to the invariant manifold and reduced dynamics. For the mesh over which the polar ODE is evaluated to find fixedpoints we choose a 200 by 100 grid in the polar coordinates. The number of frequencies on which the ODE should be evaluated is set to 100. The parameter rhoScale is used to scale the amplituderange in which the reduced system response is to be analysed.</p><pre class="codeinput">set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 1,<span class="string">'IRtol'</span>,0.02,<span class="string">'contribNonAuto'</span>,true)
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'nRho'</span>, 200,  <span class="string">'nPsi'</span>, 100, <span class="string">'nPar'</span>, 100,<span class="string">'rhoScale'</span>, 2 )
</pre><p>We now choose the frequency range over which the FRC is to be computed.</p><pre class="codeinput">omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.98 1.05];
</pre><p>Finally extract forced response curve via a computation of the SSM and the reduced dynamics on it.</p><pre class="codeinput">FRC = S.<a href="../../../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>(<span class="string">'freq'</span>,omegaRange,order);
</pre>
<pre class="codeoutput">*****************************************
  Calculating FRC using SSM with master subspace: [1  2]
  The master subspace contains the following eigenvalues
   
  lambda1 == - 0.0061885 + 7.0006i
   
  lambda2 == (-0.0061885) - 7.0006i
   
  (near) outer resonance detected for the following combinations of master eigenvalues
   They are in resonance with the following eigenvalues of the slave subspace 
   
  6*lambda1 + 0*lambda2 == - 0.24089 + 43.8926i
   
  7*lambda1 + 0*lambda2 == - 0.24089 + 43.8926i
   
  7*lambda1 + 1*lambda2 == - 0.24089 + 43.8926i
   
  8*lambda1 + 1*lambda2 == - 0.24089 + 43.8926i
   
  8*lambda1 + 2*lambda2 == - 0.24089 + 43.8926i
   
  0*lambda1 + 6*lambda2 == (-0.24089) - 43.8926i
   
  0*lambda1 + 7*lambda2 == (-0.24089) - 43.8926i
   
  1*lambda1 + 7*lambda2 == (-0.24089) - 43.8926i
   
  1*lambda1 + 8*lambda2 == (-0.24089) - 43.8926i
   
  2*lambda1 + 8*lambda2 == (-0.24089) - 43.8926i
   
  sigma_out = 3300
  (near) inner resonance detected for the following combination of master eigenvalues:
   
  2*lambda1 + 1*lambda2 == lambda1
   
  3*lambda1 + 2*lambda2 == lambda1
   
  4*lambda1 + 3*lambda2 == lambda1
   
  5*lambda1 + 4*lambda2 == lambda1
   
  1*lambda1 + 2*lambda2 == lambda2
   
  2*lambda1 + 3*lambda2 == lambda2
   
  3*lambda1 + 4*lambda2 == lambda2
   
  4*lambda1 + 5*lambda2 == lambda2
   
  sigma_in = 3300
  Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
  Attempting manifold computation
  Manifold computation time at order 2 = 00:00:00
  Estimated memory usage at order  2 = 1.62E-02 MB
  Manifold computation time at order 3 = 00:00:00
  Estimated memory usage at order  3 = 2.51E-02 MB
  Manifold computation time at order 4 = 00:00:00
  Estimated memory usage at order  4 = 3.17E-02 MB
  Manifold computation time at order 5 = 00:00:00
  Estimated memory usage at order  5 = 4.76E-02 MB
  gamma = 
     1.0e+02 *
  
    -0.0000 + 0.5938i
    -0.0030 - 8.1936i
   
  Total time spent on FRC computation upto O(3) = 00:00:06
  Total time spent on FRC computation upto O(5) = 00:00:12
  </pre><img alt="" hspace="5" src="LevelSet.png" vspace="5"/>
<p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2021a</a><br/></p></div><!--
##### SOURCE BEGIN #####
%% Euler Bernoulli beam with cubic spring and damper
% In this notebook, we consider the forced response curve of a Euler Bernoulli 
% beam with cubic spring and damper at the free end, subject to a harmonic base 
% excitation. In the frame attached to the oscillating base, the beam is subject 
% to harmonic excitation in the form $m\Omega^2\cos\Omega t$, where $\Omega$ is 
% the excitation frequency.
%% Generate model

clear all
nElements = 5; % number of beam elements
kappa = 4; % cubic spring coefficient
gamma = 0; % cubic damping coefficient
[M,C,K,fnl,~] = build_model(kappa, gamma, nElements);
n = length(M);
%% Dynamical system setup 
% We consider the forced system
% 
% $$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{M}\cdot\mathbf{1}(\Omega^2\cos{\Omega}t),$$
%
% In our code, the dynamical system is represented by the system matrices
% and an implementation of the nonlinear internal forces.
%

DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,'M',M,'C',C,'K',K,'fnl',fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','multiindex');
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'BaseExcitation',true); % Frequency dependent forcing amplitude
%% 
% We assume periodic forcing of the form
% 
% $$\mathbf{f}^{ext}(\phi) = \mathbf{M}\cdot\mathbf{1}(\Omega^2\cos{\Omega}t)=\frac{\mathbf{f}_0}{2}e^{i\phi} 
% + \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$
%
% where $\mathbf{f}_0 =  \mathbf{M}\cdot\mathbf{1}$.
%

epsilon = 5e-5;
f_0 = M*ones(n,1);
%% 
%
% The Fourier coefficients of the forcing and the forcing amplitude need to
% be passed to the dynamical system.
%

kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
%% Linear Modal analysis and SSM setup
%
% Now the reduced spectral content linear part of the dynamicals system is
% analysed. For this a set number (see DSOptions) of modes is computed. 
%

[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
%% 
%
% *Choose Master subspace (perform resonance analysis)*
%
% Next the spectral subspace over which the invariant SSM is to be
% constructed is chosen. The notation in which the SSM is to be computed is
% set to the multi-index notation. Relative tolerances are triggered at a
% relative modal distance of 0.1 (see DSOptions), which allows us to get an overview of how separated the modes are prior to computing the SSM.
% The spectral subspace consisting of the primary mode-pair is chosen as a base for the invariant
% manifold.
%


S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.1,'notation','multiindex')
masterModes = [1,2]; 
S.<a href="../../../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
%% Forced response curves using SSMs
%
% Obtaining *forced response curve* in reduced-polar coordinate
%
% Now we setup the SSM computation, to compute the forced response of the
% beam, if driven in resonance with the first mode.
%
% The SSM is to be computed up to order 3 and 5, to monitor the convergence
% of the parametrisation and reduced dynamics expansions. We wish to
% display the resulting FRCs along the output DOFs at the tip of the beam
% and set the corresponding parameters accordingly.

order = [3,5];      % SSM approximation order
outdof = [n-2 n-1]; % degree of freedom at which output is displayed
%% 
% Now we setup the options for the computation of the SSM. For the
% computation of the FRC we choose the level set method. The steady states
% are therefore computed directly from the polar ODE of the reduced
% dynamics (see <FRC computation>).
%

set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'method','level set')  

%%
%
% We set the relative tolerance for internal resonances and choose to include nonautonomous 
% contributions to the invariant manifold and reduced dynamics. For the
% mesh over which the polar ODE is evaluated to find fixedpoints we choose
% a 200 by 100 grid in the polar coordinates. The number of frequencies on which the ODE should be 
% evaluated is set to 100. The parameter rhoScale is used to scale the
% amplituderange in which the reduced system response is to be analysed.
%

set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 1,'IRtol',0.02,'contribNonAuto',true)
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'nRho', 200,  'nPsi', 100, 'nPar', 100,'rhoScale', 2 )

%% 
% We now choose the frequency range over which the FRC is to be computed.
%

omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.98 1.05];
%% 
% Finally extract forced response curve via a computation of the SSM and
% the reduced dynamics on it.

FRC = S.<a href="../../../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>('freq',omegaRange,order);
##### SOURCE END #####
--></body></head></html></body></html></html>