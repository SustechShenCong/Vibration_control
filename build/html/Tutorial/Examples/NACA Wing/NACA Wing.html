
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><html><body><div class="banner"><a href="../../../index.html"><img alt="Logo" class="logo" src="../../../logo.png" style="float:right" width="200"/></a></div><html><head><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>NACAWing</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-08-29" name="DC.date"/><meta content="NACAWing.m" name="DC.source"/><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">NACA airfoil wing model</a></li><li><a href="#3">Generate model</a></li><li><a href="#4">Dynamical system setup</a></li><li><a href="#6">Linear Modal analysis and SSM setup</a></li><li><a href="#8">Forced response curves using SSMs</a></li></ul></div><h2 id="1">NACA airfoil wing model</h2><p>Finite element model from the following reference:</p><p>Jain, S., Tiso, P., Rutzmoser, J. B., &amp; Rixen, D. J. (2017). A quadratic manifold for model order reduction of nonlinear structural dynamics. <i>Computers &amp; Structures</i>, <i>188</i>, 80â€“94. <a href="https://doi.org/10.1016/J.COMPSTRUC.2017.04.005">https://doi.org/10.1016/J.COMPSTRUC.2017.04.005</a>;
  <img alt="" hspace="5" src="model.png" style="width:45%" vspace="5"/>
</p><p>Finite element code taken from the following package:</p><p>Jain, S., Marconi, J., Tiso P. (2020). YetAnotherFEcode (Version v1.1). Zenodo. <a href="http://doi.org/10.5281/zenodo.4011282">http://doi.org/10.5281/zenodo.4011282</a></p><pre class="codeinput">clear <span class="string">all</span>; close <span class="string">all</span>; clc
run <span class="string">../../install.m</span>
<span class="comment">% change to example directory</span>
exampleDir = fileparts(mfilename(<span class="string">'fullpath'</span>));
cd(exampleDir)
</pre><p><b>System parameters</b></p><pre class="codeinput">epsilon = 1;
</pre><h2 id="3">Generate model</h2><pre class="codeinput">[M,C,K,fnl,f_0,outdof] = build_model();
n = length(M);
disp([<span class="string">'Number of degrees of freedom = '</span> num2str(n)])
disp([<span class="string">'Phase space dimensionality = '</span> num2str(2*n)])
</pre><pre class="codeoutput">Reading mesh from Wing.msh
Building FE model
Assembling M,C,K matrices
Applying boundary conditions
Solving undamped eigenvalue problem
Using Rayleigh damping
Assembling external force vector
Getting nonlinearity coefficients
Loaded tensors from storage
Total time spent on model assembly = 01:20:42
Number of degrees of freedom = 133920
Phase space dimensionality = 267840
</pre><img alt="" src="NACAWing_01.png" style="width:50%;"/> <h2 id="4">Dynamical system setup</h2><p>We consider the forced system</p><p><img alt="$$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{f}^{ext}(\mathbf{\Omega}t),$$" src="NACAWing_eq14364002725894292759-Rescaled.png" style="width: 219.6px; height: auto;"/></p><p>which can be written in the first-order form as</p><p><img alt="$$\mathbf{B}\dot{\mathbf{z}}=\mathbf{Az}+\mathbf{F}(\mathbf{z})+\epsilon\mathbf{F}^{ext}(\mathbf{\phi})$$" src="NACAWing_eq13805302309640541471-Rescaled.png" style="width: 158.4px; height: auto;"/></p><p><img alt="$$\dot{\mathbf{\phi}}=\mathbf{\Omega}$$" src="NACAWing_eq16619053923308180078-Rescaled.png" style="width: 36.0px; height: auto;"/></p><p>where</p><p><img alt="$\mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} &amp; \mathbf{0}\\\mathbf{0} &amp; \mathbf{M}\end{array}\right],\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} &amp; \mathbf{M}\\\mathbf{M} &amp; \mathbf{0}\end{array}\right],\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}\mathbf{-\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})}\\\mathbf{0}\end{array}\right],\quad\mathbf{F}^{ext}(\mathbf{z},\mathbf{\phi})=\left[\begin{array}{c}\mathbf{f}^{ext}(\mathbf{\phi})\\\mathbf{0}\end{array}\right]$" src="NACAWing_eq02065934477452524807-Rescaled.png" style="width: 602.4px; height: auto;"/>.</p><pre class="codeinput">DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,<span class="string">'M'</span>,M,<span class="string">'C'</span>,C,<span class="string">'K'</span>,K,<span class="string">'fnl'</span>,fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,<span class="string">'Emax'</span>,5,<span class="string">'Nmax'</span>,10,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
<span class="comment">% set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','tensor')</span>
</pre><p>We assume periodic forcing of the form</p><p><img alt="$$\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi}
+ \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$" src="NACAWing_eq05163577920011297423-Rescaled.png" style="width: 201.6px; height: auto;"/></p><p>Fourier coefficients of Forcing</p><pre class="codeinput">kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
</pre><h2 id="6">Linear Modal analysis and SSM setup</h2><pre class="codeinput">[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
</pre><pre class="codeoutput">Due to high-dimensionality, we compute only the first 5 eigenvalues with the smallest magnitude. These would also be used to compute the spectral quotients
Assuming a proportional damping hypthesis with symmetric matrices
modal damping ratio for 1 mode is 2.000000e-03
modal damping ratio for 2 mode is 2.000000e-03
modal damping ratio for 3 mode is 2.264041e-03
modal damping ratio for 4 mode is 3.612822e-03
modal damping ratio for 5 mode is 5.538531e-03
the left eigenvectors may be incorrect in case of asymmetry of matrices

 The first 10 nonzero eigenvalues are given as 
   1.0e+02 *

  -0.0006 + 0.2934i
  -0.0006 - 0.2934i
  -0.0030 + 1.5226i
  -0.0030 - 1.5226i
  -0.0041 + 1.8088i
  -0.0041 - 1.8088i
  -0.0113 + 3.1381i
  -0.0113 - 3.1381i
  -0.0274 + 4.9385i
  -0.0274 - 4.9385i

</pre><p><b>Choose Master subspace (perform resonance analysis)</b></p><pre class="codeinput">S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 0.1,<span class="string">'notation'</span>,<span class="string">'multiindex'</span>)
<span class="comment">% set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.1,'notation','tensor')</span>
masterModes = [1,2];
S.<a href="../../../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
</pre><pre class="codeoutput">No (near) outer resonances detected in the (truncated) spectrum
sigma_out = 46
(near) inner resonance detected for the following combination of master eigenvalues
     2     1
     3     2
     4     3
     5     4
     1     2
     2     3
     3     4
     4     5

These are in resonance with the follwing eigenvalues of the master subspace
  -0.0587 +29.3428i
  -0.0587 +29.3428i
  -0.0587 +29.3428i
  -0.0587 +29.3428i
  -0.0587 -29.3428i
  -0.0587 -29.3428i
  -0.0587 -29.3428i
  -0.0587 -29.3428i

sigma_in = 46
</pre><h2 id="8">Forced response curves using SSMs</h2><p>Obtaining <b>forced response curve</b> in reduced-polar coordinate</p><pre class="codeinput">order = 3; <span class="comment">% Approximation order</span>
</pre><p>setup options</p><pre class="codeinput">set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, <span class="string">'reltol'</span>, 1,<span class="string">'IRtol'</span>,0.02,<span class="string">'notation'</span>, <span class="string">'multiindex'</span>,<span class="string">'contribNonAuto'</span>,false)
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'nt'</span>, 2^7, <span class="string">'nRho'</span>, 200, <span class="string">'nPar'</span>, 200, <span class="string">'nPsi'</span>, 100, <span class="string">'rhoScale'</span>, 2 )
<span class="comment">% set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'method','level set')</span>
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'method'</span>,<span class="string">'continuation ep'</span>, <span class="string">'z0'</span>, 1e-4*[1; 1])
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, <span class="string">'outdof'</span>,outdof)
</pre><p>choose frequency range around the first natural frequency</p><pre class="codeinput">omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.9 1.1];
</pre><p>extract forced response curve</p><pre class="codeinput">FRC = S.<a href="../../../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>(<span class="string">'freq'</span>,omegaRange,order);
figFRC = gcf;
</pre><pre class="codeoutput">*****************************************
Calculating FRC using SSM with master subspace: [1  2]
(near) outer resonance detected for the following combination of master eigenvalues
     5     0
     6     0
     6     1
     7     1
     7     2
     8     2
     0     5
     0     6
     1     6
     1     7
     2     7
     2     8
     6     0
     7     0
     7     1
     8     1
     8     2
     0     6
     0     7
     1     7
     1     8
     2     8
    10     0
     0    10

These are in resonance with the follwing eigenvalues of the slave subspace
   1.0e+02 *

  -0.0030 + 1.5226i
  -0.0030 + 1.5226i
  -0.0030 + 1.5226i
  -0.0030 + 1.5226i
  -0.0030 + 1.5226i
  -0.0030 + 1.5226i
  -0.0030 - 1.5226i
  -0.0030 - 1.5226i
  -0.0030 - 1.5226i
  -0.0030 - 1.5226i
  -0.0030 - 1.5226i
  -0.0030 - 1.5226i
  -0.0041 + 1.8088i
  -0.0041 + 1.8088i
  -0.0041 + 1.8088i
  -0.0041 + 1.8088i
  -0.0041 + 1.8088i
  -0.0041 - 1.8088i
  -0.0041 - 1.8088i
  -0.0041 - 1.8088i
  -0.0041 - 1.8088i
  -0.0041 - 1.8088i
  -0.0113 + 3.1381i
  -0.0113 - 3.1381i

sigma_out = 46
(near) inner resonance detected for the following combination of master eigenvalues
     2     1
     3     2
     4     3
     5     4
     1     2
     2     3
     3     4
     4     5

These are in resonance with the follwing eigenvalues of the master subspace
  -0.0587 +29.3428i
  -0.0587 +29.3428i
  -0.0587 +29.3428i
  -0.0587 +29.3428i
  -0.0587 -29.3428i
  -0.0587 -29.3428i
  -0.0587 -29.3428i
  -0.0587 -29.3428i

sigma_in = 46
Due to (near) outer resonance, the exisitence of the manifold is questionable and the underlying computation may suffer.
Attempting manifold computation
Manifold computation time at order 2 = 00:00:55
Estimated memory usage at order  2 = 1.34E+03 MB
Manifold computation time at order 3 = 00:01:25
Estimated memory usage at order  3 = 1.41E+03 MB

 Run='freqSubint1.ep': Continue equilibria along primary branch.

    STEP   DAMPING               NORMS              COMPUTATION TIMES
  IT SIT     GAMMA     ||d||     ||f||     ||U||   F(x)  DF(x)  SOLVE
   0                          2.20e-02  4.17e+01    0.0    0.0    0.0
   1   1  1.00e+00  9.81e-02  1.11e-04  4.17e+01    0.0    0.0    0.0
   2   1  1.00e+00  1.11e-03  5.03e-08  4.17e+01    0.0    0.0    0.0
   3   1  1.00e+00  1.76e-07  8.94e-16  4.17e+01    0.0    0.0    0.0

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   4.1699e+01      1  EP      2.9343e+01   7.5891e-01   2.7048e+00   1.0000e+00
   10  00:00:00   4.0892e+01      2          2.8745e+01   1.7384e-01   3.0448e+00   1.0000e+00
   20  00:00:00   3.7621e+01      3  EP      2.6409e+01   3.5977e-02   3.1216e+00   1.0000e+00

 STEP      TIME        ||U||  LABEL  TYPE            om         rho1          th1          eps
    0  00:00:00   4.1699e+01      4  EP      2.9343e+01   7.5891e-01   2.7048e+00   1.0000e+00
   10  00:00:00   4.2598e+01      5          3.0015e+01   1.7602e+00   1.6752e+00   1.0000e+00
   14  00:00:01   4.2608e+01      6  SN      3.0030e+01   1.7677e+00   1.5257e+00   1.0000e+00
   14  00:00:01   4.2608e+01      7  FP      3.0030e+01   1.7677e+00   1.5257e+00   1.0000e+00
   20  00:00:01   4.2526e+01      8          2.9988e+01   1.6911e+00   1.2674e+00   1.0000e+00
   30  00:00:01   4.1867e+01      9  FP      2.9587e+01   6.3674e-01   3.6253e-01   1.0000e+00
   30  00:00:01   4.1867e+01     10  SN      2.9587e+01   6.3669e-01   3.6250e-01   1.0000e+00
   30  00:00:01   4.1867e+01     11          2.9587e+01   6.3417e-01   3.6099e-01   1.0000e+00
   40  00:00:01   4.2110e+01     12          2.9766e+01   2.5553e-01   1.4254e-01   1.0000e+00
   50  00:00:01   4.3589e+01     13          3.0814e+01   7.1783e-02   3.9905e-02   1.0000e+00
   55  00:00:01   4.5658e+01     14  EP      3.2277e+01   3.5984e-02   1.9999e-02   1.0000e+00
Total time spent on FRC computation upto O(3) = 00:03:24
</pre><img alt="" hspace="5" src="NACAWing_02.png" vspace="5"/> <img alt="" hspace="5" src="NACAWing_03.png" vspace="5"/> <p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2023a</a><br/></p></div><!--
##### SOURCE BEGIN #####
%% NACA airfoil wing model
% Finite element model from the following reference:
% 
% Jain, S., Tiso, P., Rutzmoser, J. B., & Rixen, D. J. (2017). A quadratic manifold 
% for model order reduction of nonlinear structural dynamics. _Computers & Structures_, 
% _188_, 80Â–94. <https://doi.org/10.1016/J.COMPSTRUC.2017.04.005 https://doi.org/10.1016/J.COMPSTRUC.2017.04.005>
% 
% 
% 
% Finite element code taken from the following package:
% 
% Jain, S., Marconi, J., Tiso P. (2020). YetAnotherFEcode (Version v1.1). Zenodo. 
% <http://doi.org/10.5281/zenodo.4011282 http://doi.org/10.5281/zenodo.4011282>

clear all; close all; clc
run ../../install.m
% change to example directory
exampleDir = fileparts(mfilename('fullpath'));
cd(exampleDir)
%% 
% *system parameters*

epsilon = 1;
%% generate model

[M,C,K,fnl,f_0,outdof] = build_model();
n = length(M);
disp(['Number of degrees of freedom = ' num2str(n)])
disp(['Phase space dimensionality = ' num2str(2*n)])
%% Dynamical system setup 
% We consider the forced system
% 
% $$\mathbf{M}\ddot{\mathbf{x}}+\mathbf{C}\dot{\mathbf{x}}+\mathbf{K}\mathbf{x}+\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})=\epsilon\mathbf{f}^{ext}(\mathbf{\Omega}t),$$
% 
% which can be written in the first-order form as 
% 
% $$\mathbf{B}\dot{\mathbf{z}}	=\mathbf{Az}+\mathbf{F}(\mathbf{z})+\epsilon\mathbf{F}^{ext}(\mathbf{\phi}),\\\dot{\mathbf{\phi}}	
% =\mathbf{\Omega}$$
% 
% where
% 
% $\mathbf{z}=\left[\begin{array}{c}\mathbf{x}\\\dot{\mathbf{x}}\end{array}\right],\quad\mathbf{A}=\left[\begin{array}{cc}-\mathbf{K} 
% & \mathbf{0}\\\mathbf{0} & \mathbf{M}\end{array}\right],\mathbf{B}=\left[\begin{array}{cc}\mathbf{C} 
% & \mathbf{M}\\\mathbf{M} & \mathbf{0}\end{array}\right],\quad\quad\mathbf{F}(\mathbf{z})=\left[\begin{array}{c}\mathbf{-\mathbf{f}(\mathbf{x},\dot{\mathbf{x}})}\\\mathbf{0}\end{array}\right],\quad\mathbf{F}^{ext}(\mathbf{z},\mathbf{\phi})=\left[\begin{array}{c}\mathbf{f}^{ext}(\mathbf{\phi})\\\mathbf{0}\end{array}\right]$.

DS = <a href="../../../Library/DynamicalSystem/DynamicalSystem.html">DynamicalSystem</a>();
set(DS,'M',M,'C',C,'K',K,'fnl',fnl);
set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','multiindex')
% set(DS.<a href="../../../Library/Features/Options/Options.html">Options</a>,'Emax',5,'Nmax',10,'notation','tensor')
%% 
% We assume periodic forcing of the form
% 
% $$\mathbf{f}^{ext}(\phi) = \mathbf{f}_0\cos(\phi)=\frac{\mathbf{f}_0}{2}e^{i\phi} 
% + \frac{\mathbf{f}_0}{2}e^{-i\phi}  $$
% 
% Fourier coefficients of Forcing

kappas = [-1; 1];
coeffs = [f_0 f_0]/2;
DS.<a href="../../../Library/DynamicalSystem/add_forcing.html">add_forcing</a>(coeffs, kappas,epsilon);
%% Linear Modal analysis and SSM setup

[V,D,W] = DS.<a href="../../../Library/DynamicalSystem/linear_spectral_analysis.html">linear_spectral_analysis</a>();
%% 
% *Choose Master subspace (perform resonance analysis)*

S = <a href="../../../Library/SSM/SSM.html">SSM</a>(DS);
set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.1,'notation','multiindex')
% set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 0.1,'notation','tensor')
masterModes = [1,2]; 
S.<a href="../../../Library/Manifold/choose_E.html">choose_E</a>(masterModes);
%% Forced response curves using SSMs
% Obtaining *forced response curve* in reduced-polar coordinate

order = 3; % Approximation order
%% 
% setup options

set(S.<a href="../../../Library/Features/Options/Options.html">Options</a>, 'reltol', 1,'IRtol',0.02,'notation', 'multiindex','contribNonAuto',false)
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'nt', 2^7, 'nRho', 200, 'nPar', 200, 'nPsi', 100, 'rhoScale', 2 )
% set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'method','level set')
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'method','continuation ep', 'z0', 1e-4*[1; 1])
set(S.<a href="../../../Library/Features/Options/FRCOptions.html">FRCOptions</a>, 'outdof',outdof)
%% 
% choose frequency range around the first natural frequency

omega0 = imag(S.E.spectrum(1));
omegaRange = omega0*[0.9 1.1];
%% 
% extract forced response curve

FRC = S.<a href="../../../Library/Features/Wrappers/cocoWrapper/extract_FRC.html">extract_FRC</a>('freq',omegaRange,order);
figFRC = gcf;
##### SOURCE END #####
--></body></head></html></body></html></html>