
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../index.html"><img alt="Logo" class="logo" src="../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>An introduction to the computation of Spectral Submanifolds</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-07" name="DC.date"/><meta content="SSM_Computation.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>An introduction to the computation of Spectral Submanifolds</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">First order mechanical systems</a></li><li><a href="#2">Second order mechanical systems</a></li><li><a href="#3">Parametrisation of SSM and reduced dynamics</a></li><li><a href="#4">Existence and computation of SSMs</a></li><li><a href="#6">Computation of the autonomous SSM</a></li><li><a href="#8">Computation of the non-autonomous SSM</a></li></ul></div><h2 id="1">First order mechanical systems</h2><p>We consider dynamical systems of the form</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{B\dot{z} = Az + F(z,\mu}) + \epsilon \mathbf{ G}(\mathbf\Omega t,
\mathbf{z}) \quad,\mathbf{z} \in \mathbf{R}^N, \mathbf{\mu} \in \mathbf{R}^p,
\ 0\leq\epsilon \ll 1$$" src="SSM_Computation_eq07107434261766859090-Rescaled.png" style="width: 357.59999999999997px; height: auto;"/></span><script type="math/tex">\mathbf{B\dot{z} = Az + F(z,\mu}) + \epsilon \mathbf{ G}(\mathbf\Omega t,
\mathbf{z}) \quad,\mathbf{z} \in \mathbf{R}^N, \mathbf{\mu} \in \mathbf{R}^p,
\ 0\leq\epsilon \ll 1</script></p><p>Any first order ODE with smooth right hand side can be brought to this standard form around its fixed points. After an initial translation to set a fixed point to the origin of the coordinate system, the right hand side can be expanded as a Taylor series which yields the desired form. Here  <span class="MathJax_Preview"><img alt="$\mathbf{A} \in \mathbf{R}^{N \times N}$" src="SSM_Computation_eq14823164750686648913-Rescaled.png" style="width: 63.599999999999994px; height: auto;"/></span><script type="math/tex">\mathbf{A} \in \mathbf{R}^{N \times N}</script> is the linear part of the dynamical system. Throughout the dynamical systems literature the matrix <span class="MathJax_Preview"><img alt="$\mathbf{B} \in \mathbf{R}^{N \times N}$" src="SSM_Computation_eq00481553529223358908-Rescaled.png" style="width: 62.4px; height: auto;"/></span><script type="math/tex">\mathbf{B} \in \mathbf{R}^{N \times N}</script> is often taken to be the identity. We do not make this assumption and treat the general case, which leads to computational advantages for dynamical systems that stem from second order ODEs as the inversion of possibly large system matrices can be avoided this way. <span class="MathJax_Preview"><img alt="$\mathbf{F}$" src="SSM_Computation_eq03148538246847756930-Rescaled.png" style="width: 9.6px; height: auto;"/></span><script type="math/tex">\mathbf{F}</script> is a vector valued nonlinear function and assumed to be <span class="MathJax_Preview"><img alt="$r$" src="SSM_Computation_eq03659017738081218615-Rescaled.png" style="width: 6.0px; height: auto;"/></span><script type="math/tex">r</script>-times continuously differentiable in <span class="MathJax_Preview"><img alt="$\mathbf{z}$" src="SSM_Computation_eq00281933231697481193-Rescaled.png" style="width: 7.199999999999999px; height: auto;"/></span><script type="math/tex">\mathbf{z}</script> and a set of parameters <span class="MathJax_Preview"><img alt="$\mathbf{\mu}$" src="SSM_Computation_eq17263633842353619006-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\mathbf{\mu}</script>. <span class="MathJax_Preview"><img alt="$\mathbf{G}$" src="SSM_Computation_eq06760590799423181100-Rescaled.png" style="width: 10.799999999999999px; height: auto;"/></span><script type="math/tex">\mathbf{G}</script> is a non-autonomous and possibly non-linear function which contains the time-dependent forcing that is acting on the system.</p><h2 id="2">Second order mechanical systems</h2><p>Invariant manifolds such as SSMs can also be computed in the phase space of second order mechanical systems. These look as follows</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{M\ddot{x} + C}\mathbf{\dot{x} + Kx + \mathbf{f}(x,\dot{x},\mu)}
= \epsilon \mathbf{g}(\mathbf\Omega t,\mathbf{x},\mathbf{\dot{x}}), \ 0\leq\epsilon
\ll 1$$" src="SSM_Computation_eq12691503297799114949-Rescaled.png" style="width: 313.2px; height: auto;"/></span><script type="math/tex">\mathbf{M\ddot{x} + C}\mathbf{\dot{x} + Kx + \mathbf{f}(x,\dot{x},\mu)}
= \epsilon \mathbf{g}(\mathbf\Omega t,\mathbf{x},\mathbf{\dot{x}}), \ 0\leq\epsilon
\ll 1</script></p><p>The linear part of the system is characterised by <span class="MathJax_Preview"><img alt="$\mathbf{M}, \mathbf{C}, \mathbf{K} \in \mathbf{R}^{n\times n}$" src="SSM_Computation_eq06234745571549535401-Rescaled.png" style="width: 94.8px; height: auto;"/></span><script type="math/tex">\mathbf{M}, \mathbf{C}, \mathbf{K} \in \mathbf{R}^{n\times n}</script> which denote the mass, damping and stiffness matrices, respectively. The function <span class="MathJax_Preview"><img alt="$\mathbf{f}(\mathbf{y},\mathbf{\dot{y}}, \mathbf{\mu})$" src="SSM_Computation_eq01910714316013537447-Rescaled.png" style="width: 51.6px; height: auto;"/></span><script type="math/tex">\mathbf{f}(\mathbf{y},\mathbf{\dot{y}}, \mathbf{\mu})</script> is a nonlinear function that is <span class="MathJax_Preview"><img alt="$r$" src="SSM_Computation_eq03659017738081218615-Rescaled.png" style="width: 6.0px; height: auto;"/></span><script type="math/tex">r</script> times continuously differentiable with <span class="MathJax_Preview"><img alt="$r\ge 1$" src="SSM_Computation_eq04657096346285497539-Rescaled.png" style="width: 30.0px; height: auto;"/></span><script type="math/tex">r\ge 1</script>.The distinct types of time-dependent forces are represented by general forcing vector <span class="MathJax_Preview"><img alt="$\mathbf{g}$" src="SSM_Computation_eq08081079891865937472-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\mathbf{g}</script>. The second order form can be rewritten to the first order form, for instance by choosing</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{z} =  \left[ \begin{array}{c} \mathbf{x}  \\ \dot{\mathbf{x}} \end{array}
\right], \quad  \mathbf{A} =  \left[ \begin{array}{c} -\mathbf{K} \quad \mathbf{0}
\\ \mathbf{0} \quad \mathbf{M} \end{array} \right], \quad \mathbf{B} =  \left[ \begin{array}{c}
\mathbf{C} \quad \mathbf{M} \\ \mathbf{M} \quad \mathbf{0} \end{array} \right], \quad
\mathbf{ F(z)} =  \left[ \begin{array}{c}- \mathbf{f(x,\dot{x})} \\ \mathbf{0}
\end{array} \right],  \quad  \mathbf{ G}(\mathbf\Omega t, \mathbf{z}) =  \left[
\begin{array} {c} \mathbf{g}(\mathbf\Omega t,\mathbf{x},\mathbf{\dot{x}}) \\
\mathbf{0}\end{array}\right]$$" src="SSM_Computation_eq06462748947804439120-Rescaled.png" style="width: 612.0px; height: auto;"/></span><script type="math/tex">\mathbf{z} =  \left[ \begin{array}{c} \mathbf{x}  \\ \dot{\mathbf{x}} \end{array}
\right], \quad  \mathbf{A} =  \left[ \begin{array}{c} -\mathbf{K} \quad \mathbf{0}
\\ \mathbf{0} \quad \mathbf{M} \end{array} \right], \quad \mathbf{B} =  \left[ \begin{array}{c}
\mathbf{C} \quad \mathbf{M} \\ \mathbf{M} \quad \mathbf{0} \end{array} \right], \quad
\mathbf{ F(z)} =  \left[ \begin{array}{c}- \mathbf{f(x,\dot{x})} \\ \mathbf{0}
\end{array} \right],  \quad  \mathbf{ G}(\mathbf\Omega t, \mathbf{z}) =  \left[
\begin{array} {c} \mathbf{g}(\mathbf\Omega t,\mathbf{x},\mathbf{\dot{x}}) \\
\mathbf{0}\end{array}\right]</script></p><p>This choice to obtain the first-order form is not unique (cf. <a href="http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf">Jain &amp; Haller, 2021</a>) but all such forms can be used for the computation of SSMs. No assumption has to be made about the magnitude of the nonlinearities as the results presented here are valid for nonlinearities of any magnitude, the curvature of the computed manifolds depends smoothly on the magnitude of the nonlinearities.</p><h2 id="3">Parametrisation of SSM and reduced dynamics</h2><p>To compute the parametrisation of the SSM and the reduced dynamics on it they are expanded as Taylor series. In an initial step, they are expanded in the forcing amplitude, which allows to separate autonomous and non-autonomuos contributions:</p><p><span class="MathJax_Preview"><img alt="$${\mathbf W}_\epsilon(\mathbf p,\mathbf\phi) = \mathbf W (\mathbf p ) + \epsilon
\mathbf{X} (\mathbf p,\mathbf \phi) + \cdots$$" src="SSM_Computation_eq12273124787060884426-Rescaled.png" style="width: 201.6px; height: auto;"/></span><script type="math/tex">{\mathbf W}_\epsilon(\mathbf p,\mathbf\phi) = \mathbf W (\mathbf p ) + \epsilon
\mathbf{X} (\mathbf p,\mathbf \phi) + \cdots</script></p><p><span class="MathJax_Preview"><img alt="$${\mathbf R}_\epsilon \mathbf(p,\mathbf\phi) =\mathbf R ( \mathbf p )+ \epsilon
\mathbf S (\mathbf p,\mathbf \phi) + \cdots$$" src="SSM_Computation_eq03975273981708551211-Rescaled.png" style="width: 188.4px; height: auto;"/></span><script type="math/tex">{\mathbf R}_\epsilon \mathbf(p,\mathbf\phi) =\mathbf R ( \mathbf p )+ \epsilon
\mathbf S (\mathbf p,\mathbf \phi) + \cdots</script></p><p>where <span class="MathJax_Preview"><img alt="$\mathbf{\dot{\phi}}= \mathbf{\Omega}$" src="SSM_Computation_eq05205175025179010537-Rescaled.png" style="width: 36.0px; height: auto;"/></span><script type="math/tex">\mathbf{\dot{\phi}}= \mathbf{\Omega}</script> Consequently the individual functions are also expanded in the parametrisation coordinates <span class="MathJax_Preview"><img alt="$\mathbf{p}$" src="SSM_Computation_eq03649988629740635444-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\mathbf{p}</script>. For the autonomous functions this reads</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{W}(\mathbf{p}) =  \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{W}_{\mathbf{m}}
\mathbf{p}^{\mathbf m}$$" src="SSM_Computation_eq12835639489125035428-Rescaled.png" style="width: 145px; height: auto;"/></span><script type="math/tex">\mathbf{W}(\mathbf{p}) =  \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{W}_{\mathbf{m}}
\mathbf{p}^{\mathbf m}</script></p><p><span class="MathJax_Preview"><img alt="$$\mathbf{R}(\mathbf{p})  =  \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{R}_{\mathbf{m}}
\mathbf{p}^{\mathbf m}$$" src="SSM_Computation_eq07885331305860780907-Rescaled.png" style="width: 140px; height: auto;"/></span><script type="math/tex">\mathbf{R}(\mathbf{p})  =  \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{R}_{\mathbf{m}}
\mathbf{p}^{\mathbf m}</script></p><p>Here we have made use of the multi-index notation, which leads to an efficient computational routine and easy handling of the terms (cf. <a href="https://arxiv.org/abs/2307.10240">Thurnher, Haller &amp; Jain, 2023</a>). Using a multi-index <span class="MathJax_Preview"><img alt="$\mathbf{m}\in\mathbf{N}^M$" src="SSM_Computation_eq09029457957637512675-Rescaled.png" style="width: 50.4px; height: auto;"/></span><script type="math/tex">\mathbf{m}\in\mathbf{N}^M</script> a monomial in parametrisation space can be written in a unique way, as <span class="MathJax_Preview"><img alt="$p_1\cdots p_M = \mathbf{p^m}$" src="SSM_Computation_eq16836301429973594803-Rescaled.png" style="width: 85.2px; height: auto;"/></span><script type="math/tex">p_1\cdots p_M = \mathbf{p^m}</script>.  As the non-autonomous parametrisation and reduced dynamics coefficients depend on time, they are expanded in a Fourier series, which yields an expression for the non-autonomous functions given in terms of a Taylor-Fourier expansion:</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{X}(\mathbf{p},\mathbf\phi)  =  \sum_{\mathbf{m}\in \mathbf{N}^M}
\sum_{\mathbf\kappa \in \mathbf{Z}^k} \mathbf{X}_{\mathbf{m},\mathbf\kappa }
e^{i \langle \mathbf\kappa , \mathbf\phi  \rangle} \mathbf{p}^{\mathbf m}$$" src="SSM_Computation_eq06165271463457904103-Rescaled.png" style="width: 250px; height: auto;"/></span><script type="math/tex">\mathbf{X}(\mathbf{p},\mathbf\phi)  =  \sum_{\mathbf{m}\in \mathbf{N}^M}
\sum_{\mathbf\kappa \in \mathbf{Z}^k} \mathbf{X}_{\mathbf{m},\mathbf\kappa }
e^{i \langle \mathbf\kappa , \mathbf\phi  \rangle} \mathbf{p}^{\mathbf m}</script></p><p><span class="MathJax_Preview"><img alt="$$\mathbf{S}(\mathbf{p},\mathbf\phi)  =  \sum_{\mathbf{m}\in \mathbf{N}^M}
\sum_{\mathbf\kappa \in \mathbf{Z}^k} \mathbf{S}_{\mathbf{m},\mathbf\kappa }
e^{i \langle \mathbf\kappa , \mathbf\phi  \rangle} \mathbf{p}^{\mathbf m}$$" src="SSM_Computation_eq07959730807270495591-Rescaled.png" style="width: 250px; height: auto;"/></span><script type="math/tex">\mathbf{S}(\mathbf{p},\mathbf\phi)  =  \sum_{\mathbf{m}\in \mathbf{N}^M}
\sum_{\mathbf\kappa \in \mathbf{Z}^k} \mathbf{S}_{\mathbf{m},\mathbf\kappa }
e^{i \langle \mathbf\kappa , \mathbf\phi  \rangle} \mathbf{p}^{\mathbf m}</script></p><p>For an account of how the coefficients of the nonlinear functions used in these expansions are used, please refer to the following figure:</p><p><img alt="" hspace="5" src="StoringNonlinearFunctions.png" style="width: 1000px; height: auto;" vspace="5"/> </p><h2 id="4">Existence and computation of SSMs</h2><p>In order to check, whether the SSM (we refer to it as <tt>S</tt>) that one is about to compute really exists, the <tt>Manifold</tt> class automatically performs a resonance analysis when the modes are chosen with</p><pre class="codeinput">S.<a href="../Library/Manifold/choose_E.html">choose_E</a>(masterModes)  <span class="comment">%automatically performs resonance analysis</span>
        </pre><p>Consequently, the information about resonances between the master spectral subspace and the remaining system modes that have been computed, gets stored in the SSM object. If a manifold computation is consequently attempted, the system will prompt information about relevant resonances which might affect the existence of the manifold. More information about this is given in <a href="5.%20Spectrum%20and%20Resonances.html">Spectrum and Resonances</a> and <a href="2.%20SSM-Theory.html">Theory of SSMs</a>.</p><h2 id="6">Computation of the autonomous SSM</h2><p>Now that the existence of the SSM has been established we move to the computation of the automomous SSM parametrisation <span class="MathJax_Preview"><img alt="$\mathbf{W}$" src="SSM_Computation_eq01605236756843318418-Rescaled.png" style="width: 15.6px; height: auto;"/></span><script type="math/tex">\mathbf{W}</script> and the reduced dynamics <span class="MathJax_Preview"><img alt="$\mathbf{R}$" src="SSM_Computation_eq07378229934469313194-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\mathbf{R}</script>. The following figure (cf. <a href="http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf">Jain &amp; Haller, 2021</a>) depicts, how such an SSM maps the <span class="MathJax_Preview"><img alt="$M$" src="SSM_Computation_eq09319732146067371049-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">M</script> parametrisation coordinates onto a <span class="MathJax_Preview"><img alt="$M$" src="SSM_Computation_eq09319732146067371049-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">M</script>- dimensional manifold <span class="MathJax_Preview"><img alt="$\mathcal{W}$" src="SSM_Computation_eq15880084773847119832-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">\mathcal{W}</script> in full phase space. This manifold is tangent to the master spectral subspace <span class="MathJax_Preview"><img alt="$\mathcal{E}$" src="SSM_Computation_eq07367169325332904049-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\mathcal{E}</script>. The reduced dynamics on the SSM are represented by <span class="MathJax_Preview"><img alt="$\mathbf{R}$" src="SSM_Computation_eq07378229934469313194-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\mathbf{R}</script> and constitute an exact ROM for the full system. Due to the invariance, any trajectory of the reduced dynamics in the parametrisation space is mapped onto a trajectory on <span class="MathJax_Preview"><img alt="$\mathcal{W}$" src="SSM_Computation_eq15880084773847119832-Rescaled.png" style="width: 14.399999999999999px; height: auto;"/></span><script type="math/tex">\mathcal{W}</script> on the full phase space. For an explanation on the underlying theory of the SSM and the reduced dynamics see <a href="SSM-Theory.html">Theory of SSMs</a>. For more explanations on the choice and importance of <span class="MathJax_Preview"><img alt="$\mathcal{E}$" src="SSM_Computation_eq07367169325332904049-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\mathcal{E}</script> refer to <a href="5.%20Spectrum%20and%20Resonances.html">Spectrum and Resonances</a>.</p><p><img alt="" hspace="5" src="AutManifold.png" style="width: 600px; height: auto;" vspace="5"/> </p><p>The autonomous contributions to the invariance equation (see <a href="2.%20SSM-Theory.html">SSM-Theory</a>) are collected which yields the autonomous invariance equation</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{B} (\textrm{D}_{\mathbf p} \mathbf{W}(\mathbf{p}) ) \mathbf{R}(\mathbf{p})
= \mathbf{A}\mathbf{W}(\mathbf{p}) + \mathbf{F} (\mathbf{W}(\mathbf{p}))$$" src="SSM_Computation_eq07722194018247683120-Rescaled.png" style="width: 234.0px; height: auto;"/></span><script type="math/tex">\mathbf{B} (\textrm{D}_{\mathbf p} \mathbf{W}(\mathbf{p}) ) \mathbf{R}(\mathbf{p})
= \mathbf{A}\mathbf{W}(\mathbf{p}) + \mathbf{F} (\mathbf{W}(\mathbf{p}))</script></p><p>Consequently the expansions for the SSM-parametrisation and the reduced dynamics are plugged in. As multi-variate monomials are linearly independent and form a basis in their functional space, the invariance equation decouples for each multi-index (recall that each multi-index corresponds to a unique monomial). The cohomological equation for a multi-index <span class="MathJax_Preview"><img alt="$\mathbf{m}$" src="SSM_Computation_eq03598573572044437231-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\mathbf{m}</script> reads</p><p><span class="MathJax_Preview"><img alt="$$\underbrace{ \bigg(\mathbf{A}  -  \Lambda_{\mathbf{m}} \mathbf{B}\bigg)
}_{:= \mathbf{L}_{\mathbf{m}}}  \mathbf{W}_{\mathbf m}  = \sum_{j=1}^M \mathbf{B}
\mathbf{v}_j R^j_{\mathbf m} + \mathbf{C}_{\mathbf m}$$" src="SSM_Computation_eq01001315810087849781-Rescaled.png" style="width: 223.2px; height: auto;"/></span><script type="math/tex">\underbrace{ \bigg(\mathbf{A}  -  \Lambda_{\mathbf{m}} \mathbf{B}\bigg)
}_{:= \mathbf{L}_{\mathbf{m}}}  \mathbf{W}_{\mathbf m}  = \sum_{j=1}^M \mathbf{B}
\mathbf{v}_j R^j_{\mathbf m} + \mathbf{C}_{\mathbf m}</script></p><p>Here we have defined <span class="MathJax_Preview"><img alt="$\Lambda_\mathbf{m} := \langle \mathbf \Lambda , \mathbf m \rangle$" src="SSM_Computation_eq18429912442943280394-Rescaled.png" style="width: 79.2px; height: auto;"/></span><script type="math/tex">\Lambda_\mathbf{m} := \langle \mathbf \Lambda , \mathbf m \rangle</script>.  As this equation is underdetermined ( <span class="MathJax_Preview"><img alt="$\textrm{dim}(\mathbf{A})=N$" src="SSM_Computation_eq08191573080801383547-Rescaled.png" style="width: 73.2px; height: auto;"/></span><script type="math/tex">\textrm{dim}(\mathbf{A})=N</script> and the number of unknowns is <span class="MathJax_Preview"><img alt="$N+M$" src="SSM_Computation_eq00350440018229380052-Rescaled.png" style="width: 42.0px; height: auto;"/></span><script type="math/tex">N+M</script>, due to the reduced dynamics coefficients ) we have the freedom to choose different styles of the parametrisation. For a normal form parametrisation, the reduced dynamics coefficients are set non-zero only in the case a resonance occurs. In this case the condition</p><p><span class="MathJax_Preview"><img alt="$$\lambda_i \approx \Lambda_{\mathbf m}$$" src="SSM_Computation_eq08834752361053078014-Rescaled.png" style="width: 46.8px; height: auto;"/></span><script type="math/tex">\lambda_i \approx \Lambda_{\mathbf m}</script></p><p>makes the coefficient matrix <span class="MathJax_Preview"><img alt="$\mathbf{L_m}$" src="SSM_Computation_eq16943427319323715914-Rescaled.png" style="width: 19.2px; height: auto;"/></span><script type="math/tex">\mathbf{L_m}</script> nearly singular. The reduced dynamcis are then chosen to lift this singularity and render the equation solvable, by choosing</p><p><span class="MathJax_Preview"><img alt="$$R^i_{\mathbf m} = -(\mathbf{u}_i)^* \mathbf{C}_{\mathbf m}$$" src="SSM_Computation_eq04827339489504955728-Rescaled.png" style="width: 96.0px; height: auto;"/></span><script type="math/tex">R^i_{\mathbf m} = -(\mathbf{u}_i)^* \mathbf{C}_{\mathbf m}</script></p><p>For more details refer to <a href="5.%20Spectrum%20and%20Resonances.html">Spectrum and Resonances</a> or to the following publications: <a href="http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf">Jain &amp; Haller, 2021</a>. and <a href="https://arxiv.org/abs/2307.10240">Thurnher, Haller &amp; Jain, 2023</a>.</p><p>To compute an approximation to the SSM with SSMTool up to order <tt>order</tt> one can simply call</p><pre class="codeinput">[W,R]=S.<a href="../Library/Manifold/compute_whisker.html">compute_whisker</a>(order);
        </pre><p>which automatically solves the cohomological equations up to a desired order.</p><h2 id="8">Computation of the non-autonomous SSM</h2><p>In the case of a non-autonomous dynamical system, the computation of the non-autonomous parametrisation <span class="MathJax_Preview"><img alt="$\mathbf{X}$" src="SSM_Computation_eq02260506203804848401-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\mathbf{X}</script> and the non-autonomous contributions of the reduced dynamics <span class="MathJax_Preview"><img alt="$\mathbf{S}$" src="SSM_Computation_eq17705281529142768610-Rescaled.png" style="width: 7.199999999999999px; height: auto;"/></span><script type="math/tex">\mathbf{S}</script> may be necessary. The non-autonomous, order <span class="MathJax_Preview"><img alt="$\epsilon$" src="SSM_Computation_eq04319661244345371386-Rescaled.png" style="width: 4.8px; height: auto;"/></span><script type="math/tex">\epsilon</script> contribution to the invariance equation reads</p><p><span class="MathJax_Preview"><img alt="$$\mathbf{B} \bigg(  (\textrm{D}_{\mathbf p} \mathbf{W} )\mathbf{S}    +
(\partial_{\mathbf p} \mathbf{X} ) \mathbf{R}  + (\partial_{\mathbf\phi} \mathbf{X
})   \mathbf\Omega  \bigg)  =   \mathbf{A}\mathbf{X}   +  \big[\textrm{D}_{\mathbf
z}\mathbf{F} \circ \mathbf{W}  \big]\mathbf{X}   +  \mathbf{G}  \circ \mathbf{W}$$" src="SSM_Computation_eq05281073062084194338-Rescaled.png" style="width: 394.8px; height: auto;"/></span><script type="math/tex">\mathbf{B} \bigg(  (\textrm{D}_{\mathbf p} \mathbf{W} )\mathbf{S}    +
(\partial_{\mathbf p} \mathbf{X} ) \mathbf{R}  + (\partial_{\mathbf\phi} \mathbf{X
})   \mathbf\Omega  \bigg)  =   \mathbf{A}\mathbf{X}   +  \big[\textrm{D}_{\mathbf
z}\mathbf{F} \circ \mathbf{W}  \big]\mathbf{X}   +  \mathbf{G}  \circ \mathbf{W}</script></p><p>The leading order terms in <span class="MathJax_Preview"><img alt="$\mathbf{X}$" src="SSM_Computation_eq02260506203804848401-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">\mathbf{X}</script> lead to an oscillation of the base to which the autonomous manifold is attached, while higher order terms account for the (quasi-) periodic deformation of the manifold itself. Note, that the non-autonomous effects are of magnitude <span class="MathJax_Preview"><img alt="$\epsilon$" src="SSM_Computation_eq04319661244345371386-Rescaled.png" style="width: 4.8px; height: auto;"/></span><script type="math/tex">\epsilon</script> and thus in many cases (in particular if only direct external excitation resonant to a single mode is present) this term can be neglected.</p><p><b>Leading order approximation</b></p><p>In such a case only a leading order approximation of the non-autonomous reduced dynamics is computed. The higher order non-autonomous terms of the manifold are ignored. The following parameter may be set, to omit higher order non-autonomous terms.</p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'contribNonAuto'</span>,false)
        </pre><p>As the ROM and SSM-coefficients are then independent of the forcing frequency, the invariance equation only has to be solved once - this leads to a fast computational routine. The leading order invariance equation is given as</p><p><span class="MathJax_Preview"><img alt="$$\bigg( \mathbf{A}-i \langle \mathbf\kappa, \mathbf\Omega \rangle\mathbf{B}
\bigg) \mathbf{X}_{\mathbf{0},\mathbf  \kappa}= \sum_{j=1}^M\mathbf{B} \mathbf{v}_j
S^j_{\mathbf{0},\mathbf  \kappa}  +\mathbf{G}_{\mathbf{0}, \mathbf  \kappa}$$" src="SSM_Computation_eq06087931841788550912-Rescaled.png" style="width: 246.0px; height: auto;"/></span><script type="math/tex">\bigg( \mathbf{A}-i \langle \mathbf\kappa, \mathbf\Omega \rangle\mathbf{B}
\bigg) \mathbf{X}_{\mathbf{0},\mathbf  \kappa}= \sum_{j=1}^M\mathbf{B} \mathbf{v}_j
S^j_{\mathbf{0},\mathbf  \kappa}  +\mathbf{G}_{\mathbf{0}, \mathbf  \kappa}</script></p><p>The ROM now reads</p><p><span class="MathJax_Preview"><img alt="$$\dot{\mathbf{p}}= \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{R}_{\mathbf{m}}
\mathbf{p}^{\mathbf m}+\epsilon  \mathbf{S}_{\mathbf{0},\kappa } e^{i \langle
\mathbf\kappa, \mathbf \Omega \rangle t}$$" src="SSM_Computation_eq14128181023831045217-Rescaled.png" style="width: 177.6px; height: auto;"/></span><script type="math/tex">\dot{\mathbf{p}}= \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{R}_{\mathbf{m}}
\mathbf{p}^{\mathbf m}+\epsilon  \mathbf{S}_{\mathbf{0},\kappa } e^{i \langle
\mathbf\kappa, \mathbf \Omega \rangle t}</script></p><p>where the non-autonomous coefficient has been chosen as <span class="MathJax_Preview"><img alt="$S^j_{\mathbf{0},\mathbf \kappa} = - \mathbf{u}_j^*\mathbf{G}_{\mathbf{0, \kappa}}$" src="SSM_Computation_eq15951077005921236099-Rescaled.png" style="width: 87.6px; height: auto;"/></span><script type="math/tex">S^j_{\mathbf{0},\mathbf \kappa} = - \mathbf{u}_j^*\mathbf{G}_{\mathbf{0, \kappa}}</script> (note that the normalisation of the linear modes is <span class="MathJax_Preview"><img alt="$\mathbf{u}_i^*\mathbf{Bv}_j= \delta_{ij}$" src="SSM_Computation_eq17414080602006000168-Rescaled.png" style="width: 67.2px; height: auto;"/></span><script type="math/tex">\mathbf{u}_i^*\mathbf{Bv}_j= \delta_{ij}</script> ) to lift the direct resonance</p><p><span class="MathJax_Preview"><img alt="$$\iota \langle \mathbf \kappa , \mathbf \Omega \rangle \approx \lambda_j$$" src="SSM_Computation_eq18123198496291714085-Rescaled.png" style="width: 68.39999999999999px; height: auto;"/></span><script type="math/tex">\iota \langle \mathbf \kappa , \mathbf \Omega \rangle \approx \lambda_j</script></p><p><b>Higher order approximation</b></p><p>If more complex resonances or physical effects such as parametric excitation, subharmonic resonances or a more accurate computation is desired, then the non-autonomous terms have to be added to the expansion. Higher order terms of the expansion are included by setting</p><pre class="codeinput">set(S.<a href="../Library/Features/Options/Options.html">Options</a>,<span class="string">'contribNonAuto'</span>,true)
        </pre><p>The non-autonomous invariance equation for higher order terms reads</p><p><span class="MathJax_Preview"><img alt="$$\underbrace{ \bigg(  \mathbf{A} -   ( \Lambda_{\mathbf m} +  i \langle \mathbf
\kappa, \mathbf  \Omega \rangle)\mathbf{B}  \bigg) }_{:=\mathbf{L}_{\mathbf{m},\mathbf
\kappa} } \mathbf{X}_{\mathbf{m},\mathbf  \kappa}  = \sum_{j=1}^M  \mathbf{B}
\mathbf{v}_j S^j_{\mathbf{m},\mathbf  \kappa}  + \mathbf{C}_{\mathbf{m}, \mathbf
\kappa}$$" src="SSM_Computation_eq13829459683895719483-Rescaled.png" style="width: 306.0px; height: auto;"/></span><script type="math/tex">\underbrace{ \bigg(  \mathbf{A} -   ( \Lambda_{\mathbf m} +  i \langle \mathbf
\kappa, \mathbf  \Omega \rangle)\mathbf{B}  \bigg) }_{:=\mathbf{L}_{\mathbf{m},\mathbf
\kappa} } \mathbf{X}_{\mathbf{m},\mathbf  \kappa}  = \sum_{j=1}^M  \mathbf{B}
\mathbf{v}_j S^j_{\mathbf{m},\mathbf  \kappa}  + \mathbf{C}_{\mathbf{m}, \mathbf
\kappa}</script></p><p>Again, <span class="MathJax_Preview"><img alt="$\mathbf{C_{m,\kappa}}$" src="SSM_Computation_eq16787966749177052078-Rescaled.png" style="width: 27.599999999999998px; height: auto;"/></span><script type="math/tex">\mathbf{C_{m,\kappa}}</script> collects known terms corresponding to lower order expansions, the nonlinear internal forces and the time-dependent forces. The reduced dynamics are chosen to lift the singularity due to resonances of the form</p><p><span class="MathJax_Preview"><img alt="$$\lambda_i \approx \Lambda_{\mathbf m} +  i \langle \mathbf  \kappa, \mathbf
\Omega \rangle$$" src="SSM_Computation_eq12325049325820780259-Rescaled.png" style="width: 102.0px; height: auto;"/></span><script type="math/tex">\lambda_i \approx \Lambda_{\mathbf m} +  i \langle \mathbf  \kappa, \mathbf
\Omega \rangle</script></p><p>and are set as</p><p><span class="MathJax_Preview"><img alt="$$S^i_{\mathbf{m},\mathbf  \kappa} = (\mathbf{u}_i)^* \mathbf{\mathcal{C}}_{\mathbf{m},\mathbf
\kappa}$$" src="SSM_Computation_eq10979724355052547166-Rescaled.png" style="width: 93.6px; height: auto;"/></span><script type="math/tex">S^i_{\mathbf{m},\mathbf  \kappa} = (\mathbf{u}_i)^* \mathbf{\mathcal{C}}_{\mathbf{m},\mathbf
\kappa}</script></p><p>Details on the computational procedure are given in  <a href="https://arxiv.org/abs/2307.10240">Thurnher, Haller &amp; Jain, 2023</a>. The non-autonomous terms can be computed by calling</p><pre class="codeinput">S.<a href="../Library/Manifold/compute_perturbed_whisker.html">compute_perturbed_whisker</a>(order,W0,R0,Omega)
        </pre><p>Note that for this, <tt>W0</tt> and <tt>R0</tt> need to be provided up to <tt>order+1,</tt> due to the structure of the non-autonomous equations, and the forcing frequency corresponds to the frequency at which the non-autonomous terms should be computed. In the following figure (cf. <a href="http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf">Jain &amp; Haller, 2021</a>), the parametrisation of such a non-autonomous SSM and the reduced dynamics on it are visualised schematically. The parametrisation space (yellow) consists of a direct product of <span class="MathJax_Preview"><img alt="$\mathbf{C}^M$" src="SSM_Computation_eq04167144115621680967-Rescaled.png" style="width: 20.4px; height: auto;"/></span><script type="math/tex">\mathbf{C}^M</script>, which contains the spacial parametrisation coordinates, with the <span class="MathJax_Preview"><img alt="$K$" src="SSM_Computation_eq14155762934034653800-Rescaled.png" style="width: 12.0px; height: auto;"/></span><script type="math/tex">K</script> - dimensional torus <span class="MathJax_Preview"><img alt="$\mathbf{T}^K$" src="SSM_Computation_eq12736990128586506020-Rescaled.png" style="width: 19.2px; height: auto;"/></span><script type="math/tex">\mathbf{T}^K</script>, which includes the temporal variables. The parametrisation <span class="MathJax_Preview"><img alt="$\mathbf{W}_\epsilon$" src="SSM_Computation_eq07602178423321565983-Rescaled.png" style="width: 19.2px; height: auto;"/></span><script type="math/tex">\mathbf{W}_\epsilon</script> then maps this direct product onto the invariant, non-autonomous manifold (blue) in the full, non-autonomous phase space. The spatial euclidian coordinates of this phase space are represented with a gray rectangle. The master subspace <span class="MathJax_Preview"><img alt="$\mathcal{E}$" src="SSM_Computation_eq07367169325332904049-Rescaled.png" style="width: 8.4px; height: auto;"/></span><script type="math/tex">\mathcal{E}</script> is displayed in green. The temporal evolution of the manifold parametrisation implies that, as time passes, the SSM stays tangent to the subbundle <span class="MathJax_Preview"><img alt="$\gamma_\epsilon \times \mathcal{E}$" src="SSM_Computation_eq00505933019360393142-Rescaled.png" style="width: 36.0px; height: auto;"/></span><script type="math/tex">\gamma_\epsilon \times \mathcal{E}</script>. The SSM furthermore deformes in a quasiperiodic manner, according to the frequencies and harmonics present in the external excitation.</p><p><img alt="" hspace="5" src="NonAutManifold.png" style="width: 600px; height: auto;" vspace="5"/> </p><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% An introduction to the computation of Spectral Submanifolds
%
%% First order mechanical systems
% We consider dynamical systems of the form
% 
% $$\mathbf{B\dot{z} = Az + F(z,\mu}) + \epsilon \mathbf{ G}(\mathbf\Omega t, 
% \mathbf{z}) \quad,\mathbf{z} \in \mathbf{R}^N, \mathbf{\mu} \in \mathbf{R}^p, 
% \ 0\leq\epsilon \ll 1$$
% 
% Any first order ODE with smooth right hand side can be brought to this standard 
% form around its fixed points. After an initial translation to set a fixed point 
% to the origin of the coordinate system, the right hand side can be expanded 
% as a Taylor series which yields the desired form. Here  $\mathbf{A} \in \mathbf{R}^{N 
% \times N}$ is the linear part of the dynamical system. Throughout the dynamical 
% systems literature the matrix $\mathbf{B} \in \mathbf{R}^{N \times N}$ is often 
% taken to be the identity. We do not make this assumption and treat the general 
% case, which leads to computational advantages for dynamical systems that stem 
% from second order ODEs as the inversion of possibly large system matrices can 
% be avoided this way. $\mathbf{F}$ is a vector valued nonlinear function and 
% assumed to be $r$-times continuously differentiable in $\mathbf{z}$ and a set 
% of parameters $\mathbf{\mu}$. $\mathbf{G}$ is a non-autonomous and possibly 
% non-linear function which contains the time-dependent forcing that is acting 
% on the system. 
%% Second order mechanical systems
% Invariant manifolds such as SSMs can also be computed in the phase space of 
% second order mechanical systems. These look as follows
% 
% $$\mathbf{M\ddot{x} + C}\mathbf{\dot{x} + Kx + \mathbf{f}(x,\dot{x},\mu)} 
% = \epsilon \mathbf{g}(\mathbf\Omega t,\mathbf{x},\mathbf{\dot{x}}), \ 0\leq\epsilon 
% \ll 1$$
% 
% The linear part of the system is characterised by $\mathbf{M}, \mathbf{C}, 
% \mathbf{K} \in \mathbf{R}^{n\times n}$ which denote the mass, damping and stiffness 
% matrices, respectively. The function $\mathbf{f}(\mathbf{y},\mathbf{\dot{y}}, 
% \mathbf{\mu})$ is a nonlinear function that is $r$ times continuously differentiable 
% with $r\ge 1$.The distinct types of time-dependent forces are represented by 
% general forcing vector $\mathbf{g}$. The second order form can be rewritten 
% to the first order form, for instance by choosing
% 
% $$\mathbf{z} =  \left[ \begin{array}{c} \mathbf{x}  \\ \dot{\mathbf{x}} \end{array} 
% \right], \quad  \mathbf{A} =  \left[ \begin{array}{c} -\mathbf{K} \quad \mathbf{0} 
% \\ \mathbf{0} \quad \mathbf{M} \end{array} \right], \quad \mathbf{B} =  \left[ \begin{array}{c} 
% \mathbf{C} \quad \mathbf{M} \\ \mathbf{M} \quad \mathbf{0} \end{array} \right], \quad 
% \mathbf{ F(z)} =  \left[ \begin{array}{c}- \mathbf{f(x,\dot{x})} \\ \mathbf{0} 
% \end{array} \right],  \quad  \mathbf{ G}(\mathbf\Omega t, \mathbf{z}) =  \left[ 
% \begin{array} {c} \mathbf{g}(\mathbf\Omega t,\mathbf{x},\mathbf{\dot{x}}) \\ 
% \mathbf{0}\end{array}\right]$$
% 
% 
% 
% This choice to obtain the first-order form is not unique (cf. <http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf 
% Jain & Haller, 2021>) but all such forms can be used for the computation of SSMs.  
% No assumption has to be made about the magnitude of the nonlinearities as the 
% results presented here are valid for nonlinearities of any magnitude, the curvature 
% of the computed manifolds depends smoothly on the magnitude of the nonlinearities.
%% Parametrisation of SSM and reduced dynamics
% To compute the parametrisation of the SSM and the reduced dynamics on it they 
% are expanded as Taylor series. In an initial step, they are expanded in the 
% forcing amplitude, which allows to separate autonomous and non-autonomuos contributions:
% 
% $${\mathbf W}_\epsilon(\mathbf p,\mathbf\phi) = \mathbf W (\mathbf p ) + \epsilon 
% \mathbf{X} (\mathbf p,\mathbf \phi) + \cdots$$
% 
% $${\mathbf R}_\epsilon \mathbf(p,\mathbf\phi) =\mathbf R ( \mathbf p )+ \epsilon 
% \mathbf S (\mathbf p,\mathbf \phi) + \cdots$$
% 
% where $\mathbf{\dot{\phi}}= \mathbf{\Omega}$ Consequently the individual functions 
% are also expanded in the parametrisation coordinates $\mathbf{p}$. For the autonomous 
% functions this reads
% 
% $$\mathbf{W}(\mathbf{p}) =  \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{W}_{\mathbf{m}} 
% \mathbf{p}^{\mathbf m}$$
% 
% $$\mathbf{R}(\mathbf{p})  =  \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{R}_{\mathbf{m}} 
% \mathbf{p}^{\mathbf m}$$
% 
% Here we have made use of the multi-index notation, which leads to an efficient 
% computational routine and easy handling of the terms (cf. <https://arxiv.org/abs/2307.10240 
% Thurnher, Haller & Jain, 2023>). Using a multi-index $\mathbf{m}\in\mathbf{N}^M$ 
% a monomial in parametrisation space can be written in a unique way, as $p_1\cdots 
% p_M = \mathbf{p^m}$.  As the non-autonomous parametrisation and reduced dynamics 
% coefficients depend on time, they are expanded in a Fourier series, which yields 
% an expression for the non-autonomous functions given in terms of a Taylor-Fourier 
% expansion:
% 
% $$\mathbf{X}(\mathbf{p},\mathbf\phi)  =  \sum_{\mathbf{m}\in \mathbf{N}^M} 
% \sum_{\mathbf\kappa \in \mathbf{Z}^k} \mathbf{X}_{\mathbf{m},\mathbf\kappa } 
% e^{i \langle \mathbf\kappa , \mathbf\phi  \rangle} \mathbf{p}^{\mathbf m}$$
% 
% $$\mathbf{S}(\mathbf{p},\mathbf\phi)  =  \sum_{\mathbf{m}\in \mathbf{N}^M}     
% \sum_{\mathbf\kappa \in \mathbf{Z}^k} \mathbf{S}_{\mathbf{m},\mathbf\kappa } 
% e^{i \langle \mathbf\kappa , \mathbf\phi  \rangle} \mathbf{p}^{\mathbf m}$$
%
%
% For an account of how the coefficients of the nonlinear functions used in
% these expansions are used, please refer to the following figure:
%
% <<StoringNonlinearFunctions.png>>
%
%% Existence and computation of SSMs
%
% In order to check, whether the SSM (we refer to it as |S|) that one is about 
% to compute really exists, the |Manifold| class automatically performs a resonance 
% analysis when the modes are chosen with

S.<a href="../Library/Manifold/choose_E.html">choose_E</a>(masterModes)  %automatically performs resonance analysis
%% 
% Consequently, the information about resonances between the master spectral 
% subspace and the remaining system modes that have been computed, gets stored 
% in the SSM object. If a manifold computation is consequently attempted, the 
% system will prompt information about relevant resonances which might affect 
% the existence of the manifold. More information about this is given in
% <5.%20Spectrum%20and%20Resonances.html Spectrum and Resonances> and
% <2.%20SSM-Theory.html Theory of SSMs>.
%
%% Computation of the autonomous SSM
% Now that the existence of the SSM has been established we move to the computation 
% of the automomous SSM parametrisation $\mathbf{W}$ and the reduced dynamics $\mathbf{R}$. 
% The following figure (cf. <http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf 
% Jain & Haller, 2021>) depicts, how such an SSM maps the $M$ parametrisation 
% coordinates onto a $M$- dimensional manifold $\mathcal{W}$ in full phase space. 
% This manifold is tangent to the master spectral subspace $\mathcal{E}$. The 
% reduced dynamics on the SSM are represented by $\mathbf{R}$ and constitute an 
% exact ROM for the full system. Due to the invariance, any trajectory of the 
% reduced dynamics in the parametrisation space is mapped onto a trajectory on 
% $\mathcal{W}$ on the full phase space. For an explanation on the underlying 
% theory of the SSM and the reduced dynamics see <SSM-Theory.html Theory of SSMs>. 
% For more explanations on the choice and importance of $\mathcal{E}$ refer to 
% <5.%20Spectrum%20and%20Resonances.html Spectrum and Resonances>.
% 
% <<AutManifold.png>>
% 
% The autonomous contributions to the invariance equation (see <2.%20SSM-Theory.html 
% SSM-Theory>) are collected which yields the autonomous invariance equation
% 
% $$\mathbf{B} (\textrm{D}_{\mathbf p} \mathbf{W}(\mathbf{p}) ) \mathbf{R}(\mathbf{p}) 
% = \mathbf{A}\mathbf{W}(\mathbf{p}) + \mathbf{F} (\mathbf{W}(\mathbf{p}))$$
% 
% Consequently the expansions for the SSM-parametrisation and the reduced dynamics 
% are plugged in. As multi-variate monomials are linearly independent and form 
% a basis in their functional space, the invariance equation decouples for each 
% multi-index (recall that each multi-index corresponds to a unique monomial). 
% The cohomological equation for a multi-index $\mathbf{m}$ reads
% 
% $$\underbrace{ \bigg(\mathbf{A}  -  \Lambda_{\mathbf{m}} \mathbf{B}\bigg) 
% }_{:= \mathbf{L}_{\mathbf{m}}}  \mathbf{W}_{\mathbf m}  = \sum_{j=1}^M \mathbf{B} 
% \mathbf{v}_j R^j_{\mathbf m} + \mathbf{C}_{\mathbf m}$$
% 
% Here we have defined $\Lambda_\mathbf{m} := \langle \mathbf \Lambda , \mathbf 
% m \rangle$.  As this equation is underdetermined ( $\textrm{dim}(\mathbf{A})=N$ 
% and the number of unknowns is $N+M$, due to the reduced dynamics coefficients 
% ) we have the freedom to choose different styles of the parametrisation. For 
% a normal form parametrisation, the reduced dynamics coefficients are set non-zero 
% only in the case a resonance occurs. In this case the condition
% 
% $$\lambda_i \approx \Lambda_{\mathbf m}$$
% 
% makes the coefficient matrix $\mathbf{L_m}$ nearly singular. The reduced dynamcis 
% are then chosen to lift this singularity and render the equation solvable, by 
% choosing
% 
% $$R^i_{\mathbf m} = -(\mathbf{u}_i)^* \mathbf{C}_{\mathbf m}$$
% 
% For more details refer to <5.%20Spectrum%20and%20Resonances.html Spectrum 
% and Resonances> or to the following publications: <http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf 
% Jain & Haller, 2021>. and <https://arxiv.org/abs/2307.10240 Thurnher, Haller 
% & Jain, 2023>.
% 
% To compute an approximation to the SSM with SSMTool up to order |order| one 
% can simply call 

[W,R]=S.<a href="../Library/Manifold/compute_whisker.html">compute_whisker</a>(order);
%% 
% which automatically solves the cohomological equations up to a desired order.
%% Computation of the non-autonomous SSM
% In the case of a non-autonomous dynamical system, the computation of the non-autonomous 
% parametrisation $\mathbf{X}$ and the non-autonomous contributions of the reduced 
% dynamics $\mathbf{S}$ may be necessary. The non-autonomous, order $\epsilon$ 
% contribution to the invariance equation reads
% 
% $$\mathbf{B} \bigg(  (\textrm{D}_{\mathbf p} \mathbf{W} )\mathbf{S}    + 	 
% (\partial_{\mathbf p} \mathbf{X} ) \mathbf{R}  + (\partial_{\mathbf\phi} \mathbf{X 
% })   \mathbf\Omega  \bigg)  =   \mathbf{A}\mathbf{X}   +  \big[\textrm{D}_{\mathbf 
% z}\mathbf{F} \circ \mathbf{W}  \big]\mathbf{X}   +  \mathbf{G}  \circ \mathbf{W}$$
% 
% The leading order terms in $\mathbf{X}$ lead to an oscillation of the base 
% to which the autonomous manifold is attached, while higher order terms account 
% for the (quasi-) periodic deformation of the manifold itself. Note, that the 
% non-autonomous effects are of magnitude $\epsilon$ and thus in many cases (in 
% particular if only direct external excitation resonant to a single mode is present) 
% this term can be neglected. 
% 
% *Leading order approximation*
% 
% In such a case only a leading order approximation of the non-autonomous reduced 
% dynamics is computed. The higher order non-autonomous terms of the manifold are ignored. 
% The following parameter may be set, to omit higher order non-autonomous terms. 

set(S.<a href="../Library/Features/Options/Options.html">Options</a>,'contribNonAuto',false)
%% 
% As the ROM and SSM-coefficients are then independent of the forcing frequency, 
% the invariance equation only has to be solved once - this leads to a fast computational 
% routine. The leading order invariance equation is given as 
% 
% $$\bigg( \mathbf{A}-i \langle \mathbf\kappa, \mathbf\Omega \rangle\mathbf{B} 
% \bigg) \mathbf{X}_{\mathbf{0},\mathbf  \kappa}= \sum_{j=1}^M\mathbf{B} \mathbf{v}_j 
% S^j_{\mathbf{0},\mathbf  \kappa}  +\mathbf{G}_{\mathbf{0}, \mathbf  \kappa}$$
% 
% The ROM now reads
% 
% $$\dot{\mathbf{p}}= \sum_{\mathbf{m}\in \mathbf{N}^M} \mathbf{R}_{\mathbf{m}} 
% \mathbf{p}^{\mathbf m}+\epsilon  \mathbf{S}_{\mathbf{0},\kappa } e^{i \langle 
% \mathbf\kappa, \mathbf \Omega \rangle t}$$
% 
% where the non-autonomous coefficient has been chosen as $S^j_{\mathbf{0},\mathbf  
% \kappa} = - \mathbf{u}_j^*\mathbf{G}_{\mathbf{0, \kappa}}$ (note that the normalisation 
% of the linear modes is $\mathbf{u}_i^*\mathbf{Bv}_j= \delta_{ij}$ ) to lift 
% the direct resonance
% 
% $$\iota \langle \mathbf \kappa , \mathbf \Omega \rangle \approx \lambda_j$$
%
% *Higher order approximation*
%
% If more complex resonances or physical effects such as parametric excitation, subharmonic resonances or a more accurate computation 
% is desired, then the non-autonomous terms have to be added to the expansion. 
% Higher order terms of the expansion are included by setting

set(S.<a href="../Library/Features/Options/Options.html">Options</a>,'contribNonAuto',true)
%% 
% The non-autonomous invariance equation for higher order terms reads 
% 
% $$\underbrace{ \bigg(  \mathbf{A} -   ( \Lambda_{\mathbf m} +  i \langle \mathbf  
% \kappa, \mathbf  \Omega \rangle)\mathbf{B}  \bigg) }_{:=\mathbf{L}_{\mathbf{m},\mathbf 
% \kappa} } \mathbf{X}_{\mathbf{m},\mathbf  \kappa}  = \sum_{j=1}^M  \mathbf{B}   
% \mathbf{v}_j S^j_{\mathbf{m},\mathbf  \kappa}  + \mathbf{C}_{\mathbf{m}, \mathbf  
% \kappa}$$
% 
% Again, $\mathbf{C_{m,\kappa}}$ collects known terms corresponding to lower 
% order expansions, the nonlinear internal forces and the time-dependent forces. 
% The reduced dynamics are chosen to lift the singularity due to resonances of 
% the form
% 
% $$\lambda_i \approx \Lambda_{\mathbf m} +  i \langle \mathbf  \kappa, \mathbf  
% \Omega \rangle$$
% 
% and are set as
% 
% $$S^i_{\mathbf{m},\mathbf  \kappa} = (\mathbf{u}_i)^* \mathbf{\mathcal{C}}_{\mathbf{m},\mathbf  
% \kappa}$$
% 
% Details on the computational procedure are given in  <https://arxiv.org/abs/2307.10240 
% Thurnher, Haller & Jain, 2023>. The non-autonomous terms can be computed by 
% calling

S.<a href="../Library/Manifold/compute_perturbed_whisker.html">compute_perturbed_whisker</a>(order,W0,R0,Omega)
%% 
% Note that for this, |W0| and |R0| need to be provided up to |order+1,| due 
% to the structure of the non-autonomous equations, and the forcing frequency 
% corresponds to the frequency at which the non-autonomous terms should be computed. 
% In the following figure (cf. <http://www.georgehaller.com/reprints/JainHaller_HowToComputeInvariantManifolds.pdf 
% Jain & Haller, 2021>), the parametrisation of such a non-autonomous SSM and 
% the reduced dynamics on it are visualised schematically. The parametrisation 
% space (yellow) consists of a direct product of $\mathbf{C}^M$, which contains 
% the spacial parametrisation coordinates, with the $K$ - dimensional torus $\mathbf{T}^K$, 
% which includes the temporal variables. The parametrisation $\mathbf{W}_\epsilon$ 
% then maps this direct product onto the invariant, non-autonomous manifold (blue) 
% in the full, non-autonomous phase space. The spatial euclidian coordinates of 
% this phase space are represented with a gray rectangle. The master subspace $\mathcal{E}$ is displayed in green. The temporal evolution of the manifold 
% parametrisation implies that, as time passes, the SSM stays tangent to the subbundle 
% $\gamma_\epsilon \times \mathcal{E}$. The SSM furthermore deformes in a quasiperiodic 
% manner, according to the frequencies and harmonics present in the external excitation.
% 
% <<NonAutManifold.png>>
%
            ##### SOURCE END #####
        --></body></html></body></html>