
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../../index.html"><img alt="Logo" class="logo" src="../../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>AUTO_PO_SOLVER</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-09" name="DC.date"/><meta content="auto_po_solver.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>AUTO_PO_SOLVER</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Autonomous periodic orbit solver</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> varargout = auto_po_solver(obj,R_0,oid,t0,p0,coordinates)
        </pre><h2 id="2">Autonomous periodic orbit solver</h2><p>This function solves for the periodic orbit of autonomous dynamics on SSM with given initial guess of periodic orbit <tt>{t0,p0}</tt>. Here <tt>t0</tt> is a time sequence, and <tt>p0</tt> are the corresponding sequence of states in either polar or cartesian representation (string in coordinates). For the rest of arguments, lambda is the spectrum of the spectral subspace used for yielding the reduced dynamics <tt>R_0</tt></p><pre class="codeinput">lambda = obj.System.spectrum.Lambda;
lambdaRe = real(lambda);
lambdaIm = imag(lambda);

<span class="comment">% check reduced dynamics to see its consistent with reduced dynamics</span>
m     = numel(lambda)/2;
order = numel(R_0);
beta  = cell(m,1); <span class="comment">% coefficients - each cell corresponds to one mode</span>
kappa = cell(m,1); <span class="comment">% exponants</span>
<span class="keyword">for</span> k = 2:order
    R = R_0{k};
    coeffs = R.coeffs;
    ind = R.ind;
    <span class="keyword">if</span> ~isempty(coeffs)
        <span class="keyword">for</span> i=1:m
            betai = coeffs(2*i-1,:);
            [~,ki,betai] = find(betai);
            kappai = ind(ki,:);
            <span class="comment">% check resonant condition</span>
            <span class="comment">% assemble terms</span>
            beta{i}  = [beta{i} betai];
            kappa{i} = [kappa{i}; kappai];
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>

fdata = struct();
fdata.beta  = beta;
fdata.kappa = kappa;
fdata.lamdRe = lambdaRe(1:2:end-1);
fdata.lamdIm = lambdaIm(1:2:end-1);

ispolar = strcmp(coordinates, <span class="string">'polar'</span>);
fdata.ispolar = ispolar;
<span class="keyword">if</span> ispolar
    error(<span class="string">'autonomous vector field in polar representation is not implemented yet'</span>);
<span class="keyword">else</span>
    odefun = @(z,p) <a href="../../Library/SSM/private/auto_ode_2mDSSM_cartesian.html">auto_ode_2mDSSM_cartesian</a>(z,fdata);
<span class="keyword">end</span>
funcs  = {odefun};

prob = coco_prob();
prob = coco_set(prob,<span class="string">'corr'</span>,<span class="string">'TOL'</span>,1e-5);
prob = ode_isol2po(prob, <span class="string">''</span>, funcs{:}, t0, p0);
runid = coco_get_id(oid, <span class="string">'auto-po'</span>);
bd = coco(prob, runid, [], 0);
varargout{1} = bd;
        </pre><pre class="codeinput"><span class="keyword">end</span>
        </pre><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% AUTO_PO_SOLVER
%
%%
function varargout = auto_po_solver(obj,R_0,oid,t0,p0,coordinates)
%% Autonomous periodic orbit solver
% This function solves for the periodic orbit of autonomous
% dynamics on SSM with given initial guess of periodic orbit |{t0,p0}|. Here
% |t0| is a time sequence, and |p0| are the corresponding sequence of states in
% either polar or cartesian representation (string in coordinates). For the
% rest of arguments, lambda is the spectrum of the spectral subspace used
% for yielding the reduced dynamics |R_0|

lambda = obj.System.spectrum.Lambda;
lambdaRe = real(lambda);
lambdaIm = imag(lambda);

% check reduced dynamics to see its consistent with reduced dynamics
m     = numel(lambda)/2;
order = numel(R_0);
beta  = cell(m,1); % coefficients - each cell corresponds to one mode
kappa = cell(m,1); % exponants
for k = 2:order
    R = R_0{k};
    coeffs = R.coeffs;
    ind = R.ind;
    if ~isempty(coeffs)
        for i=1:m
            betai = coeffs(2*i-1,:);
            [~,ki,betai] = find(betai);
            kappai = ind(ki,:);
            % check resonant condition  
            % assemble terms
            beta{i}  = [beta{i} betai];
            kappa{i} = [kappa{i}; kappai];
        end
    end
end

fdata = struct();
fdata.beta  = beta;
fdata.kappa = kappa;
fdata.lamdRe = lambdaRe(1:2:end-1);
fdata.lamdIm = lambdaIm(1:2:end-1);

ispolar = strcmp(coordinates, 'polar');
fdata.ispolar = ispolar;
if ispolar
    error('autonomous vector field in polar representation is not implemented yet');
else
    odefun = @(z,p) <a href="../../Library/SSM/private/auto_ode_2mDSSM_cartesian.html">auto_ode_2mDSSM_cartesian</a>(z,fdata);
end
funcs  = {odefun};

prob = coco_prob();
prob = coco_set(prob,'corr','TOL',1e-5);
prob = ode_isol2po(prob, '', funcs{:}, t0, p0);
runid = coco_get_id(oid, 'auto-po');
bd = coco(prob, runid, [], 0);
varargout{1} = bd;
end



            ##### SOURCE END #####
        --></body></html></body></html>