
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../../../index.html"><img alt="Logo" class="logo" src="../../../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>Transient trajectory on autonomous SSM</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-09" name="DC.date"/><meta content="transient_traj_on_auto_ssm.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>Transient trajectory on autonomous SSM</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">TRANSIENT_TRAJ_ON_AUTO_SSM</a></li><li><a href="#3">project z0 to reduced manifold</a></li><li><a href="#4">forward simulation in reduced dynamics</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> traj = transient_traj_on_auto_ssm(DS, modes, W_0, R_0, tf, nsteps, outdof, z0, varargin)
        </pre><h2 id="2">TRANSIENT_TRAJ_ON_AUTO_SSM</h2><p>This function returns transient trajectory on autonomous SSM. Given an initial condition z0 in the full system, we first project it onto the SSM (based on linear projection) and then perform time integration using ode45 for t\in[0,tf]. The trajectory at outdof is avaliable in the output. The inputs W_0 and R_0 can be obtained from the compute_whisker routine. DS is the dynamical system class and modes represent master modes.</p><p>varargin = s0 (initial condition in reduced coordinates)</p><h2 id="3">project z0 to reduced manifold</h2><pre class="codeinput"><span class="keyword">if</span> numel(varargin)==0
    qinit = <a href="../../../Library/Features/misc/proj2SSM.html">proj2SSM</a>(z0,<span class="string">'linear'</span>,DS.spectrum.W(:,modes),DS.B);
<span class="keyword">else</span>
    qinit = varargin{1};
<span class="keyword">end</span>
        </pre><h2 id="4">forward simulation in reduced dynamics</h2><p>extract coefficients and exponents</p><pre class="codeinput">beta  = [];
kappa = [];
<span class="keyword">for</span> k = 2:numel(R_0)
    R = R_0(k);
    betak = R.coeffs;
    <span class="keyword">if</span> ~isempty(betak)
        kappak = R.ind;
        <span class="comment">% assemble terms</span>
        beta  = [beta betak];
        kappa = [kappa; kappak];
    <span class="keyword">end</span>
<span class="keyword">end</span>
autData.lamd  = DS.spectrum.Lambda(modes);
autData.beta  = beta;
autData.kappa = kappa;

<span class="comment">% Construct ode45-compatible vector field</span>
odefun = @(t,z) <a href="../../../Library/Features/misc/auto_red_dyn.html">auto_red_dyn</a>(z,autData);
<span class="comment">% forward simulation of reduced dynamics</span>
tsamp  = linspace(0,tf,nsteps+1);
options = odeset(<span class="string">'RelTol'</span>,1e-8,<span class="string">'AbsTol'</span>,1e-10);
[t,y]  = ode45(@(t,y) <a href="../../../Library/DynamicalSystem/odefun.html">odefun</a>(t,y), tsamp, qinit, options);
<span class="comment">% mapping it back to physical domain</span>
state  = transpose(y);
z    = <a href="../../../Library/Features/misc/reduced_to_full_traj.html">reduced_to_full_traj</a>([],state,W_0);
zout = z(outdof,:);

traj.time = t;
traj.red  = y;
traj.phy  = zout';
        </pre><pre class="codeinput"><span class="keyword">end</span>
        </pre><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% Transient trajectory on autonomous SSM
%
%%
function traj = transient_traj_on_auto_ssm(DS, modes, W_0, R_0, tf, nsteps, outdof, z0, varargin)
%% TRANSIENT_TRAJ_ON_AUTO_SSM 
% 
% This function returns transient trajectory on
% autonomous SSM. Given an initial condition z0 in the full system, we first
% project it onto the SSM (based on linear projection) and then perform time
% integration using ode45 for t\in[0,tf]. The trajectory at outdof is avaliable
% in the output. The inputs W_0 and R_0 can be obtained from the compute_whisker
% routine. DS is the dynamical system class and modes represent master
% modes.
%
% varargin = s0 (initial condition in reduced coordinates)

%% project z0 to reduced manifold 
if numel(varargin)==0
    qinit = <a href="../../../Library/Features/misc/proj2SSM.html">proj2SSM</a>(z0,'linear',DS.spectrum.W(:,modes),DS.B);
else
    qinit = varargin{1};
end

%% forward simulation in reduced dynamics 
% extract coefficients and exponents
beta  = [];
kappa = [];
for k = 2:numel(R_0)
    R = R_0(k);
    betak = R.coeffs;
    if ~isempty(betak)
        kappak = R.ind;
        % assemble terms
        beta  = [beta betak];
        kappa = [kappa; kappak];
    end
end
autData.lamd  = DS.spectrum.Lambda(modes);
autData.beta  = beta;
autData.kappa = kappa;

% Construct ode45-compatible vector field 
odefun = @(t,z) <a href="../../../Library/Features/misc/auto_red_dyn.html">auto_red_dyn</a>(z,autData);
% forward simulation of reduced dynamics
tsamp  = linspace(0,tf,nsteps+1);
options = odeset('RelTol',1e-8,'AbsTol',1e-10);
[t,y]  = ode45(@(t,y) <a href="../../../Library/DynamicalSystem/odefun.html">odefun</a>(t,y), tsamp, qinit, options);
% mapping it back to physical domain
state  = transpose(y);
z    = <a href="../../../Library/Features/misc/reduced_to_full_traj.html">reduced_to_full_traj</a>([],state,W_0);
zout = z(outdof,:);

traj.time = t;
traj.red  = y;
traj.phy  = zout';

end
            ##### SOURCE END #####
        --></body></html></body></html>