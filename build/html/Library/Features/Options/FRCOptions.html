
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../../../index.html"><img alt="Logo" class="logo" src="../../../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>FRC - Options</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-09" name="DC.date"/><meta content="FRCOptions.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>FRC - Options</h1><!--introduction--><p>Options that can be set for the analysis of the reduced dynamics on an invariant manifold</p><!--/introduction--><pre class="codeinput"><span class="keyword">classdef</span> FRCOptions &lt; matlab.mixin.SetGet


    <span class="keyword">properties</span>
        nRho = 100                 <span class="comment">% number of discrete rho values in the range [0, rhomax] (relevant for method == 'level set')</span>
        nPar = 100                 <span class="comment">% number of discrete parameter (Omega/epsilon) values in the parameter range</span>
        nPsi = 100                 <span class="comment">% number of discrete psi values in the range [0, 2*pi] (relevant for method == 'level set')</span>
        nt = 128                   <span class="comment">% number of discrete time intervals over which the periodic orbit is discretized (relevant for post-processing only)</span>
        rhoScale = 1               <span class="comment">% factor for increasing rhomax polar FRC</span>
        nCycle = 200               <span class="comment">% number of time integration cycles (relevant for numerical time integration)</span>

        omegaSampStyle = <span class="string">'uniform'</span> <span class="comment">% 'uniform', 'cocoOut', 'cocoBD' (relevant for method == 'continuation ep/po')</span>
        initialSolver = <span class="string">'forward'</span>  <span class="comment">% 'forward', 'fsolve' (relevant for method == 'continuation ep/po')</span>
        coordinates = <span class="string">'polar'</span>      <span class="comment">% coordinates for solving reduced dynamics: 'polar', 'cartesian'</span>
        sampStyle = <span class="string">'cocoBD'</span>       <span class="comment">% 'uniform', 'cocoOut', 'cocoBD' (relevant for method == 'continuation ep/po')</span>
        method = <span class="string">'level set'</span>       <span class="comment">% 'level set', 'continuation ep', 'continuation po'</span>
        saveIC = true              <span class="comment">% whether save initial conditions on periodic orbit or not</span>
        init                       <span class="comment">% initial solution guess (relevant for method == 'continuation ep/po')</span>
        frac   = [1 1]             <span class="comment">% [frac1,frac2] can be used to</span>
                                   <span class="comment">% tune the range of subintervals. Specifically, [oma, omb] will</span>
                                   <span class="comment">% be changed as [frac1*oma, frac2*omb] except on the end points of frequency range.</span>
        outdof = []                <span class="comment">% output degree-of-freedom</span>
        resType = <span class="string">'1:1'</span>            <span class="comment">% '1:1', '2:1' type of resonance of the forcing with natural eigenfrequency in a 2D SSM (relevant</span>
                                   <span class="comment">% for method == 'continuation_po')</span>
        periodsRatio = 1             <span class="comment">% 1,2,... looking for n*T periodic response where T is the forcing period (relevant for method ==</span>
                                   <span class="comment">% 'continuation po')</span>
        branchSwitch= false        <span class="comment">% Whether to continue branches (relevant for method == 'continuation_po')</span>

        p0 = [];                   <span class="comment">% parameters (epsilon,omega) in initial solution guess used in continuation</span>
        z0 = [];                   <span class="comment">% states (in slow-time reduced dynamics) in initial solution guess used in continuation</span>

        nonAutoParRedCom = false   <span class="comment">% compute_perturbed_wisker is called in the parallel computation of non-autonomous SSMs for</span>
                                   <span class="comment">% each sampled excitation frequency. The manifold object is transferred in such a call. This</span>
                                   <span class="comment">% communication cost is intenstive in parallel computation. To reduce the communication load,</span>
                                   <span class="comment">% we calculate the non-autonomous directly, instead of calling the routine if the field is true</span>

        omDepNonAuto    = true     <span class="comment">% Whether frequency dependence of nonautonomous coefficients should be taken into account</span>
                                   <span class="comment">% when computing manifold</span>
        omDepNonAutoVal = []       <span class="comment">% If omDepNonAuto == false, this parameter gives the forcing frequency for which the Manifold is computed</span>

        parSamps = []              <span class="comment">% solution at specific parameter values used for comparison or verification</span>
        torRotDiret = <span class="string">'pos'</span>        <span class="comment">% 'pos', 'neg' (rotation direction of tori)</span>
        torNumSegs  = 10           <span class="comment">% number of Fourier modes in the approximation of tori</span>
        torPurtb    = 1e-4         <span class="comment">% perturbation to Neimark-Sacker periodic orbits to yield initial tori</span>
    <span class="keyword">end</span>

    <span class="keyword">methods</span>

        <span class="keyword">function</span> set.omegaSampStyle(obj,omegaSampStyle)
            <span class="keyword">switch</span> lower(omegaSampStyle)
                <span class="keyword">case</span> <span class="string">'uniform'</span>
                    obj.omegaSampStyle = <span class="string">'uniform'</span>;
                <span class="keyword">case</span> <span class="string">'cocoout'</span>
                    obj.omegaSampStyle = <span class="string">'cocoOut'</span>;
                <span class="keyword">case</span> <span class="string">'cocobd'</span>
                    obj.omegaSampStyle = <span class="string">'cocoBD'</span>;
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Unknown omegaSampStyle type: set uniform or nonuniform frequency sampling types'</span>)
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> set.initialSolver(obj,initialSolver)
            <span class="keyword">switch</span> lower(initialSolver)
                <span class="keyword">case</span> <span class="string">'forward'</span>
                    obj.initialSolver = <span class="string">'forward'</span>;
                <span class="keyword">case</span> <span class="string">'fsolve'</span>
                    obj.initialSolver = <span class="string">'fsolve'</span>;
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Unknown omegaSampStyle type: set uniform or nonuniform frequency sampling types'</span>)
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> set.coordinates(obj,coordinates)
            <span class="keyword">switch</span> lower(coordinates)
                <span class="keyword">case</span> <span class="string">'polar'</span>
                    obj.coordinates = <span class="string">'polar'</span>;
                <span class="keyword">case</span> <span class="string">'cartesian'</span>
                    obj.coordinates = <span class="string">'cartesian'</span>;
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Unknown torus calculation method: set forward/interpolation/pde'</span>)
            <span class="keyword">end</span>
        <span class="keyword">end</span>

        <span class="keyword">function</span> set.sampStyle(obj,sampStyle)
            <span class="keyword">switch</span> lower(sampStyle)
                <span class="keyword">case</span> <span class="string">'uniform'</span>
                    obj.sampStyle = <span class="string">'uniform'</span>;
                <span class="keyword">case</span> <span class="string">'cocoout'</span>
                    obj.sampStyle = <span class="string">'cocoOut'</span>;
                <span class="keyword">case</span> <span class="string">'cocobd'</span>
                    obj.sampStyle = <span class="string">'cocoBD'</span>;
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Unknown sampStyle type: set uniform/cocoOut/cocoBD frequency sampling types'</span>)
            <span class="keyword">end</span>
        <span class="keyword">end</span>


        <span class="keyword">function</span> set.method(obj,method)
            <span class="keyword">switch</span> lower(method)
                <span class="keyword">case</span> <span class="string">'level set'</span>
                    obj.method = <span class="string">'level set'</span>;
                <span class="keyword">case</span> <span class="string">'continuation ep'</span>
                    obj.method = <span class="string">'continuation ep'</span>;
                <span class="keyword">case</span> <span class="string">'continuation po'</span>
                    obj.method = <span class="string">'continuation po'</span>;
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Unknown "method": set "level set" / "continuation ep" / "continuation po" types'</span>)
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
        </pre><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% FRC - Options
% Options that can be set for the analysis of the reduced dynamics on an invariant manifold
%%
classdef FRCOptions < matlab.mixin.SetGet

    
    properties        
        nRho = 100                 % number of discrete rho values in the range [0, rhomax] (relevant for method == 'level set') 
        nPar = 100                 % number of discrete parameter (Omega/epsilon) values in the parameter range 
        nPsi = 100                 % number of discrete psi values in the range [0, 2*pi] (relevant for method == 'level set') 
        nt = 128                   % number of discrete time intervals over which the periodic orbit is discretized (relevant for post-processing only)
        rhoScale = 1               % factor for increasing rhomax polar FRC
        nCycle = 200               % number of time integration cycles (relevant for numerical time integration)
        
        omegaSampStyle = 'uniform' % 'uniform', 'cocoOut', 'cocoBD' (relevant for method == 'continuation ep/po')
        initialSolver = 'forward'  % 'forward', 'fsolve' (relevant for method == 'continuation ep/po')
        coordinates = 'polar'      % coordinates for solving reduced dynamics: 'polar', 'cartesian'
        sampStyle = 'cocoBD'       % 'uniform', 'cocoOut', 'cocoBD' (relevant for method == 'continuation ep/po')
        method = 'level set'       % 'level set', 'continuation ep', 'continuation po' 
        saveIC = true              % whether save initial conditions on periodic orbit or not 
        init                       % initial solution guess (relevant for method == 'continuation ep/po')
        frac   = [1 1]             % [frac1,frac2] can be used to
                                   % tune the range of subintervals. Specifically, [oma, omb] will
                                   % be changed as [frac1*oma, frac2*omb] except on the end points of frequency range.
        outdof = []                % output degree-of-freedom  
        resType = '1:1'            % '1:1', '2:1' type of resonance of the forcing with natural eigenfrequency in a 2D SSM (relevant
                                   % for method == 'continuation_po')
        periodsRatio = 1             % 1,2,... looking for n*T periodic response where T is the forcing period (relevant for method ==
                                   % 'continuation po')
        branchSwitch= false        % Whether to continue branches (relevant for method == 'continuation_po')
        
        p0 = [];                   % parameters (epsilon,omega) in initial solution guess used in continuation
        z0 = [];                   % states (in slow-time reduced dynamics) in initial solution guess used in continuation
        
        nonAutoParRedCom = false   % compute_perturbed_wisker is called in the parallel computation of non-autonomous SSMs for
                                   % each sampled excitation frequency. The manifold object is transferred in such a call. This 
                                   % communication cost is intenstive in parallel computation. To reduce the communication load,
                                   % we calculate the non-autonomous directly, instead of calling the routine if the field is true 
                                   
        omDepNonAuto    = true     % Whether frequency dependence of nonautonomous coefficients should be taken into account
                                   % when computing manifold 
        omDepNonAutoVal = []       % If omDepNonAuto == false, this parameter gives the forcing frequency for which the Manifold is computed                    
                                   
        parSamps = []              % solution at specific parameter values used for comparison or verification
        torRotDiret = 'pos'        % 'pos', 'neg' (rotation direction of tori)
        torNumSegs  = 10           % number of Fourier modes in the approximation of tori
        torPurtb    = 1e-4         % perturbation to Neimark-Sacker periodic orbits to yield initial tori
    end
    
    methods      
        
        function set.omegaSampStyle(obj,omegaSampStyle)
            switch lower(omegaSampStyle)
                case 'uniform'
                    obj.omegaSampStyle = 'uniform';
                case 'cocoout'
                    obj.omegaSampStyle = 'cocoOut';
                case 'cocobd'
                    obj.omegaSampStyle = 'cocoBD';
                otherwise
                    error('Unknown omegaSampStyle type: set uniform or nonuniform frequency sampling types')
            end
        end
        
        function set.initialSolver(obj,initialSolver)
            switch lower(initialSolver)
                case 'forward'
                    obj.initialSolver = 'forward';
                case 'fsolve'
                    obj.initialSolver = 'fsolve';
                otherwise
                    error('Unknown omegaSampStyle type: set uniform or nonuniform frequency sampling types')
            end
        end 
        
        function set.coordinates(obj,coordinates)
            switch lower(coordinates)
                case 'polar'
                    obj.coordinates = 'polar';
                case 'cartesian'
                    obj.coordinates = 'cartesian';
                otherwise
                    error('Unknown torus calculation method: set forward/interpolation/pde')
            end
        end 
        
        function set.sampStyle(obj,sampStyle)
            switch lower(sampStyle)
                case 'uniform'
                    obj.sampStyle = 'uniform';
                case 'cocoout'
                    obj.sampStyle = 'cocoOut';
                case 'cocobd'
                    obj.sampStyle = 'cocoBD';
                otherwise
                    error('Unknown sampStyle type: set uniform/cocoOut/cocoBD frequency sampling types')
            end
        end 

        
        function set.method(obj,method)
            switch lower(method)
                case 'level set'
                    obj.method = 'level set';
                case 'continuation ep'
                    obj.method = 'continuation ep';
                case 'continuation po'
                    obj.method = 'continuation po';
                otherwise
                    error('Unknown "method": set "level set" / "continuation ep" / "continuation po" types')
            end
        end        
    end
end


            ##### SOURCE END #####
        --></body></html></body></html>