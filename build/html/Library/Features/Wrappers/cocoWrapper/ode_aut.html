
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html><body><div class="banner"><a href="../../../../index.html"><img alt="Logo" class="logo" src="../../../../logo.png" style="float:right" width="200"/></a></div><html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--

                    This HTML was auto-generated from MATLAB code.
                    To make changes, update the MATLAB code and republish this document.
                --><title>ODE_aut</title><meta content="MATLAB 9.14" name="generator"/><link href="http://purl.org/dc/elements/1.1/" rel="schema.DC"/><meta content="2023-09-09" name="DC.date"/><meta content="ode_aut.m" name="DC.source"/><style type="text/css">
            html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

            html { min-height:100%; margin-bottom:1px; }
            html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
            html body td { vertical-align:top; text-align:left; }

            h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
            h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
            h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

            a { color:#005fce; text-decoration:none; }
            a:hover { color:#005fce; text-decoration:underline; }
            a:visited { color:#004aa0; text-decoration:none; }

            p { padding:0px; margin:0px 0px 20px; }
            img { padding:0px; margin:0px 0px 20px; border:none; }
            p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

            ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
            ul li { padding:0px; margin:0px 0px 7px 0px; }
            ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
            ul li ol li { list-style:decimal; }
            ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
            ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
            ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
            ol li ol li { list-style-type:lower-alpha; }
            ol li ul { padding-top:7px; }
            ol li ul li { list-style:square; }

            .content { font-size:1.2em; line-height:140%; padding: 20px; }

            pre, code { font-size:12px; }
            tt { font-size: 1.2em; }
            pre { margin:0px 0px 20px; }
            pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
            pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
            pre.error { color:red; }

            @media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

            span.keyword { color:#0000FF }
            span.comment { color:#228B22 }
            span.string { color:#A020F0 }
            span.untermstring { color:#B20000 }
            span.syscmd { color:#B28C00 }
            span.typesection { color:#A0522D }

            .footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
            .footer p { margin:0px; }
            .footer a { color:#878787; }
            .footer a:hover { color:#878787; text-decoration:underline; }
            .footer a:visited { color:#878787; }

            table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
            table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }

            .center {
                display: block;
                margin-left: auto;
                margin-right: auto;
                width: 50%;
              }



        </style></head><body><div class="content"><h1>ODE_aut</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">ODE_AUT</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> y = ode_aut(obj, z, p, data)
        </pre><h2 id="2">ODE_AUT</h2><p>This function presents nonvectorized implementation of vector field</p><div><ul><li>z - state</li></ul></div><div><ul><li>p - (epsilon, alpha)</li></ul></div><p>where epsilon is a parameter will be applied to damping matrix, and alpha is the parameter will be applied to nonlinearity. We assume there is only one conserved quantity in the system without damping. If the system has other symmetries, this implementation will fail.</p><pre class="codeinput"><span class="keyword">if</span> isempty(data)
    error(<span class="string">'a data structure with fnl field should be given'</span>);
<span class="keyword">else</span>
    n = obj.system.n;
    nt = size(z,2);
    x  = z(1:n,:);
    xd = z(n+1:2*n,:);

    <span class="comment">% linear part</span>
    y1x = xd;
    y1d = obj.system.K*x+repmat(p(1,:),[n,1]).*(obj.system.C*xd); <span class="comment">% Kx+Cv</span>

    <span class="comment">% nonlinear part</span>
    fnl = data.fnl; <span class="comment">% fnl.coeffs and fnl.ind</span>
    numNonlinearTerms = size(fnl.coeffs,2);
    y2 = 0;
    <span class="keyword">for</span> i=1:numNonlinearTerms
        coeff = repmat(fnl.coeffs(:,i),[1, nt]);
        ind = fnl.ind(i,:);
        <span class="comment">% find nonzero exponents</span>
        expind = find(ind);
        s = 1;
        <span class="keyword">for</span> j=1:numel(expind)
            s = s.*x(expind(j),:).^ind(expind(j));
        <span class="keyword">end</span>
        s = repmat(s, [n, 1]);
        y2 = y2+coeff.*s;
    <span class="keyword">end</span>
    y2 = repmat(p(2,:),[n,1]).*y2;
    y = [y1x; -obj.system.M\(y1d+y2)];
<span class="keyword">end</span>
        </pre><pre class="codeinput"><span class="keyword">end</span>
        </pre><p class="footer"><br/><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2023a</a><br/></p></div><!--
            ##### SOURCE BEGIN #####
            %% ODE_aut
%
%%
function y = ode_aut(obj, z, p, data)
%% ODE_AUT 
% 
% This function presents nonvectorized implementation of vector field
% 
% * z - state
%
% * p - (epsilon, alpha) 
% 
% where epsilon is a parameter will
% be applied to damping matrix, and alpha is the parameter will be applied
% to nonlinearity. We assume there is only one conserved quantity in the
% system without damping. If the system has other symmetries, this
% implementation will fail.
%

if isempty(data)
    error('a data structure with fnl field should be given');
else
    n = obj.system.n;
    nt = size(z,2);
    x  = z(1:n,:); 
    xd = z(n+1:2*n,:);

    % linear part
    y1x = xd;
    y1d = obj.system.K*x+repmat(p(1,:),[n,1]).*(obj.system.C*xd); % Kx+Cv

    % nonlinear part
    fnl = data.fnl; % fnl.coeffs and fnl.ind
    numNonlinearTerms = size(fnl.coeffs,2);
    y2 = 0;
    for i=1:numNonlinearTerms
        coeff = repmat(fnl.coeffs(:,i),[1, nt]);
        ind = fnl.ind(i,:);
        % find nonzero exponents
        expind = find(ind);
        s = 1;
        for j=1:numel(expind)
            s = s.*x(expind(j),:).^ind(expind(j));
        end
        s = repmat(s, [n, 1]);
        y2 = y2+coeff.*s;
    end
    y2 = repmat(p(2,:),[n,1]).*y2;
    y = [y1x; -obj.system.M\(y1d+y2)];
end
end
            ##### SOURCE END #####
        --></body></html></body></html>